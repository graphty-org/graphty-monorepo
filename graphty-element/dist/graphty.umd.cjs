(function(Me,W){typeof exports=="object"&&typeof module<"u"?W(exports,require("@babylonjs/core")):typeof define=="function"&&define.amd?define(["exports","@babylonjs/core"],W):(Me=typeof globalThis<"u"?globalThis:Me||self,W(Me.Graphty={},Me.BABYLON))})(this,function(Me,W){"use strict";var KI=Object.defineProperty;var rv=Me=>{throw TypeError(Me)};var JI=(Me,W,Ne)=>W in Me?KI(Me,W,{enumerable:!0,configurable:!0,writable:!0,value:Ne}):Me[W]=Ne;var kh=(Me,W,Ne)=>JI(Me,typeof W!="symbol"?W+"":W,Ne),$h=(Me,W,Ne)=>W.has(Me)||rv("Cannot "+Ne);var Oh=(Me,W,Ne)=>($h(Me,W,"read from private field"),Ne?Ne.call(Me):W.get(Me)),Iu=(Me,W,Ne)=>W.has(Me)?rv("Cannot add the same private member more than once"):W instanceof WeakSet?W.add(Me):W.set(Me,Ne),Nh=(Me,W,Ne,Ar)=>($h(Me,W,"write to private field"),Ar?Ar.call(Me,Ne):W.set(Me,Ne),Ne),iv=(Me,W,Ne)=>($h(Me,W,"access private method"),Ne);var H0,W0,j0,Qo,Xo,Na,ov,V0;function Ne(n,e){let t=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(e[0])||(e=e.map(u=>[u]));let r=e[0].length,o=e[0].map((u,h)=>e.map(c=>c[h])),a=n.map(u=>o.map(h=>{let c=0;if(!Array.isArray(u)){for(let f of h)c+=u*f;return c}for(let f=0;f<u.length;f++)c+=u[f]*(h[f]||0);return c}));return t===1&&(a=a[0]),r===1?a.map(u=>u[0]):a}function Ar(n){return Ir(n)==="string"}function Ir(n){return(Object.prototype.toString.call(n).match(/^\[object\s+(.*?)\]$/)[1]||"").toLowerCase()}function Ts(n,{precision:e,unit:t}){return Pr(n)?"none":Rh(n,e)+(t??"")}function Pr(n){return Number.isNaN(n)||n instanceof Number&&(n==null?void 0:n.none)}function Pt(n){return Pr(n)?0:n}function Rh(n,e){if(n===0)return 0;let t=~~n,r=0;t&&e&&(r=~~Math.log10(Math.abs(t))+1);const o=10**(e-r);return Math.floor(n*o+.5)/o}const sv={deg:1,grad:.9,rad:180/Math.PI,turn:360};function zh(n){if(!n)return;n=n.trim();const e=/^([a-z]+)\((.+?)\)$/i,t=/^-?[\d.]+$/,r=/%|deg|g?rad|turn$/,o=/\/?\s*(none|[-\w.]+(?:%|deg|g?rad|turn)?)/g;let a=n.match(e);if(a){let u=[];return a[2].replace(o,(h,c)=>{let f=c.match(r),p=c;if(f){let g=f[0],m=p.slice(0,-g.length);g==="%"?(p=new Number(m/100),p.type="<percentage>"):(p=new Number(m*sv[g]),p.type="<angle>",p.unit=g)}else t.test(p)?(p=new Number(p),p.type="<number>"):p==="none"&&(p=new Number(NaN),p.none=!0);h.startsWith("/")&&(p=p instanceof Number?p:new Number(p),p.alpha=!0),typeof p=="object"&&p instanceof Number&&(p.raw=c),u.push(p)}),{name:a[1].toLowerCase(),rawName:a[1],rawArgs:a[2],args:u}}}function Dh(n){return n[n.length-1]}function yo(n,e,t){return isNaN(n)?e:isNaN(e)?n:n+(e-n)*t}function Lh(n,e,t){return(t-n)/(e-n)}function Pu(n,e,t){return yo(e[0],e[1],Lh(n[0],n[1],t))}function Bh(n){return n.map(e=>e.split("|").map(t=>{t=t.trim();let r=t.match(/^(<[a-z]+>)\[(-?[.\d]+),\s*(-?[.\d]+)\]?$/);if(r){let o=new String(r[1]);return o.range=[+r[2],+r[3]],o}return t}))}function Fh(n,e,t){return Math.max(Math.min(t,e),n)}function Ss(n,e){return Math.sign(n)===Math.sign(e)?n:-n}function rr(n,e){return Ss(Math.abs(n)**e,n)}function ku(n,e){return e===0?0:n/e}function Uh(n,e,t=0,r=n.length){for(;t<r;){const o=t+r>>1;n[o]<e?t=o+1:r=o}return t}var av=Object.freeze({__proto__:null,bisectLeft:Uh,clamp:Fh,copySign:Ss,interpolate:yo,interpolateInv:Lh,isNone:Pr,isString:Ar,last:Dh,mapRange:Pu,multiplyMatrices:Ne,parseCoordGrammar:Bh,parseFunction:zh,serializeNumber:Ts,skipNone:Pt,spow:rr,toPrecision:Rh,type:Ir,zdiv:ku});class uv{add(e,t,r){if(typeof arguments[0]!="string"){for(var e in arguments[0])this.add(e,arguments[0][e],arguments[1]);return}(Array.isArray(e)?e:[e]).forEach(function(o){this[o]=this[o]||[],t&&this[o][r?"unshift":"push"](t)},this)}run(e,t){this[e]=this[e]||[],this[e].forEach(function(r){r.call(t&&t.context?t.context:t,t)})}}const kr=new uv;var yn={gamut_mapping:"css",precision:5,deltaE:"76",verbose:((j0=(W0=(H0=globalThis==null?void 0:globalThis.process)==null?void 0:H0.env)==null?void 0:W0.NODE_ENV)==null?void 0:j0.toLowerCase())!=="test",warn:function(e){var t,r;this.verbose&&((r=(t=globalThis==null?void 0:globalThis.console)==null?void 0:t.warn)==null||r.call(t,e))}};const Jt={D50:[.3457/.3585,1,(1-.3457-.3585)/.3585],D65:[.3127/.329,1,(1-.3127-.329)/.329]};function $u(n){return Array.isArray(n)?n:Jt[n]}function Ms(n,e,t,r={}){if(n=$u(n),e=$u(e),!n||!e)throw new TypeError(`Missing white point to convert ${n?"":"from"}${!n&&!e?"/":""}${e?"":"to"}`);if(n===e)return t;let o={W1:n,W2:e,XYZ:t,options:r};if(kr.run("chromatic-adaptation-start",o),o.M||(o.W1===Jt.D65&&o.W2===Jt.D50?o.M=[[1.0479297925449969,.022946870601609652,-.05019226628920524],[.02962780877005599,.9904344267538799,-.017073799063418826],[-.009243040646204504,.015055191490298152,.7518742814281371]]:o.W1===Jt.D50&&o.W2===Jt.D65&&(o.M=[[.955473421488075,-.02309845494876471,.06325924320057072],[-.0283697093338637,1.0099953980813041,.021041441191917323],[.012314014864481998,-.020507649298898964,1.330365926242124]])),kr.run("chromatic-adaptation-end",o),o.M)return Ne(o.M,o.XYZ);throw new TypeError("Only Bradford CAT with white points D50 and D65 supported for now.")}const lv=new Set(["<number>","<percentage>","<angle>"]);function Zh(n,e,t,r){return Object.entries(n.coords).map(([a,u],h)=>{let c=e.coordGrammar[h],f=r[h],p=f==null?void 0:f.type,g;if(f.none?g=c.find(_=>lv.has(_)):g=c.find(_=>_==p),!g){let _=u.name||a;throw new TypeError(`${p??f.raw} not allowed for ${_} in ${t}()`)}let m=g.range;p==="<percentage>"&&(m||(m=[0,1]));let b=u.range||u.refRange;return m&&b&&(r[h]=Pu(m,b,r[h])),g})}function qh(n,{meta:e}={}){var r,o,a,u;let t={str:(r=String(n))==null?void 0:r.trim()};if(kr.run("parse-start",t),t.color)return t.color;if(t.parsed=zh(t.str),t.parsed){let h=t.parsed.name;if(h==="color"){let c=t.parsed.args.shift(),f=c.startsWith("--")?c.substring(2):`--${c}`,p=[c,f],g=t.parsed.rawArgs.indexOf("/")>0?t.parsed.args.pop():1;for(let _ of be.all){let $=_.getFormat("color");if($&&(p.includes($.id)||(o=$.ids)!=null&&o.filter(C=>p.includes(C)).length)){const C=Object.keys(_.coords).map((I,T)=>t.parsed.args[T]||0);let S;return $.coordGrammar&&(S=Zh(_,$,"color",C)),e&&Object.assign(e,{formatId:"color",types:S}),$.id.startsWith("--")&&!c.startsWith("--")&&yn.warn(`${_.name} is a non-standard space and not currently supported in the CSS spec. Use prefixed color(${$.id}) instead of color(${c}).`),c.startsWith("--")&&!$.id.startsWith("--")&&yn.warn(`${_.name} is a standard space and supported in the CSS spec. Use color(${$.id}) instead of prefixed color(${c}).`),{spaceId:_.id,coords:C,alpha:g}}}let m="",b=c in be.registry?c:f;if(b in be.registry){let _=(u=(a=be.registry[b].formats)==null?void 0:a.color)==null?void 0:u.id;_&&(m=`Did you mean color(${_})?`)}throw new TypeError(`Cannot parse color(${c}). `+(m||"Missing a plugin?"))}else for(let c of be.all){let f=c.getFormat(h);if(f&&f.type==="function"){let p=1;(f.lastAlpha||Dh(t.parsed.args).alpha)&&(p=t.parsed.args.pop());let g=t.parsed.args,m;return f.coordGrammar&&(m=Zh(c,f,h,g)),e&&Object.assign(e,{formatId:f.name,types:m}),{spaceId:c.id,coords:g,alpha:p}}}}else for(let h of be.all)for(let c in h.formats){let f=h.formats[c];if(f.type!=="custom"||f.test&&!f.test(t.str))continue;let p=f.parse(t.str);if(p)return p.alpha??(p.alpha=1),e&&(e.formatId=c),p}throw new TypeError(`Could not parse ${n} as a color. Missing a plugin?`)}function Re(n){if(Array.isArray(n))return n.map(Re);if(!n)throw new TypeError("Empty color reference");Ar(n)&&(n=qh(n));let e=n.space||n.spaceId;return e instanceof be||(n.space=be.get(e)),n.alpha===void 0&&(n.alpha=1),n}const cv=75e-6,fn=class fn{constructor(e){var o;this.id=e.id,this.name=e.name,this.base=e.base?fn.get(e.base):null,this.aliases=e.aliases,this.base&&(this.fromBase=e.fromBase,this.toBase=e.toBase);let t=e.coords??this.base.coords;for(let a in t)"name"in t[a]||(t[a].name=a);this.coords=t;let r=e.white??this.base.white??"D65";this.white=$u(r),this.formats=e.formats??{};for(let a in this.formats){let u=this.formats[a];u.type||(u.type="function"),u.name||(u.name=a)}(o=this.formats.color)!=null&&o.id||(this.formats.color={...this.formats.color??{},id:e.cssId||this.id}),e.gamutSpace?this.gamutSpace=e.gamutSpace==="self"?this:fn.get(e.gamutSpace):this.isPolar?this.gamutSpace=this.base:this.gamutSpace=this,this.gamutSpace.isUnbounded&&(this.inGamut=(a,u)=>!0),this.referred=e.referred,Object.defineProperty(this,"path",{value:hv(this).reverse(),writable:!1,enumerable:!0,configurable:!0}),kr.run("colorspace-init-end",this)}inGamut(e,{epsilon:t=cv}={}){if(!this.equals(this.gamutSpace))return e=this.to(this.gamutSpace,e),this.gamutSpace.inGamut(e,{epsilon:t});let r=Object.values(this.coords);return e.every((o,a)=>{let u=r[a];if(u.type!=="angle"&&u.range){if(Number.isNaN(o))return!0;let[h,c]=u.range;return(h===void 0||o>=h-t)&&(c===void 0||o<=c+t)}return!0})}get isUnbounded(){return Object.values(this.coords).every(e=>!("range"in e))}get cssId(){var e,t;return((t=(e=this.formats)==null?void 0:e.color)==null?void 0:t.id)||this.id}get isPolar(){for(let e in this.coords)if(this.coords[e].type==="angle")return!0;return!1}getFormat(e){if(typeof e=="object")return e=Gh(e,this),e;let t;return e==="default"?t=Object.values(this.formats)[0]:t=this.formats[e],t?(t=Gh(t,this),t):null}equals(e){return e?this===e||this.id===e||this.id===e.id:!1}to(e,t){if(arguments.length===1){const h=Re(e);[e,t]=[h.space,h.coords]}if(e=fn.get(e),this.equals(e))return t;t=t.map(h=>Number.isNaN(h)?0:h);let r=this.path,o=e.path,a,u;for(let h=0;h<r.length&&r[h].equals(o[h]);h++)a=r[h],u=h;if(!a)throw new Error(`Cannot convert between color spaces ${this} and ${e}: no connection space was found`);for(let h=r.length-1;h>u;h--)t=r[h].toBase(t);for(let h=u+1;h<o.length;h++)t=o[h].fromBase(t);return t}from(e,t){if(arguments.length===1){const r=Re(e);[e,t]=[r.space,r.coords]}return e=fn.get(e),e.to(this,t)}toString(){return`${this.name} (${this.id})`}getMinCoords(){let e=[];for(let t in this.coords){let r=this.coords[t],o=r.range||r.refRange;e.push((o==null?void 0:o.min)??0)}return e}static get all(){return[...new Set(Object.values(fn.registry))]}static register(e,t){if(arguments.length===1&&(t=arguments[0],e=t.id),t=this.get(t),this.registry[e]&&this.registry[e]!==t)throw new Error(`Duplicate color space registration: '${e}'`);if(this.registry[e]=t,arguments.length===1&&t.aliases)for(let r of t.aliases)this.register(r,t);return t}static get(e,...t){if(!e||e instanceof fn)return e;if(Ir(e)==="string"){let o=fn.registry[e.toLowerCase()];if(!o)throw new TypeError(`No color space found with id = "${e}"`);return o}if(t.length)return fn.get(...t);throw new TypeError(`${e} is not a valid color space`)}static resolveCoord(e,t){var c;let r=Ir(e),o,a;if(r==="string"?e.includes(".")?[o,a]=e.split("."):[o,a]=[,e]:Array.isArray(e)?[o,a]=e:(o=e.space,a=e.coordId),o=fn.get(o),o||(o=t),!o)throw new TypeError(`Cannot resolve coordinate reference ${e}: No color space specified and relative references are not allowed here`);if(r=Ir(a),r==="number"||r==="string"&&a>=0){let f=Object.entries(o.coords)[a];if(f)return{space:o,id:f[0],index:a,...f[1]}}o=fn.get(o);let u=a.toLowerCase(),h=0;for(let f in o.coords){let p=o.coords[f];if(f.toLowerCase()===u||((c=p.name)==null?void 0:c.toLowerCase())===u)return{space:o,id:f,index:h,...p};h++}throw new TypeError(`No "${a}" coordinate found in ${o.name}. Its coordinates are: ${Object.keys(o.coords).join(", ")}`)}};kh(fn,"registry",{}),kh(fn,"DEFAULT_FORMAT",{type:"functions",name:"color"});let be=fn;function hv(n){let e=[n];for(let t=n;t=t.base;)e.push(t);return e}function Gh(n,{coords:e}={}){if(n.coords&&!n.coordGrammar){n.type||(n.type="function"),n.name||(n.name="color"),n.coordGrammar=Bh(n.coords);let t=Object.entries(e).map(([r,o],a)=>{let u=n.coordGrammar[a][0],h=o.range||o.refRange,c=u.range,f="";return u=="<percentage>"?(c=[0,100],f="%"):u=="<angle>"&&(f="deg"),{fromRange:h,toRange:c,suffix:f}});n.serializeCoords=(r,o)=>r.map((a,u)=>{let{fromRange:h,toRange:c,suffix:f}=t[u];return h&&c&&(a=Pu(h,c,a)),a=Ts(a,{precision:o,unit:f}),a})}return n}var Ut=new be({id:"xyz-d65",name:"XYZ D65",coords:{x:{name:"X"},y:{name:"Y"},z:{name:"Z"}},white:"D65",formats:{color:{ids:["xyz-d65","xyz"]}},aliases:["xyz"]});class an extends be{constructor(e){e.coords||(e.coords={r:{range:[0,1],name:"Red"},g:{range:[0,1],name:"Green"},b:{range:[0,1],name:"Blue"}}),e.base||(e.base=Ut),e.toXYZ_M&&e.fromXYZ_M&&(e.toBase??(e.toBase=t=>{let r=Ne(e.toXYZ_M,t);return this.white!==this.base.white&&(r=Ms(this.white,this.base.white,r)),r}),e.fromBase??(e.fromBase=t=>(t=Ms(this.base.white,this.white,t),Ne(e.fromXYZ_M,t)))),e.referred??(e.referred="display"),super(e)}}function bo(n,e){return n=Re(n),!e||n.space.equals(e)?n.coords.slice():(e=be.get(e),e.from(n))}function bn(n,e){n=Re(n);let{space:t,index:r}=be.resolveCoord(e,n.space);return bo(n,t)[r]}function Ou(n,e,t){return n=Re(n),e=be.get(e),n.coords=e.to(n.space,t),n}Ou.returns="color";function lr(n,e,t){if(n=Re(n),arguments.length===2&&Ir(arguments[1])==="object"){let r=arguments[1];for(let o in r)lr(n,o,r[o])}else{typeof t=="function"&&(t=t(bn(n,e)));let{space:r,index:o}=be.resolveCoord(e,n.space),a=bo(n,r);a[o]=t,Ou(n,r,a)}return n}lr.returns="color";var Nu=new be({id:"xyz-d50",name:"XYZ D50",white:"D50",base:Ut,fromBase:n=>Ms(Ut.white,"D50",n),toBase:n=>Ms("D50",Ut.white,n)});const fv=216/24389,Hh=24/116,Es=24389/27;let Ru=Jt.D50;var wn=new be({id:"lab",name:"Lab",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:Ru,base:Nu,fromBase(n){let t=n.map((r,o)=>r/Ru[o]).map(r=>r>fv?Math.cbrt(r):(Es*r+16)/116);return[116*t[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])]},toBase(n){let e=[];return e[1]=(n[0]+16)/116,e[0]=n[1]/500+e[1],e[2]=e[1]-n[2]/200,[e[0]>Hh?Math.pow(e[0],3):(116*e[0]-16)/Es,n[0]>8?Math.pow((n[0]+16)/116,3):n[0]/Es,e[2]>Hh?Math.pow(e[2],3):(116*e[2]-16)/Es].map((r,o)=>r*Ru[o])},formats:{lab:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function ir(n){return(n%360+360)%360}function dv(n,e){if(n==="raw")return e;let[t,r]=e.map(ir),o=r-t;return n==="increasing"?o<0&&(r+=360):n==="decreasing"?o>0&&(t+=360):n==="longer"?-180<o&&o<180&&(o>0?t+=360:r+=360):n==="shorter"&&(o>180?t+=360:o<-180&&(r+=360)),[t,r]}var wo=new be({id:"lch",name:"LCH",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,150],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:wn,fromBase(n){let[e,t,r]=n,o;const a=.02;return Math.abs(t)<a&&Math.abs(r)<a?o=NaN:o=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ir(o)]},toBase(n){let[e,t,r]=n;return t<0&&(t=0),isNaN(r)&&(r=0),[e,t*Math.cos(r*Math.PI/180),t*Math.sin(r*Math.PI/180)]},formats:{lch:{coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}});const Wh=25**7,Cs=Math.PI,jh=180/Cs,Ri=Cs/180;function Vh(n){const e=n*n;return e*e*e*n}function Kh(n,e,{kL:t=1,kC:r=1,kH:o=1}={}){[n,e]=Re([n,e]);let[a,u,h]=wn.from(n),c=wo.from(wn,[a,u,h])[1],[f,p,g]=wn.from(e),m=wo.from(wn,[f,p,g])[1];c<0&&(c=0),m<0&&(m=0);let b=(c+m)/2,_=Vh(b),$=.5*(1-Math.sqrt(_/(_+Wh))),C=(1+$)*u,S=(1+$)*p,I=Math.sqrt(C**2+h**2),T=Math.sqrt(S**2+g**2),A=C===0&&h===0?0:Math.atan2(h,C),N=S===0&&g===0?0:Math.atan2(g,S);A<0&&(A+=2*Cs),N<0&&(N+=2*Cs),A*=jh,N*=jh;let D=f-a,L=T-I,q=N-A,se=A+N,we=Math.abs(q),me;I*T===0?me=0:we<=180?me=q:q>180?me=q-360:q<-180?me=q+360:yn.warn("the unthinkable has happened");let ge=2*Math.sqrt(T*I)*Math.sin(me*Ri/2),Xe=(a+f)/2,Ue=(I+T)/2,ut=Vh(Ue),Ve;I*T===0?Ve=se:we<=180?Ve=se/2:se<360?Ve=(se+360)/2:Ve=(se-360)/2;let ne=(Xe-50)**2,ae=1+.015*ne/Math.sqrt(20+ne),ie=1+.045*Ue,he=1;he-=.17*Math.cos((Ve-30)*Ri),he+=.24*Math.cos(2*Ve*Ri),he+=.32*Math.cos((3*Ve+6)*Ri),he-=.2*Math.cos((4*Ve-63)*Ri);let _e=1+.015*Ue*he,Te=30*Math.exp(-1*((Ve-275)/25)**2),Le=2*Math.sqrt(ut/(ut+Wh)),Qe=-1*Math.sin(2*Te*Ri)*Le,ue=(D/(t*ae))**2;return ue+=(L/(r*ie))**2,ue+=(ge/(o*_e))**2,ue+=Qe*(L/(r*ie))*(ge/(o*_e)),Math.sqrt(ue)}const pv=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],gv=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],mv=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],vv=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]];var zi=new be({id:"oklab",name:"Oklab",coords:{l:{refRange:[0,1],name:"Lightness"},a:{refRange:[-.4,.4]},b:{refRange:[-.4,.4]}},white:"D65",base:Ut,fromBase(n){let t=Ne(pv,n).map(r=>Math.cbrt(r));return Ne(mv,t)},toBase(n){let t=Ne(vv,n).map(r=>r**3);return Ne(gv,t)},formats:{oklab:{coords:["<percentage> | <number>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});function zu(n,e){[n,e]=Re([n,e]);let[t,r,o]=zi.from(n),[a,u,h]=zi.from(e),c=t-a,f=r-u,p=o-h;return Math.sqrt(c**2+f**2+p**2)}const _v=75e-6;function ii(n,e,{epsilon:t=_v}={}){n=Re(n),e||(e=n.space),e=be.get(e);let r=n.coords;return e!==n.space&&(r=e.from(n)),e.inGamut(r,{epsilon:t})}function Di(n){return{space:n.space,coords:n.coords.slice(),alpha:n.alpha}}function Jh(n,e,t="lab"){t=be.get(t);let r=t.from(n),o=t.from(e);return Math.sqrt(r.reduce((a,u,h)=>{let c=o[h];return isNaN(u)||isNaN(c)?a:a+(c-u)**2},0))}function yv(n,e){return Jh(n,e,"lab")}const Yh=Math.PI/180;function bv(n,e,{l:t=2,c:r=1}={}){[n,e]=Re([n,e]);let[o,a,u]=wn.from(n),[,h,c]=wo.from(wn,[o,a,u]),[f,p,g]=wn.from(e),m=wo.from(wn,[f,p,g])[1];h<0&&(h=0),m<0&&(m=0);let b=o-f,_=h-m,$=a-p,C=u-g,S=$**2+C**2-_**2,I=.511;o>=16&&(I=.040975*o/(1+.01765*o));let T=.0638*h/(1+.0131*h)+.638,A;Number.isNaN(c)&&(c=0),c>=164&&c<=345?A=.56+Math.abs(.2*Math.cos((c+168)*Yh)):A=.36+Math.abs(.4*Math.cos((c+35)*Yh));let N=Math.pow(h,4),D=Math.sqrt(N/(N+1900)),L=T*(D*A+1-D),q=(b/(t*I))**2;return q+=(_/(r*T))**2,q+=S/L**2,Math.sqrt(q)}const Qh=203;var Du=new be({id:"xyz-abs-d65",cssId:"--xyz-abs-d65",name:"Absolute XYZ D65",coords:{x:{refRange:[0,9504.7],name:"Xa"},y:{refRange:[0,1e4],name:"Ya"},z:{refRange:[0,10888.3],name:"Za"}},base:Ut,fromBase(n){return n.map(e=>Math.max(e*Qh,0))},toBase(n){return n.map(e=>Math.max(e/Qh,0))}});const As=1.15,Is=.66,Xh=2610/2**14,wv=2**14/2610,ef=3424/2**12,tf=2413/2**7,nf=2392/2**7,xv=1.7*2523/2**5,rf=2**5/(1.7*2523),Ps=-.56,Lu=16295499532821565e-27,Tv=[[.41478972,.579999,.014648],[-.20151,1.120649,.0531008],[-.0166008,.2648,.6684799]],Sv=[[1.9242264357876067,-1.0047923125953657,.037651404030618],[.35031676209499907,.7264811939316552,-.06538442294808501],[-.09098281098284752,-.3127282905230739,1.5227665613052603]],Mv=[[.5,.5,0],[3.524,-4.066708,.542708],[.199076,1.096799,-1.295875]],Ev=[[1,.1386050432715393,.05804731615611886],[.9999999999999999,-.1386050432715393,-.05804731615611886],[.9999999999999998,-.09601924202631895,-.8118918960560388]];var of=new be({id:"jzazbz",name:"Jzazbz",coords:{jz:{refRange:[0,1],name:"Jz"},az:{refRange:[-.5,.5]},bz:{refRange:[-.5,.5]}},base:Du,fromBase(n){let[e,t,r]=n,o=As*e-(As-1)*r,a=Is*t-(Is-1)*e,h=Ne(Tv,[o,a,r]).map(function(m){let b=ef+tf*(m/1e4)**Xh,_=1+nf*(m/1e4)**Xh;return(b/_)**xv}),[c,f,p]=Ne(Mv,h);return[(1+Ps)*c/(1+Ps*c)-Lu,f,p]},toBase(n){let[e,t,r]=n,o=(e+Lu)/(1+Ps-Ps*(e+Lu)),u=Ne(Ev,[o,t,r]).map(function(m){let b=ef-m**rf,_=nf*m**rf-tf;return 1e4*(b/_)**wv}),[h,c,f]=Ne(Sv,u),p=(h+(As-1)*f)/As,g=(c+(Is-1)*p)/Is;return[p,g,f]},formats:{color:{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),Bu=new be({id:"jzczhz",name:"JzCzHz",coords:{jz:{refRange:[0,1],name:"Jz"},cz:{refRange:[0,1],name:"Chroma"},hz:{refRange:[0,360],type:"angle",name:"Hue"}},base:of,fromBase(n){let[e,t,r]=n,o;const a=2e-4;return Math.abs(t)<a&&Math.abs(r)<a?o=NaN:o=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ir(o)]},toBase(n){return[n[0],n[1]*Math.cos(n[2]*Math.PI/180),n[1]*Math.sin(n[2]*Math.PI/180)]}});function Cv(n,e){[n,e]=Re([n,e]);let[t,r,o]=Bu.from(n),[a,u,h]=Bu.from(e),c=t-a,f=r-u;Number.isNaN(o)&&Number.isNaN(h)?(o=0,h=0):Number.isNaN(o)?o=h:Number.isNaN(h)&&(h=o);let p=o-h,g=2*Math.sqrt(r*u)*Math.sin(p/2*(Math.PI/180));return Math.sqrt(c**2+f**2+g**2)}const sf=3424/4096,af=2413/128,uf=2392/128,lf=2610/16384,Av=2523/32,Iv=16384/2610,cf=32/2523,Pv=[[.3592832590121217,.6976051147779502,-.035891593232029],[-.1920808463704993,1.100476797037432,.0753748658519118],[.0070797844607479,.0748396662186362,.8433265453898765]],kv=[[2048/4096,2048/4096,0],[6610/4096,-13613/4096,7003/4096],[17933/4096,-17390/4096,-543/4096]],$v=[[.9999999999999998,.0086090370379328,.111029625003026],[.9999999999999998,-.0086090370379328,-.1110296250030259],[.9999999999999998,.5600313357106791,-.3206271749873188]],Ov=[[2.0701522183894223,-1.3263473389671563,.2066510476294053],[.3647385209748072,.6805660249472273,-.0453045459220347],[-.0497472075358123,-.0492609666966131,1.1880659249923042]];var Fu=new be({id:"ictcp",name:"ICTCP",coords:{i:{refRange:[0,1],name:"I"},ct:{refRange:[-.5,.5],name:"CT"},cp:{refRange:[-.5,.5],name:"CP"}},base:Du,fromBase(n){let e=Ne(Pv,n);return Nv(e)},toBase(n){let e=Rv(n);return Ne(Ov,e)}});function Nv(n){let e=n.map(function(t){let r=sf+af*(t/1e4)**lf,o=1+uf*(t/1e4)**lf;return(r/o)**Av});return Ne(kv,e)}function Rv(n){return Ne($v,n).map(function(r){let o=Math.max(r**cf-sf,0),a=af-uf*r**cf;return 1e4*(o/a)**Iv})}function zv(n,e){[n,e]=Re([n,e]);let[t,r,o]=Fu.from(n),[a,u,h]=Fu.from(e);return 720*Math.sqrt((t-a)**2+.25*(r-u)**2+(o-h)**2)}const Dv=Jt.D65,hf=.42,ff=1/hf,Uu=2*Math.PI,df=[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],Lv=[[1.8620678550872327,-1.0112546305316843,.14918677544445175],[.38752654323613717,.6214474419314753,-.008973985167612518],[-.015841498849333856,-.03412293802851557,1.0499644368778496]],Bv=[[460,451,288],[460,-891,-261],[460,-220,-6300]],Fv={dark:[.8,.525,.8],dim:[.9,.59,.9],average:[1,.69,1]},oi={h:[20.14,90,164.25,237.53,380.14],e:[.8,.7,1,1.2,.8],H:[0,100,200,300,400]},Uv=180/Math.PI,pf=Math.PI/180;function gf(n,e){return n.map(r=>{const o=rr(e*Math.abs(r)*.01,hf);return 400*Ss(o,r)/(o+27.13)})}function Zv(n,e){const t=100/e*27.13**ff;return n.map(r=>{const o=Math.abs(r);return Ss(t*rr(o/(400-o),ff),r)})}function qv(n){let e=ir(n);e<=oi.h[0]&&(e+=360);const t=Uh(oi.h,e)-1,[r,o]=oi.h.slice(t,t+2),[a,u]=oi.e.slice(t,t+2),h=oi.H[t],c=(e-r)/a;return h+100*c/(c+(o-e)/u)}function Gv(n){let e=(n%400+400)%400;const t=Math.floor(.01*e);e=e%100;const[r,o]=oi.h.slice(t,t+2),[a,u]=oi.e.slice(t,t+2);return ir((e*(u*r-a*o)-100*r*u)/(e*(u-a)-100*u))}function mf(n,e,t,r,o){const a={};a.discounting=o,a.refWhite=n,a.surround=r;const u=n.map($=>$*100);a.la=e,a.yb=t;const h=u[1],c=Ne(df,u);r=Fv[a.surround];const f=r[0];a.c=r[1],a.nc=r[2];const g=(1/(5*a.la+1))**4;a.fl=g*a.la+.1*(1-g)*(1-g)*Math.cbrt(5*a.la),a.flRoot=a.fl**.25,a.n=a.yb/h,a.z=1.48+Math.sqrt(a.n),a.nbb=.725*a.n**-.2,a.ncb=a.nbb;const m=Math.max(Math.min(f*(1-1/3.6*Math.exp((-a.la-42)/92)),1),0);a.dRgb=c.map($=>yo(1,h/$,m)),a.dRgbInv=a.dRgb.map($=>1/$);const b=c.map(($,C)=>$*a.dRgb[C]),_=gf(b,a.fl);return a.aW=a.nbb*(2*_[0]+_[1]+.05*_[2]),a}const vf=mf(Dv,64/Math.PI*.2,20,"average",!1);function Zu(n,e){if(!(n.J!==void 0^n.Q!==void 0))throw new Error("Conversion requires one and only one: 'J' or 'Q'");if(!(n.C!==void 0^n.M!==void 0^n.s!==void 0))throw new Error("Conversion requires one and only one: 'C', 'M' or 's'");if(!(n.h!==void 0^n.H!==void 0))throw new Error("Conversion requires one and only one: 'h' or 'H'");if(n.J===0||n.Q===0)return[0,0,0];let t=0;n.h!==void 0?t=ir(n.h)*pf:t=Gv(n.H)*pf;const r=Math.cos(t),o=Math.sin(t);let a=0;n.J!==void 0?a=rr(n.J,1/2)*.1:n.Q!==void 0&&(a=.25*e.c*n.Q/((e.aW+4)*e.flRoot));let u=0;n.C!==void 0?u=n.C/a:n.M!==void 0?u=n.M/e.flRoot/a:n.s!==void 0&&(u=4e-4*n.s**2*(e.aW+4)/e.c);const h=rr(u*Math.pow(1.64-Math.pow(.29,e.n),-.73),10/9),c=.25*(Math.cos(t+2)+3.8),f=e.aW*rr(a,2/e.c/e.z),p=5e4/13*e.nc*e.ncb*c,g=f/e.nbb,m=23*(g+.305)*ku(h,23*p+h*(11*r+108*o)),b=m*r,_=m*o,$=Zv(Ne(Bv,[g,b,_]).map(C=>C*1/1403),e.fl);return Ne(Lv,$.map((C,S)=>C*e.dRgbInv[S])).map(C=>C/100)}function _f(n,e){const t=n.map(T=>T*100),r=gf(Ne(df,t).map((T,A)=>T*e.dRgb[A]),e.fl),o=r[0]+(-12*r[1]+r[2])/11,a=(r[0]+r[1]-2*r[2])/9,u=(Math.atan2(a,o)%Uu+Uu)%Uu,h=.25*(Math.cos(u+2)+3.8),c=5e4/13*e.nc*e.ncb*ku(h*Math.sqrt(o**2+a**2),r[0]+r[1]+1.05*r[2]+.305),f=rr(c,.9)*Math.pow(1.64-Math.pow(.29,e.n),.73),p=e.nbb*(2*r[0]+r[1]+.05*r[2]),g=rr(p/e.aW,.5*e.c*e.z),m=100*rr(g,2),b=4/e.c*g*(e.aW+4)*e.flRoot,_=f*g,$=_*e.flRoot,C=ir(u*Uv),S=qv(C),I=50*rr(e.c*f/(e.aW+4),1/2);return{J:m,C:_,h:C,s:I,Q:b,M:$,H:S}}var Hv=new be({id:"cam16-jmh",cssId:"--cam16-jmh",name:"CAM16-JMh",coords:{j:{refRange:[0,100],name:"J"},m:{refRange:[0,105],name:"Colorfulness"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:Ut,fromBase(n){const e=_f(n,vf);return[e.J,e.M,e.h]},toBase(n){return Zu({J:n[0],M:n[1],h:n[2]},vf)}});const Wv=Jt.D65,jv=216/24389,yf=24389/27;function Vv(n){return 116*(n>jv?Math.cbrt(n):(yf*n+16)/116)-16}function qu(n){return n>8?Math.pow((n+16)/116,3):n/yf}function Kv(n,e){let[t,r,o]=n,a=[],u=0;if(o===0)return[0,0,0];let h=qu(o);o>0?u=.00379058511492914*o**2+.608983189401032*o+.9155088574762233:u=9514440756550361e-21*o**2+.08693057439788597*o-21.928975842194614;const c=2e-12,f=15;let p=0,g=1/0;for(;p<=f;){a=Zu({J:u,C:r,h:t},e);const m=Math.abs(a[1]-h);if(m<g){if(m<=c)return a;g=m}u=u-(a[1]-h)*u/(2*a[1]),p+=1}return Zu({J:u,C:r,h:t},e)}function Jv(n,e){const t=Vv(n[1]);if(t===0)return[0,0,0];const r=_f(n,Gu);return[ir(r.h),r.C,t]}const Gu=mf(Wv,200/Math.PI*qu(50),qu(50)*100,"average",!1);var xo=new be({id:"hct",name:"HCT",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},c:{refRange:[0,145],name:"Colorfulness"},t:{refRange:[0,100],name:"Tone"}},base:Ut,fromBase(n){return Jv(n)},toBase(n){return Kv(n,Gu)},formats:{color:{id:"--hct",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});const Yv=Math.PI/180,bf=[1,.007,.0228];function wf(n){n[1]<0&&(n=xo.fromBase(xo.toBase(n)));const e=Math.log(Math.max(1+bf[2]*n[1]*Gu.flRoot,1))/bf[2],t=n[0]*Yv,r=e*Math.cos(t),o=e*Math.sin(t);return[n[2],r,o]}function Qv(n,e){[n,e]=Re([n,e]);let[t,r,o]=wf(xo.from(n)),[a,u,h]=wf(xo.from(e));return Math.sqrt((t-a)**2+(r-u)**2+(o-h)**2)}var Li={deltaE76:yv,deltaECMC:bv,deltaE2000:Kh,deltaEJz:Cv,deltaEITP:zv,deltaEOK:zu,deltaEHCT:Qv};function Xv(n){const e=n?Math.floor(Math.log10(Math.abs(n))):0;return Math.max(parseFloat(`1e${e-2}`),1e-6)}const xf={hct:{method:"hct.c",jnd:2,deltaEMethod:"hct",blackWhiteClamp:{}},"hct-tonal":{method:"hct.c",jnd:0,deltaEMethod:"hct",blackWhiteClamp:{channel:"hct.t",min:0,max:100}}};function $r(n,{method:e=yn.gamut_mapping,space:t=void 0,deltaEMethod:r="",jnd:o=2,blackWhiteClamp:a={}}={}){if(n=Re(n),Ar(arguments[1])?t=arguments[1]:t||(t=n.space),t=be.get(t),ii(n,t,{epsilon:0}))return n;let u;if(e==="css")u=e1(n,{space:t});else{if(e!=="clip"&&!ii(n,t)){Object.prototype.hasOwnProperty.call(xf,e)&&({method:e,jnd:o,deltaEMethod:r,blackWhiteClamp:a}=xf[e]);let h=Kh;if(r!==""){for(let f in Li)if("deltae"+r.toLowerCase()===f.toLowerCase()){h=Li[f];break}}let c=$r(pt(n,t),{method:"clip",space:t});if(h(n,c)>o){if(Object.keys(a).length===3){let I=be.resolveCoord(a.channel),T=bn(pt(n,I.space),I.id);if(Pr(T)&&(T=0),T>=a.max)return pt({space:"xyz-d65",coords:Jt.D65},n.space);if(T<=a.min)return pt({space:"xyz-d65",coords:[0,0,0]},n.space)}let f=be.resolveCoord(e),p=f.space,g=f.id,m=pt(n,p);m.coords.forEach((I,T)=>{Pr(I)&&(m.coords[T]=0)});let _=(f.range||f.refRange)[0],$=Xv(o),C=_,S=bn(m,g);for(;S-C>$;){let I=Di(m);I=$r(I,{space:t,method:"clip"}),h(m,I)-o<$?C=bn(m,g):S=bn(m,g),lr(m,g,(C+S)/2)}u=pt(m,t)}else u=c}else u=pt(n,t);if(e==="clip"||!ii(u,t,{epsilon:0})){let h=Object.values(t.coords).map(c=>c.range||[]);u.coords=u.coords.map((c,f)=>{let[p,g]=h[f];return p!==void 0&&(c=Math.max(p,c)),g!==void 0&&(c=Math.min(c,g)),c})}}return t!==n.space&&(u=pt(u,n.space)),n.coords=u.coords,n}$r.returns="color";const Tf={WHITE:{space:zi,coords:[1,0,0]},BLACK:{space:zi,coords:[0,0,0]}};function e1(n,{space:e}={}){n=Re(n),e||(e=n.space),e=be.get(e);const o=be.get("oklch");if(e.isUnbounded)return pt(n,e);const a=pt(n,o);let u=a.coords[0];if(u>=1){const _=pt(Tf.WHITE,e);return _.alpha=n.alpha,pt(_,e)}if(u<=0){const _=pt(Tf.BLACK,e);return _.alpha=n.alpha,pt(_,e)}if(ii(a,e,{epsilon:0}))return pt(a,e);function h(_){const $=pt(_,e),C=Object.values(e.coords);return $.coords=$.coords.map((S,I)=>{if("range"in C[I]){const[T,A]=C[I].range;return Fh(T,S,A)}return S}),$}let c=0,f=a.coords[1],p=!0,g=Di(a),m=h(g),b=zu(m,g);if(b<.02)return m;for(;f-c>1e-4;){const _=(c+f)/2;if(g.coords[1]=_,p&&ii(g,e,{epsilon:0}))c=_;else if(m=h(g),b=zu(m,g),b<.02){if(.02-b<1e-4)break;p=!1,c=_}else f=_}return m}function pt(n,e,{inGamut:t}={}){n=Re(n),e=be.get(e);let r=e.from(n),o={space:e,coords:r,alpha:n.alpha};return t&&(o=$r(o,t===!0?void 0:t)),o}pt.returns="color";function To(n,{precision:e=yn.precision,format:t="default",inGamut:r=!0,...o}={}){var c;let a;n=Re(n);let u=t;t=n.space.getFormat(t)??n.space.getFormat("default")??be.DEFAULT_FORMAT;let h=n.coords.slice();if(r||(r=t.toGamut),r&&!ii(n)&&(h=$r(Di(n),r===!0?void 0:r).coords),t.type==="custom")if(o.precision=e,t.serialize)a=t.serialize(h,n.alpha,o);else throw new TypeError(`format ${u} can only be used to parse colors, not for serialization`);else{let f=t.name||"color";t.serializeCoords?h=t.serializeCoords(h,e):e!==null&&(h=h.map(b=>Ts(b,{precision:e})));let p=[...h];if(f==="color"){let b=t.id||((c=t.ids)==null?void 0:c[0])||n.space.id;p.unshift(b)}let g=n.alpha;e!==null&&(g=Ts(g,{precision:e}));let m=n.alpha>=1||t.noAlpha?"":`${t.commas?",":" /"} ${g}`;a=`${f}(${p.join(t.commas?", ":" ")}${m})`}return a}const t1=[[.6369580483012914,.14461690358620832,.1688809751641721],[.2627002120112671,.6779980715188708,.05930171646986196],[0,.028072693049087428,1.060985057710791]],n1=[[1.716651187971268,-.355670783776392,-.25336628137366],[-.666684351832489,1.616481236634939,.0157685458139111],[.017639857445311,-.042770613257809,.942103121235474]];var ks=new an({id:"rec2020-linear",cssId:"--rec2020-linear",name:"Linear REC.2020",white:"D65",toXYZ_M:t1,fromXYZ_M:n1});const $s=1.09929682680944,Sf=.018053968510807;var Mf=new an({id:"rec2020",name:"REC.2020",base:ks,toBase(n){return n.map(function(e){return e<Sf*4.5?e/4.5:Math.pow((e+$s-1)/$s,1/.45)})},fromBase(n){return n.map(function(e){return e>=Sf?$s*Math.pow(e,.45)-($s-1):4.5*e})}});const r1=[[.4865709486482162,.26566769316909306,.1982172852343625],[.2289745640697488,.6917385218365064,.079286914093745],[0,.04511338185890264,1.043944368900976]],i1=[[2.493496911941425,-.9313836179191239,-.40271078445071684],[-.8294889695615747,1.7626640603183463,.023624685841943577],[.03584583024378447,-.07617238926804182,.9568845240076872]];var Ef=new an({id:"p3-linear",cssId:"--display-p3-linear",name:"Linear P3",white:"D65",toXYZ_M:r1,fromXYZ_M:i1});const o1=[[.41239079926595934,.357584339383878,.1804807884018343],[.21263900587151027,.715168678767756,.07219231536073371],[.01933081871559182,.11919477979462598,.9505321522496607]],$t=[[3.2409699419045226,-1.537383177570094,-.4986107602930034],[-.9692436362808796,1.8759675015077202,.04155505740717559],[.05563007969699366,-.20397695888897652,1.0569715142428786]];var Cf=new an({id:"srgb-linear",name:"Linear sRGB",white:"D65",toXYZ_M:o1,fromXYZ_M:$t}),Af={aliceblue:[240/255,248/255,1],antiquewhite:[250/255,235/255,215/255],aqua:[0,1,1],aquamarine:[127/255,1,212/255],azure:[240/255,1,1],beige:[245/255,245/255,220/255],bisque:[1,228/255,196/255],black:[0,0,0],blanchedalmond:[1,235/255,205/255],blue:[0,0,1],blueviolet:[138/255,43/255,226/255],brown:[165/255,42/255,42/255],burlywood:[222/255,184/255,135/255],cadetblue:[95/255,158/255,160/255],chartreuse:[127/255,1,0],chocolate:[210/255,105/255,30/255],coral:[1,127/255,80/255],cornflowerblue:[100/255,149/255,237/255],cornsilk:[1,248/255,220/255],crimson:[220/255,20/255,60/255],cyan:[0,1,1],darkblue:[0,0,139/255],darkcyan:[0,139/255,139/255],darkgoldenrod:[184/255,134/255,11/255],darkgray:[169/255,169/255,169/255],darkgreen:[0,100/255,0],darkgrey:[169/255,169/255,169/255],darkkhaki:[189/255,183/255,107/255],darkmagenta:[139/255,0,139/255],darkolivegreen:[85/255,107/255,47/255],darkorange:[1,140/255,0],darkorchid:[153/255,50/255,204/255],darkred:[139/255,0,0],darksalmon:[233/255,150/255,122/255],darkseagreen:[143/255,188/255,143/255],darkslateblue:[72/255,61/255,139/255],darkslategray:[47/255,79/255,79/255],darkslategrey:[47/255,79/255,79/255],darkturquoise:[0,206/255,209/255],darkviolet:[148/255,0,211/255],deeppink:[1,20/255,147/255],deepskyblue:[0,191/255,1],dimgray:[105/255,105/255,105/255],dimgrey:[105/255,105/255,105/255],dodgerblue:[30/255,144/255,1],firebrick:[178/255,34/255,34/255],floralwhite:[1,250/255,240/255],forestgreen:[34/255,139/255,34/255],fuchsia:[1,0,1],gainsboro:[220/255,220/255,220/255],ghostwhite:[248/255,248/255,1],gold:[1,215/255,0],goldenrod:[218/255,165/255,32/255],gray:[128/255,128/255,128/255],green:[0,128/255,0],greenyellow:[173/255,1,47/255],grey:[128/255,128/255,128/255],honeydew:[240/255,1,240/255],hotpink:[1,105/255,180/255],indianred:[205/255,92/255,92/255],indigo:[75/255,0,130/255],ivory:[1,1,240/255],khaki:[240/255,230/255,140/255],lavender:[230/255,230/255,250/255],lavenderblush:[1,240/255,245/255],lawngreen:[124/255,252/255,0],lemonchiffon:[1,250/255,205/255],lightblue:[173/255,216/255,230/255],lightcoral:[240/255,128/255,128/255],lightcyan:[224/255,1,1],lightgoldenrodyellow:[250/255,250/255,210/255],lightgray:[211/255,211/255,211/255],lightgreen:[144/255,238/255,144/255],lightgrey:[211/255,211/255,211/255],lightpink:[1,182/255,193/255],lightsalmon:[1,160/255,122/255],lightseagreen:[32/255,178/255,170/255],lightskyblue:[135/255,206/255,250/255],lightslategray:[119/255,136/255,153/255],lightslategrey:[119/255,136/255,153/255],lightsteelblue:[176/255,196/255,222/255],lightyellow:[1,1,224/255],lime:[0,1,0],limegreen:[50/255,205/255,50/255],linen:[250/255,240/255,230/255],magenta:[1,0,1],maroon:[128/255,0,0],mediumaquamarine:[102/255,205/255,170/255],mediumblue:[0,0,205/255],mediumorchid:[186/255,85/255,211/255],mediumpurple:[147/255,112/255,219/255],mediumseagreen:[60/255,179/255,113/255],mediumslateblue:[123/255,104/255,238/255],mediumspringgreen:[0,250/255,154/255],mediumturquoise:[72/255,209/255,204/255],mediumvioletred:[199/255,21/255,133/255],midnightblue:[25/255,25/255,112/255],mintcream:[245/255,1,250/255],mistyrose:[1,228/255,225/255],moccasin:[1,228/255,181/255],navajowhite:[1,222/255,173/255],navy:[0,0,128/255],oldlace:[253/255,245/255,230/255],olive:[128/255,128/255,0],olivedrab:[107/255,142/255,35/255],orange:[1,165/255,0],orangered:[1,69/255,0],orchid:[218/255,112/255,214/255],palegoldenrod:[238/255,232/255,170/255],palegreen:[152/255,251/255,152/255],paleturquoise:[175/255,238/255,238/255],palevioletred:[219/255,112/255,147/255],papayawhip:[1,239/255,213/255],peachpuff:[1,218/255,185/255],peru:[205/255,133/255,63/255],pink:[1,192/255,203/255],plum:[221/255,160/255,221/255],powderblue:[176/255,224/255,230/255],purple:[128/255,0,128/255],rebeccapurple:[102/255,51/255,153/255],red:[1,0,0],rosybrown:[188/255,143/255,143/255],royalblue:[65/255,105/255,225/255],saddlebrown:[139/255,69/255,19/255],salmon:[250/255,128/255,114/255],sandybrown:[244/255,164/255,96/255],seagreen:[46/255,139/255,87/255],seashell:[1,245/255,238/255],sienna:[160/255,82/255,45/255],silver:[192/255,192/255,192/255],skyblue:[135/255,206/255,235/255],slateblue:[106/255,90/255,205/255],slategray:[112/255,128/255,144/255],slategrey:[112/255,128/255,144/255],snow:[1,250/255,250/255],springgreen:[0,1,127/255],steelblue:[70/255,130/255,180/255],tan:[210/255,180/255,140/255],teal:[0,128/255,128/255],thistle:[216/255,191/255,216/255],tomato:[1,99/255,71/255],turquoise:[64/255,224/255,208/255],violet:[238/255,130/255,238/255],wheat:[245/255,222/255,179/255],white:[1,1,1],whitesmoke:[245/255,245/255,245/255],yellow:[1,1,0],yellowgreen:[154/255,205/255,50/255]};let If=Array(3).fill("<percentage> | <number>[0, 255]"),Pf=Array(3).fill("<number>[0, 255]");var Bi=new an({id:"srgb",name:"sRGB",base:Cf,fromBase:n=>n.map(e=>{let t=e<0?-1:1,r=e*t;return r>.0031308?t*(1.055*r**(1/2.4)-.055):12.92*e}),toBase:n=>n.map(e=>{let t=e<0?-1:1,r=e*t;return r<=.04045?e/12.92:t*((r+.055)/1.055)**2.4}),formats:{rgb:{coords:If},rgb_number:{name:"rgb",commas:!0,coords:Pf,noAlpha:!0},color:{},rgba:{coords:If,commas:!0,lastAlpha:!0},rgba_number:{name:"rgba",commas:!0,coords:Pf},hex:{type:"custom",toGamut:!0,test:n=>/^#([a-f0-9]{3,4}){1,2}$/i.test(n),parse(n){n.length<=5&&(n=n.replace(/[a-f0-9]/gi,"$&$&"));let e=[];return n.replace(/[a-f0-9]{2}/gi,t=>{e.push(parseInt(t,16)/255)}),{spaceId:"srgb",coords:e.slice(0,3),alpha:e.slice(3)[0]}},serialize:(n,e,{collapse:t=!0}={})=>{e<1&&n.push(e),n=n.map(a=>Math.round(a*255));let r=t&&n.every(a=>a%17===0);return"#"+n.map(a=>r?(a/17).toString(16):a.toString(16).padStart(2,"0")).join("")}},keyword:{type:"custom",test:n=>/^[a-z]+$/i.test(n),parse(n){n=n.toLowerCase();let e={spaceId:"srgb",coords:null,alpha:1};if(n==="transparent"?(e.coords=Af.black,e.alpha=0):e.coords=Af[n],e.coords)return e}}}}),kf=new an({id:"p3",cssId:"display-p3",name:"P3",base:Ef,fromBase:Bi.fromBase,toBase:Bi.toBase});yn.display_space=Bi;let s1;if(typeof CSS<"u"&&CSS.supports)for(let n of[wn,Mf,kf]){let e=n.getMinCoords(),r=To({space:n,coords:e,alpha:1});if(CSS.supports("color",r)){yn.display_space=n;break}}function a1(n,{space:e=yn.display_space,...t}={}){let r=To(n,t);if(typeof CSS>"u"||CSS.supports("color",r)||!yn.display_space)r=new String(r),r.color=n;else{let o=n;if((n.coords.some(Pr)||Pr(n.alpha))&&!(s1??(s1=CSS.supports("color","hsl(none 50% 50%)")))&&(o=Di(n),o.coords=o.coords.map(Pt),o.alpha=Pt(o.alpha),r=To(o,t),CSS.supports("color",r)))return r=new String(r),r.color=o,r;o=pt(o,e),r=new String(To(o,t)),r.color=o}return r}function u1(n,e){return n=Re(n),e=Re(e),n.space===e.space&&n.alpha===e.alpha&&n.coords.every((t,r)=>t===e.coords[r])}function Or(n){return bn(n,[Ut,"y"])}function $f(n,e){lr(n,[Ut,"y"],e)}function l1(n){Object.defineProperty(n.prototype,"luminance",{get(){return Or(this)},set(e){$f(this,e)}})}var c1=Object.freeze({__proto__:null,getLuminance:Or,register:l1,setLuminance:$f});function h1(n,e){n=Re(n),e=Re(e);let t=Math.max(Or(n),0),r=Math.max(Or(e),0);return r>t&&([t,r]=[r,t]),(t+.05)/(r+.05)}const f1=.56,d1=.57,p1=.62,g1=.65,Of=.022,m1=1.414,v1=.1,_1=5e-4,y1=1.14,Nf=.027,b1=1.14;function Rf(n){return n>=Of?n:n+(Of-n)**m1}function Fi(n){let e=n<0?-1:1,t=Math.abs(n);return e*Math.pow(t,2.4)}function w1(n,e){e=Re(e),n=Re(n);let t,r,o,a,u,h;e=pt(e,"srgb"),[a,u,h]=e.coords;let c=Fi(a)*.2126729+Fi(u)*.7151522+Fi(h)*.072175;n=pt(n,"srgb"),[a,u,h]=n.coords;let f=Fi(a)*.2126729+Fi(u)*.7151522+Fi(h)*.072175,p=Rf(c),g=Rf(f),m=g>p;return Math.abs(g-p)<_1?r=0:m?(t=g**f1-p**d1,r=t*y1):(t=g**g1-p**p1,r=t*b1),Math.abs(r)<v1?o=0:r>0?o=r-Nf:o=r+Nf,o*100}function x1(n,e){n=Re(n),e=Re(e);let t=Math.max(Or(n),0),r=Math.max(Or(e),0);r>t&&([t,r]=[r,t]);let o=t+r;return o===0?0:(t-r)/o}const T1=5e4;function S1(n,e){n=Re(n),e=Re(e);let t=Math.max(Or(n),0),r=Math.max(Or(e),0);return r>t&&([t,r]=[r,t]),r===0?T1:(t-r)/r}function M1(n,e){n=Re(n),e=Re(e);let t=bn(n,[wn,"l"]),r=bn(e,[wn,"l"]);return Math.abs(t-r)}const E1=216/24389,zf=24/116,Os=24389/27;let Hu=Jt.D65;var Wu=new be({id:"lab-d65",name:"Lab D65",coords:{l:{refRange:[0,100],name:"Lightness"},a:{refRange:[-125,125]},b:{refRange:[-125,125]}},white:Hu,base:Ut,fromBase(n){let t=n.map((r,o)=>r/Hu[o]).map(r=>r>E1?Math.cbrt(r):(Os*r+16)/116);return[116*t[1]-16,500*(t[0]-t[1]),200*(t[1]-t[2])]},toBase(n){let e=[];return e[1]=(n[0]+16)/116,e[0]=n[1]/500+e[1],e[2]=e[1]-n[2]/200,[e[0]>zf?Math.pow(e[0],3):(116*e[0]-16)/Os,n[0]>8?Math.pow((n[0]+16)/116,3):n[0]/Os,e[2]>zf?Math.pow(e[2],3):(116*e[2]-16)/Os].map((r,o)=>r*Hu[o])},formats:{"lab-d65":{coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}});const ju=Math.pow(5,.5)*.5+.5;function C1(n,e){n=Re(n),e=Re(e);let t=bn(n,[Wu,"l"]),r=bn(e,[Wu,"l"]),o=Math.abs(Math.pow(t,ju)-Math.pow(r,ju)),a=Math.pow(o,1/ju)*Math.SQRT2-40;return a<7.5?0:a}var Ns=Object.freeze({__proto__:null,contrastAPCA:w1,contrastDeltaPhi:C1,contrastLstar:M1,contrastMichelson:x1,contrastWCAG21:h1,contrastWeber:S1});function A1(n,e,t={}){Ar(t)&&(t={algorithm:t});let{algorithm:r,...o}=t;if(!r){let a=Object.keys(Ns).map(u=>u.replace(/^contrast/,"")).join(", ");throw new TypeError(`contrast() function needs a contrast algorithm. Please specify one of: ${a}`)}n=Re(n),e=Re(e);for(let a in Ns)if("contrast"+r.toLowerCase()===a.toLowerCase())return Ns[a](n,e,o);throw new TypeError(`Unknown contrast algorithm: ${r}`)}function Rs(n){let[e,t,r]=bo(n,Ut),o=e+15*t+3*r;return[4*e/o,9*t/o]}function Df(n){let[e,t,r]=bo(n,Ut),o=e+t+r;return[e/o,t/o]}function I1(n){Object.defineProperty(n.prototype,"uv",{get(){return Rs(this)}}),Object.defineProperty(n.prototype,"xy",{get(){return Df(this)}})}var P1=Object.freeze({__proto__:null,register:I1,uv:Rs,xy:Df});function So(n,e,t={}){Ar(t)&&(t={method:t});let{method:r=yn.deltaE,...o}=t;for(let a in Li)if("deltae"+r.toLowerCase()===a.toLowerCase())return Li[a](n,e,o);throw new TypeError(`Unknown deltaE method: ${r}`)}function k1(n,e=.25){let r=[be.get("oklch","lch"),"l"];return lr(n,r,o=>o*(1+e))}function $1(n,e=.25){let r=[be.get("oklch","lch"),"l"];return lr(n,r,o=>o*(1-e))}var O1=Object.freeze({__proto__:null,darken:$1,lighten:k1});function Lf(n,e,t=.5,r={}){return[n,e]=[Re(n),Re(e)],Ir(t)==="object"&&([t,r]=[.5,t]),Mo(n,e,r)(t)}function Bf(n,e,t={}){let r;Vu(n)&&([r,t]=[n,e],[n,e]=r.rangeArgs.colors);let{maxDeltaE:o,deltaEMethod:a,steps:u=2,maxSteps:h=1e3,...c}=t;r||([n,e]=[Re(n),Re(e)],r=Mo(n,e,c));let f=So(n,e),p=o>0?Math.max(u,Math.ceil(f/o)+1):u,g=[];if(h!==void 0&&(p=Math.min(p,h)),p===1)g=[{p:.5,color:r(.5)}];else{let m=1/(p-1);g=Array.from({length:p},(b,_)=>{let $=_*m;return{p:$,color:r($)}})}if(o>0){let m=g.reduce((b,_,$)=>{if($===0)return 0;let C=So(_.color,g[$-1].color,a);return Math.max(b,C)},0);for(;m>o;){m=0;for(let b=1;b<g.length&&g.length<h;b++){let _=g[b-1],$=g[b],C=($.p+_.p)/2,S=r(C);m=Math.max(m,So(S,_.color),So(S,$.color)),g.splice(b,0,{p:C,color:r(C)}),b++}}}return g=g.map(m=>m.color),g}function Mo(n,e,t={}){if(Vu(n)){let[c,f]=[n,e];return Mo(...c.rangeArgs.colors,{...c.rangeArgs.options,...f})}let{space:r,outputSpace:o,progression:a,premultiplied:u}=t;n=Re(n),e=Re(e),n=Di(n),e=Di(e);let h={colors:[n,e],options:t};if(r?r=be.get(r):r=be.registry[yn.interpolationSpace]||n.space,o=o?be.get(o):r,n=pt(n,r),e=pt(e,r),n=$r(n),e=$r(e),r.coords.h&&r.coords.h.type==="angle"){let c=t.hue=t.hue||"shorter",f=[r,"h"],[p,g]=[bn(n,f),bn(e,f)];isNaN(p)&&!isNaN(g)?p=g:isNaN(g)&&!isNaN(p)&&(g=p),[p,g]=dv(c,[p,g]),lr(n,f,p),lr(e,f,g)}return u&&(n.coords=n.coords.map(c=>c*n.alpha),e.coords=e.coords.map(c=>c*e.alpha)),Object.assign(c=>{c=a?a(c):c;let f=n.coords.map((m,b)=>{let _=e.coords[b];return yo(m,_,c)}),p=yo(n.alpha,e.alpha,c),g={space:r,coords:f,alpha:p};return u&&(g.coords=g.coords.map(m=>m/p)),o!==r&&(g=pt(g,o)),g},{rangeArgs:h})}function Vu(n){return Ir(n)==="function"&&!!n.rangeArgs}yn.interpolationSpace="lab";function N1(n){n.defineFunction("mix",Lf,{returns:"color"}),n.defineFunction("range",Mo,{returns:"function<color>"}),n.defineFunction("steps",Bf,{returns:"array<color>"})}var R1=Object.freeze({__proto__:null,isRange:Vu,mix:Lf,range:Mo,register:N1,steps:Bf}),Ff=new be({id:"hsl",name:"HSL",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:Bi,fromBase:n=>{let e=Math.max(...n),t=Math.min(...n),[r,o,a]=n,[u,h,c]=[NaN,0,(t+e)/2],f=e-t;if(f!==0){switch(h=c===0||c===1?0:(e-c)/Math.min(c,1-c),e){case r:u=(o-a)/f+(o<a?6:0);break;case o:u=(a-r)/f+2;break;case a:u=(r-o)/f+4}u=u*60}return h<0&&(u+=180,h=Math.abs(h)),u>=360&&(u-=360),[u,h*100,c*100]},toBase:n=>{let[e,t,r]=n;e=e%360,e<0&&(e+=360),t/=100,r/=100;function o(a){let u=(a+e/30)%12,h=t*Math.min(r,1-r);return r-h*Math.max(-1,Math.min(u-3,9-u,1))}return[o(0),o(8),o(4)]},formats:{hsl:{coords:["<number> | <angle>","<percentage>","<percentage>"]},hsla:{coords:["<number> | <angle>","<percentage>","<percentage>"],commas:!0,lastAlpha:!0}}}),Uf=new be({id:"hsv",name:"HSV",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},v:{range:[0,100],name:"Value"}},base:Ff,fromBase(n){let[e,t,r]=n;t/=100,r/=100;let o=r+t*Math.min(r,1-r);return[e,o===0?0:200*(1-r/o),100*o]},toBase(n){let[e,t,r]=n;t/=100,r/=100;let o=r*(1-t/2);return[e,o===0||o===1?0:(r-o)/Math.min(o,1-o)*100,o*100]},formats:{color:{id:"--hsv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}}),z1=new be({id:"hwb",name:"HWB",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},w:{range:[0,100],name:"Whiteness"},b:{range:[0,100],name:"Blackness"}},base:Uf,fromBase(n){let[e,t,r]=n;return[e,r*(100-t)/100,100-r]},toBase(n){let[e,t,r]=n;t/=100,r/=100;let o=t+r;if(o>=1){let h=t/o;return[e,0,h*100]}let a=1-r,u=a===0?0:1-t/a;return[e,u*100,a*100]},formats:{hwb:{coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});const D1=[[.5766690429101305,.1855582379065463,.1882286462349947],[.29734497525053605,.6273635662554661,.07529145849399788],[.02703136138641234,.07068885253582723,.9913375368376388]],L1=[[2.0415879038107465,-.5650069742788596,-.34473135077832956],[-.9692436362808795,1.8759675015077202,.04155505740717557],[.013444280632031142,-.11836239223101838,1.0151749943912054]];var Zf=new an({id:"a98rgb-linear",cssId:"--a98-rgb-linear",name:"Linear Adobe® 98 RGB compatible",white:"D65",toXYZ_M:D1,fromXYZ_M:L1}),B1=new an({id:"a98rgb",cssId:"a98-rgb",name:"Adobe® 98 RGB compatible",base:Zf,toBase:n=>n.map(e=>Math.pow(Math.abs(e),563/256)*Math.sign(e)),fromBase:n=>n.map(e=>Math.pow(Math.abs(e),256/563)*Math.sign(e))});const F1=[[.7977666449006423,.13518129740053308,.0313477341283922],[.2880748288194013,.711835234241873,8993693872564e-17],[0,0,.8251046025104602]],U1=[[1.3457868816471583,-.25557208737979464,-.05110186497554526],[-.5446307051249019,1.5082477428451468,.02052744743642139],[0,0,1.2119675456389452]];var qf=new an({id:"prophoto-linear",cssId:"--prophoto-rgb-linear",name:"Linear ProPhoto",white:"D50",base:Nu,toXYZ_M:F1,fromXYZ_M:U1});const Z1=1/512,q1=16/512;var G1=new an({id:"prophoto",cssId:"prophoto-rgb",name:"ProPhoto",base:qf,toBase(n){return n.map(e=>e<q1?e/16:e**1.8)},fromBase(n){return n.map(e=>e>=Z1?e**(1/1.8):16*e)}}),H1=new be({id:"oklch",name:"Oklch",coords:{l:{refRange:[0,1],name:"Lightness"},c:{refRange:[0,.4],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},white:"D65",base:zi,fromBase(n){let[e,t,r]=n,o;const a=2e-4;return Math.abs(t)<a&&Math.abs(r)<a?o=NaN:o=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ir(o)]},toBase(n){let[e,t,r]=n,o,a;return isNaN(r)?(o=0,a=0):(o=t*Math.cos(r*Math.PI/180),a=t*Math.sin(r*Math.PI/180)),[e,o,a]},formats:{oklch:{coords:["<percentage> | <number>","<number> | <percentage>[0,1]","<number> | <angle>"]}}});let Gf=Jt.D65;const W1=216/24389,Hf=24389/27,[Wf,jf]=Rs({space:Ut,coords:Gf});var Vf=new be({id:"luv",name:"Luv",coords:{l:{refRange:[0,100],name:"Lightness"},u:{refRange:[-215,215]},v:{refRange:[-215,215]}},white:Gf,base:Ut,fromBase(n){let e=[Pt(n[0]),Pt(n[1]),Pt(n[2])],t=e[1],[r,o]=Rs({space:Ut,coords:e});if(!Number.isFinite(r)||!Number.isFinite(o))return[0,0,0];let a=t<=W1?Hf*t:116*Math.cbrt(t)-16;return[a,13*a*(r-Wf),13*a*(o-jf)]},toBase(n){let[e,t,r]=n;if(e===0||Pr(e))return[0,0,0];t=Pt(t),r=Pt(r);let o=t/(13*e)+Wf,a=r/(13*e)+jf,u=e<=8?e/Hf:Math.pow((e+16)/116,3);return[u*(9*o/(4*a)),u,u*((12-3*o-20*a)/(4*a))]},formats:{color:{id:"--luv",coords:["<number> | <percentage>","<number> | <percentage>[-1,1]","<number> | <percentage>[-1,1]"]}}}),Ku=new be({id:"lchuv",name:"LChuv",coords:{l:{refRange:[0,100],name:"Lightness"},c:{refRange:[0,220],name:"Chroma"},h:{refRange:[0,360],type:"angle",name:"Hue"}},base:Vf,fromBase(n){let[e,t,r]=n,o;const a=.02;return Math.abs(t)<a&&Math.abs(r)<a?o=NaN:o=Math.atan2(r,t)*180/Math.PI,[e,Math.sqrt(t**2+r**2),ir(o)]},toBase(n){let[e,t,r]=n;return t<0&&(t=0),isNaN(r)&&(r=0),[e,t*Math.cos(r*Math.PI/180),t*Math.sin(r*Math.PI/180)]},formats:{color:{id:"--lchuv",coords:["<number> | <percentage>","<number> | <percentage>","<number> | <angle>"]}}});const j1=216/24389,V1=24389/27,Kf=$t[0][0],Jf=$t[0][1],Ju=$t[0][2],Yf=$t[1][0],Qf=$t[1][1],Yu=$t[1][2],Xf=$t[2][0],ed=$t[2][1],Qu=$t[2][2];function Ui(n,e,t){const r=e/(Math.sin(t)-n*Math.cos(t));return r<0?1/0:r}function zs(n){const e=Math.pow(n+16,3)/1560896,t=e>j1?e:n/V1,r=t*(284517*Kf-94839*Ju),o=t*(838422*Ju+769860*Jf+731718*Kf),a=t*(632260*Ju-126452*Jf),u=t*(284517*Yf-94839*Yu),h=t*(838422*Yu+769860*Qf+731718*Yf),c=t*(632260*Yu-126452*Qf),f=t*(284517*Xf-94839*Qu),p=t*(838422*Qu+769860*ed+731718*Xf),g=t*(632260*Qu-126452*ed);return{r0s:r/a,r0i:o*n/a,r1s:r/(a+126452),r1i:(o-769860)*n/(a+126452),g0s:u/c,g0i:h*n/c,g1s:u/(c+126452),g1i:(h-769860)*n/(c+126452),b0s:f/g,b0i:p*n/g,b1s:f/(g+126452),b1i:(p-769860)*n/(g+126452)}}function td(n,e){const t=e/360*Math.PI*2,r=Ui(n.r0s,n.r0i,t),o=Ui(n.r1s,n.r1i,t),a=Ui(n.g0s,n.g0i,t),u=Ui(n.g1s,n.g1i,t),h=Ui(n.b0s,n.b0i,t),c=Ui(n.b1s,n.b1i,t);return Math.min(r,o,a,u,h,c)}var K1=new be({id:"hsluv",name:"HSLuv",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:Ku,gamutSpace:Bi,fromBase(n){let[e,t,r]=[Pt(n[0]),Pt(n[1]),Pt(n[2])],o;if(e>99.9999999)o=0,e=100;else if(e<1e-8)o=0,e=0;else{let a=zs(e),u=td(a,r);o=t/u*100}return[r,o,e]},toBase(n){let[e,t,r]=[Pt(n[0]),Pt(n[1]),Pt(n[2])],o;if(r>99.9999999)r=100,o=0;else if(r<1e-8)r=0,o=0;else{let a=zs(r);o=td(a,e)/100*t}return[r,o,e]},formats:{color:{id:"--hsluv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});$t[0][0],$t[0][1],$t[0][2],$t[1][0],$t[1][1],$t[1][2],$t[2][0],$t[2][1],$t[2][2];function Zi(n,e){return Math.abs(e)/Math.sqrt(Math.pow(n,2)+1)}function nd(n){let e=Zi(n.r0s,n.r0i),t=Zi(n.r1s,n.r1i),r=Zi(n.g0s,n.g0i),o=Zi(n.g1s,n.g1i),a=Zi(n.b0s,n.b0i),u=Zi(n.b1s,n.b1i);return Math.min(e,t,r,o,a,u)}var J1=new be({id:"hpluv",name:"HPLuv",coords:{h:{refRange:[0,360],type:"angle",name:"Hue"},s:{range:[0,100],name:"Saturation"},l:{range:[0,100],name:"Lightness"}},base:Ku,gamutSpace:"self",fromBase(n){let[e,t,r]=[Pt(n[0]),Pt(n[1]),Pt(n[2])],o;if(e>99.9999999)o=0,e=100;else if(e<1e-8)o=0,e=0;else{let a=zs(e),u=nd(a);o=t/u*100}return[r,o,e]},toBase(n){let[e,t,r]=[Pt(n[0]),Pt(n[1]),Pt(n[2])],o;if(r>99.9999999)r=100,o=0;else if(r<1e-8)r=0,o=0;else{let a=zs(r);o=nd(a)/100*t}return[r,o,e]},formats:{color:{id:"--hpluv",coords:["<number> | <angle>","<percentage> | <number>","<percentage> | <number>"]}}});const rd=203,id=2610/2**14,Y1=2**14/2610,Q1=2523/2**5,od=2**5/2523,sd=3424/2**12,ad=2413/2**7,ud=2392/2**7;var X1=new an({id:"rec2100pq",cssId:"rec2100-pq",name:"REC.2100-PQ",base:ks,toBase(n){return n.map(function(e){return(Math.max(e**od-sd,0)/(ad-ud*e**od))**Y1*1e4/rd})},fromBase(n){return n.map(function(e){let t=Math.max(e*rd/1e4,0),r=sd+ad*t**id,o=1+ud*t**id;return(r/o)**Q1})}});const ld=.17883277,cd=.28466892,hd=.55991073,Xu=3.7743;var e_=new an({id:"rec2100hlg",cssId:"rec2100-hlg",name:"REC.2100-HLG",referred:"scene",base:ks,toBase(n){return n.map(function(e){return e<=.5?e**2/3*Xu:(Math.exp((e-hd)/ld)+cd)/12*Xu})},fromBase(n){return n.map(function(e){return e/=Xu,e<=1/12?Math.sqrt(3*e):ld*Math.log(12*e-cd)+hd})}});const fd={};kr.add("chromatic-adaptation-start",n=>{n.options.method&&(n.M=dd(n.W1,n.W2,n.options.method))}),kr.add("chromatic-adaptation-end",n=>{n.M||(n.M=dd(n.W1,n.W2,n.options.method))});function Ds({id:n,toCone_M:e,fromCone_M:t}){fd[n]=arguments[0]}function dd(n,e,t="Bradford"){let r=fd[t],[o,a,u]=Ne(r.toCone_M,n),[h,c,f]=Ne(r.toCone_M,e),p=[[h/o,0,0],[0,c/a,0],[0,0,f/u]],g=Ne(p,r.toCone_M);return Ne(r.fromCone_M,g)}Ds({id:"von Kries",toCone_M:[[.40024,.7076,-.08081],[-.2263,1.16532,.0457],[0,0,.91822]],fromCone_M:[[1.8599363874558397,-1.1293816185800916,.21989740959619328],[.3611914362417676,.6388124632850422,-6370596838649899e-21],[0,0,1.0890636230968613]]}),Ds({id:"Bradford",toCone_M:[[.8951,.2664,-.1614],[-.7502,1.7135,.0367],[.0389,-.0685,1.0296]],fromCone_M:[[.9869929054667121,-.14705425642099013,.15996265166373122],[.4323052697233945,.5183602715367774,.049291228212855594],[-.00852866457517732,.04004282165408486,.96848669578755]]}),Ds({id:"CAT02",toCone_M:[[.7328,.4296,-.1624],[-.7036,1.6975,.0061],[.003,.0136,.9834]],fromCone_M:[[1.0961238208355142,-.27886900021828726,.18274517938277307],[.4543690419753592,.4735331543074117,.07209780371722911],[-.009627608738429355,-.00569803121611342,1.0153256399545427]]}),Ds({id:"CAT16",toCone_M:[[.401288,.650173,-.051461],[-.250268,1.204414,.045854],[-.002079,.048952,.953127]],fromCone_M:[[1.862067855087233,-1.0112546305316845,.14918677544445172],[.3875265432361372,.6214474419314753,-.008973985167612521],[-.01584149884933386,-.03412293802851557,1.0499644368778496]]}),Object.assign(Jt,{A:[1.0985,1,.35585],C:[.98074,1,1.18232],D55:[.95682,1,.92149],D75:[.94972,1,1.22638],E:[1,1,1],F2:[.99186,1,.67393],F7:[.95041,1,1.08747],F11:[1.00962,1,.6435]}),Jt.ACES=[.32168/.33767,1,(1-.32168-.33767)/.33767];const t_=[[.6624541811085053,.13400420645643313,.1561876870049078],[.27222871678091454,.6740817658111484,.05368951740793705],[-.005574649490394108,.004060733528982826,1.0103391003129971]],n_=[[1.6410233796943257,-.32480329418479,-.23642469523761225],[-.6636628587229829,1.6153315916573379,.016756347685530137],[.011721894328375376,-.008284441996237409,.9883948585390215]];var pd=new an({id:"acescg",cssId:"--acescg",name:"ACEScg",coords:{r:{range:[0,65504],name:"Red"},g:{range:[0,65504],name:"Green"},b:{range:[0,65504],name:"Blue"}},referred:"scene",white:Jt.ACES,toXYZ_M:t_,fromXYZ_M:n_});const Ls=2**-16,el=-.35828683,Bs=(Math.log2(65504)+9.72)/17.52;var r_=new an({id:"acescc",cssId:"--acescc",name:"ACEScc",coords:{r:{range:[el,Bs],name:"Red"},g:{range:[el,Bs],name:"Green"},b:{range:[el,Bs],name:"Blue"}},referred:"scene",base:pd,toBase(n){const e=-.3013698630136986;return n.map(function(t){return t<=e?(2**(t*17.52-9.72)-Ls)*2:t<Bs?2**(t*17.52-9.72):65504})},fromBase(n){return n.map(function(e){return e<=0?(Math.log2(Ls)+9.72)/17.52:e<Ls?(Math.log2(Ls+e*.5)+9.72)/17.52:(Math.log2(e)+9.72)/17.52})}}),gd=Object.freeze({__proto__:null,A98RGB:B1,A98RGB_Linear:Zf,ACEScc:r_,ACEScg:pd,CAM16_JMh:Hv,HCT:xo,HPLuv:J1,HSL:Ff,HSLuv:K1,HSV:Uf,HWB:z1,ICTCP:Fu,JzCzHz:Bu,Jzazbz:of,LCH:wo,LCHuv:Ku,Lab:wn,Lab_D65:Wu,Luv:Vf,OKLCH:H1,OKLab:zi,P3:kf,P3_Linear:Ef,ProPhoto:G1,ProPhoto_Linear:qf,REC_2020:Mf,REC_2020_Linear:ks,REC_2100_HLG:e_,REC_2100_PQ:X1,XYZ_ABS_D65:Du,XYZ_D50:Nu,XYZ_D65:Ut,sRGB:Bi,sRGB_Linear:Cf});class st{constructor(...e){let t;e.length===1&&(t=Re(e[0]));let r,o,a;t?(r=t.space||t.spaceId,o=t.coords,a=t.alpha):[r,o,a]=e,Object.defineProperty(this,"space",{value:be.get(r),writable:!1,enumerable:!0,configurable:!0}),this.coords=o?o.slice():[0,0,0],this.alpha=a>1||a===void 0?1:a<0?0:a;for(let u=0;u<this.coords.length;u++)this.coords[u]==="NaN"&&(this.coords[u]=NaN);for(let u in this.space.coords)Object.defineProperty(this,u,{get:()=>this.get(u),set:h=>this.set(u,h)})}get spaceId(){return this.space.id}clone(){return new st(this.space,this.coords,this.alpha)}toJSON(){return{spaceId:this.spaceId,coords:this.coords,alpha:this.alpha}}display(...e){let t=a1(this,...e);return t.color=new st(t.color),t}static get(e,...t){return e instanceof st?e:new st(e,...t)}static defineFunction(e,t,r=t){let{instance:o=!0,returns:a}=r,u=function(...h){let c=t(...h);if(a==="color")c=st.get(c);else if(a==="function<color>"){let f=c;c=function(...p){let g=f(...p);return st.get(g)},Object.assign(c,f)}else a==="array<color>"&&(c=c.map(f=>st.get(f)));return c};e in st||(st[e]=u),o&&(st.prototype[e]=function(...h){return u(this,...h)})}static defineFunctions(e){for(let t in e)st.defineFunction(t,e[t],e[t])}static extend(e){if(e.register)e.register(st);else for(let t in e)st.defineFunction(t,e[t])}}st.defineFunctions({get:bn,getAll:bo,set:lr,setAll:Ou,to:pt,equals:u1,inGamut:ii,toGamut:$r,distance:Jh,toString:To}),Object.assign(st,{util:av,hooks:kr,WHITES:Jt,Space:be,spaces:be.registry,parse:qh,defaults:yn});for(let n of Object.keys(gd))be.register(gd[n]);for(let n in be.registry)tl(n,be.registry[n]);kr.add("colorspace-init-end",n=>{var e;tl(n.id,n),(e=n.aliases)==null||e.forEach(t=>{tl(t,n)})});function tl(n,e){let t=n.replace(/-/g,"_");Object.defineProperty(st.prototype,t,{get(){let r=this.getAll(n);return typeof Proxy>"u"?r:new Proxy(r,{has:(o,a)=>{try{return be.resolveCoord([e,a]),!0}catch{}return Reflect.has(o,a)},get:(o,a,u)=>{if(a&&typeof a!="symbol"&&!(a in o)){let{index:h}=be.resolveCoord([e,a]);if(h>=0)return o[h]}return Reflect.get(o,a,u)},set:(o,a,u,h)=>{if(a&&typeof a!="symbol"&&!(a in o)||a>=0){let{index:c}=be.resolveCoord([e,a]);if(c>=0)return o[c]=u,this.setAll(n,o),!0}return Reflect.set(o,a,u,h)}})},set(r){this.setAll(n,r)},configurable:!0,enumerable:!0})}st.extend(Li),st.extend({deltaE:So}),Object.assign(st,{deltaEMethods:Li}),st.extend(O1),st.extend({contrast:A1}),st.extend(P1),st.extend(c1),st.extend(R1),st.extend(Ns);function J(n,e,t){function r(h,c){var f;Object.defineProperty(h,"_zod",{value:h._zod??{},enumerable:!1}),(f=h._zod).traits??(f.traits=new Set),h._zod.traits.add(n),e(h,c);for(const p in u.prototype)p in h||Object.defineProperty(h,p,{value:u.prototype[p].bind(h)});h._zod.constr=u,h._zod.def=c}const o=(t==null?void 0:t.Parent)??Object;class a extends o{}Object.defineProperty(a,"name",{value:n});function u(h){var c;const f=t!=null&&t.Parent?new a:this;r(f,h),(c=f._zod).deferred??(c.deferred=[]);for(const p of f._zod.deferred)p();return f}return Object.defineProperty(u,"init",{value:r}),Object.defineProperty(u,Symbol.hasInstance,{value:h=>{var c,f;return t!=null&&t.Parent&&h instanceof t.Parent?!0:(f=(c=h==null?void 0:h._zod)==null?void 0:c.traits)==null?void 0:f.has(n)}}),Object.defineProperty(u,"name",{value:n}),u}class Eo extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const md={};function Nr(n){return md}function i_(n){const e=Object.values(n).filter(r=>typeof r=="number");return Object.entries(n).filter(([r,o])=>e.indexOf(+r)===-1).map(([r,o])=>o)}function o_(n,e){return typeof e=="bigint"?e.toString():e}function nl(n){return{get value(){{const e=n();return Object.defineProperty(this,"value",{value:e}),e}}}}function rl(n){return n==null}function il(n){const e=n.startsWith("^")?1:0,t=n.endsWith("$")?n.length-1:n.length;return n.slice(e,t)}function s_(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,o=t>r?t:r,a=Number.parseInt(n.toFixed(o).replace(".","")),u=Number.parseInt(e.toFixed(o).replace(".",""));return a%u/10**o}function gt(n,e,t){Object.defineProperty(n,e,{get(){{const r=t();return n[e]=r,r}},set(r){Object.defineProperty(n,e,{value:r})},configurable:!0})}function Co(n,e,t){Object.defineProperty(n,e,{value:t,writable:!0,enumerable:!0,configurable:!0})}function vd(n=10){const e="abcdefghijklmnopqrstuvwxyz";let t="";for(let r=0;r<n;r++)t+=e[Math.floor(Math.random()*e.length)];return t}function Ao(n){return JSON.stringify(n)}const _d=Error.captureStackTrace?Error.captureStackTrace:(...n)=>{};function Fs(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const a_=nl(()=>{var n;if(typeof navigator<"u"&&((n=navigator==null?void 0:navigator.userAgent)!=null&&n.includes("Cloudflare")))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function ol(n){if(Fs(n)===!1)return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(Fs(t)===!1||Object.prototype.hasOwnProperty.call(t,"isPrototypeOf")===!1)}const u_=new Set(["string","number","symbol"]);function Io(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function si(n,e,t){const r=new n._zod.constr(e??n._zod.def);return(!e||t!=null&&t.parent)&&(r._zod.parent=n),r}function ve(n){const e=n;if(!e)return{};if(typeof e=="string")return{error:()=>e};if((e==null?void 0:e.message)!==void 0){if((e==null?void 0:e.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function l_(n){return Object.keys(n).filter(e=>n[e]._zod.optin==="optional"&&n[e]._zod.optout==="optional")}const c_={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function h_(n,e){const t={},r=n._zod.def;for(const o in e){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&(t[o]=r.shape[o])}return si(n,{...n._zod.def,shape:t,checks:[]})}function f_(n,e){const t={...n._zod.def.shape},r=n._zod.def;for(const o in e){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);e[o]&&delete t[o]}return si(n,{...n._zod.def,shape:t,checks:[]})}function d_(n,e){const t={...n._zod.def,get shape(){const r={...n._zod.def.shape,...e};return Co(this,"shape",r),r},checks:[]};return si(n,t)}function p_(n,e){return si(n,{...n._zod.def,get shape(){const t={...n._zod.def.shape,...e._zod.def.shape};return Co(this,"shape",t),t},catchall:e._zod.def.catchall,checks:[]})}function g_(n,e,t){const r=e._zod.def.shape,o={...r};if(t)for(const a in t){if(!(a in r))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(o[a]=n?new n({type:"optional",innerType:r[a]}):r[a])}else for(const a in r)o[a]=n?new n({type:"optional",innerType:r[a]}):r[a];return si(e,{...e._zod.def,shape:o,checks:[]})}function m_(n,e,t){const r=e._zod.def.shape,o={...r};if(t)for(const a in t){if(!(a in o))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(o[a]=new n({type:"nonoptional",innerType:r[a]}))}else for(const a in r)o[a]=new n({type:"nonoptional",innerType:r[a]});return si(e,{...e._zod.def,shape:o,checks:[]})}function Po(n,e=0){for(let t=e;t<n.issues.length;t++)if(n.issues[t].continue!==!0)return!0;return!1}function ai(n,e){return e.map(t=>{var r;return(r=t).path??(r.path=[]),t.path.unshift(n),t})}function Us(n){return typeof n=="string"?n:n==null?void 0:n.message}function Rr(n,e,t){var o,a,u,h,c,f;const r={...n,path:n.path??[]};if(!n.message){const p=Us((u=(a=(o=n.inst)==null?void 0:o._zod.def)==null?void 0:a.error)==null?void 0:u.call(a,n))??Us((h=e==null?void 0:e.error)==null?void 0:h.call(e,n))??Us((c=t.customError)==null?void 0:c.call(t,n))??Us((f=t.localeError)==null?void 0:f.call(t,n))??"Invalid input";r.message=p}return delete r.inst,delete r.continue,e!=null&&e.reportInput||delete r.input,r}function sl(n){return Array.isArray(n)?"array":typeof n=="string"?"string":"unknown"}function ko(...n){const[e,t,r]=n;return typeof e=="string"?{message:e,code:"custom",input:t,inst:r}:{...e}}const yd=(n,e)=>{n.name="$ZodError",Object.defineProperty(n,"_zod",{value:n._zod,enumerable:!1}),Object.defineProperty(n,"issues",{value:e,enumerable:!1}),Object.defineProperty(n,"message",{get(){return JSON.stringify(e,o_,2)},enumerable:!0})},bd=J("$ZodError",yd),wd=J("$ZodError",yd,{Parent:Error});function v_(n,e=t=>t.message){const t={},r=[];for(const o of n.issues)o.path.length>0?(t[o.path[0]]=t[o.path[0]]||[],t[o.path[0]].push(e(o))):r.push(e(o));return{formErrors:r,fieldErrors:t}}function __(n,e){const t=e||function(a){return a.message},r={_errors:[]},o=a=>{for(const u of a.issues)if(u.code==="invalid_union"&&u.errors.length)u.errors.map(h=>o({issues:h}));else if(u.code==="invalid_key")o({issues:u.issues});else if(u.code==="invalid_element")o({issues:u.issues});else if(u.path.length===0)r._errors.push(t(u));else{let h=r,c=0;for(;c<u.path.length;){const f=u.path[c];c===u.path.length-1?(h[f]=h[f]||{_errors:[]},h[f]._errors.push(t(u))):h[f]=h[f]||{_errors:[]},h=h[f],c++}}};return o(n),r}function y_(n){const e=[];for(const t of n)typeof t=="number"?e.push(`[${t}]`):typeof t=="symbol"?e.push(`[${JSON.stringify(String(t))}]`):/[^\w$]/.test(t)?e.push(`[${JSON.stringify(t)}]`):(e.length&&e.push("."),e.push(t));return e.join("")}function b_(n){var r;const e=[],t=[...n.issues].sort((o,a)=>o.path.length-a.path.length);for(const o of t)e.push(`✖ ${o.message}`),(r=o.path)!=null&&r.length&&e.push(`  → at ${y_(o.path)}`);return e.join(`
`)}const w_=n=>(e,t,r,o)=>{const a=r?Object.assign(r,{async:!1}):{async:!1},u=e._zod.run({value:t,issues:[]},a);if(u instanceof Promise)throw new Eo;if(u.issues.length){const h=new((o==null?void 0:o.Err)??n)(u.issues.map(c=>Rr(c,a,Nr())));throw _d(h,o==null?void 0:o.callee),h}return u.value},x_=n=>async(e,t,r,o)=>{const a=r?Object.assign(r,{async:!0}):{async:!0};let u=e._zod.run({value:t,issues:[]},a);if(u instanceof Promise&&(u=await u),u.issues.length){const h=new((o==null?void 0:o.Err)??n)(u.issues.map(c=>Rr(c,a,Nr())));throw _d(h,o==null?void 0:o.callee),h}return u.value},xd=n=>(e,t,r)=>{const o=r?{...r,async:!1}:{async:!1},a=e._zod.run({value:t,issues:[]},o);if(a instanceof Promise)throw new Eo;return a.issues.length?{success:!1,error:new(n??bd)(a.issues.map(u=>Rr(u,o,Nr())))}:{success:!0,data:a.value}},T_=xd(wd),Td=n=>async(e,t,r)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let a=e._zod.run({value:t,issues:[]},o);return a instanceof Promise&&(a=await a),a.issues.length?{success:!1,error:new n(a.issues.map(u=>Rr(u,o,Nr())))}:{success:!0,data:a.value}},Sd=Td(wd),S_=/^[cC][^\s-]{8,}$/,M_=/^[0-9a-z]+$/,E_=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,C_=/^[0-9a-vA-V]{20}$/,A_=/^[A-Za-z0-9]{27}$/,I_=/^[a-zA-Z0-9_-]{21}$/,P_=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,k_=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Md=n=>n?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${n}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,$_=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,O_="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function N_(){return new RegExp(O_,"u")}const R_=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,z_=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,D_=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,L_=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,B_=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Ed=/^[A-Za-z0-9_-]*$/,F_=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,U_=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,Z_=/^\+(?:[0-9]){6,14}[0-9]$/,Cd="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",q_=new RegExp(`^${Cd}$`);function Ad(n){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof n.precision=="number"?n.precision===-1?`${e}`:n.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${n.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function G_(n){return new RegExp(`^${Ad(n)}$`)}function H_(n){const e=Ad({precision:n.precision}),t=["Z"];n.local&&t.push(""),n.offset&&t.push("([+-]\\d{2}:\\d{2})");const r=`${e}(?:${t.join("|")})`;return new RegExp(`^${Cd}T(?:${r})$`)}const W_=n=>{const e=n?`[\\s\\S]{${(n==null?void 0:n.minimum)??0},${(n==null?void 0:n.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},j_=/^\d+$/,V_=/^-?\d+(?:\.\d+)?/i,K_=/true|false/i,J_=/null/i,Y_=/^[^A-Z]*$/,Q_=/^[^a-z]*$/,un=J("$ZodCheck",(n,e)=>{var t;n._zod??(n._zod={}),n._zod.def=e,(t=n._zod).onattach??(t.onattach=[])}),Id={number:"number",bigint:"bigint",object:"date"},Pd=J("$ZodCheckLessThan",(n,e)=>{un.init(n,e);const t=Id[typeof e.value];n._zod.onattach.push(r=>{const o=r._zod.bag,a=(e.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<a&&(e.inclusive?o.maximum=e.value:o.exclusiveMaximum=e.value)}),n._zod.check=r=>{(e.inclusive?r.value<=e.value:r.value<e.value)||r.issues.push({origin:t,code:"too_big",maximum:e.value,input:r.value,inclusive:e.inclusive,inst:n,continue:!e.abort})}}),kd=J("$ZodCheckGreaterThan",(n,e)=>{un.init(n,e);const t=Id[typeof e.value];n._zod.onattach.push(r=>{const o=r._zod.bag,a=(e.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>a&&(e.inclusive?o.minimum=e.value:o.exclusiveMinimum=e.value)}),n._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({origin:t,code:"too_small",minimum:e.value,input:r.value,inclusive:e.inclusive,inst:n,continue:!e.abort})}}),X_=J("$ZodCheckMultipleOf",(n,e)=>{un.init(n,e),n._zod.onattach.push(t=>{var r;(r=t._zod.bag).multipleOf??(r.multipleOf=e.value)}),n._zod.check=t=>{if(typeof t.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof t.value=="bigint"?t.value%e.value===BigInt(0):s_(t.value,e.value)===0)||t.issues.push({origin:typeof t.value,code:"not_multiple_of",divisor:e.value,input:t.value,inst:n,continue:!e.abort})}}),ey=J("$ZodCheckNumberFormat",(n,e)=>{var u;un.init(n,e),e.format=e.format||"float64";const t=(u=e.format)==null?void 0:u.includes("int"),r=t?"int":"number",[o,a]=c_[e.format];n._zod.onattach.push(h=>{const c=h._zod.bag;c.format=e.format,c.minimum=o,c.maximum=a,t&&(c.pattern=j_)}),n._zod.check=h=>{const c=h.value;if(t){if(!Number.isInteger(c)){h.issues.push({expected:r,format:e.format,code:"invalid_type",input:c,inst:n});return}if(!Number.isSafeInteger(c)){c>0?h.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:r,continue:!e.abort}):h.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:r,continue:!e.abort});return}}c<o&&h.issues.push({origin:"number",input:c,code:"too_small",minimum:o,inclusive:!0,inst:n,continue:!e.abort}),c>a&&h.issues.push({origin:"number",input:c,code:"too_big",maximum:a,inst:n})}}),ty=J("$ZodCheckMaxLength",(n,e)=>{un.init(n,e),n._zod.when=t=>{const r=t.value;return!rl(r)&&r.length!==void 0},n._zod.onattach.push(t=>{const r=t._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<r&&(t._zod.bag.maximum=e.maximum)}),n._zod.check=t=>{const r=t.value;if(r.length<=e.maximum)return;const a=sl(r);t.issues.push({origin:a,code:"too_big",maximum:e.maximum,inclusive:!0,input:r,inst:n,continue:!e.abort})}}),ny=J("$ZodCheckMinLength",(n,e)=>{un.init(n,e),n._zod.when=t=>{const r=t.value;return!rl(r)&&r.length!==void 0},n._zod.onattach.push(t=>{const r=t._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>r&&(t._zod.bag.minimum=e.minimum)}),n._zod.check=t=>{const r=t.value;if(r.length>=e.minimum)return;const a=sl(r);t.issues.push({origin:a,code:"too_small",minimum:e.minimum,inclusive:!0,input:r,inst:n,continue:!e.abort})}}),ry=J("$ZodCheckLengthEquals",(n,e)=>{un.init(n,e),n._zod.when=t=>{const r=t.value;return!rl(r)&&r.length!==void 0},n._zod.onattach.push(t=>{const r=t._zod.bag;r.minimum=e.length,r.maximum=e.length,r.length=e.length}),n._zod.check=t=>{const r=t.value,o=r.length;if(o===e.length)return;const a=sl(r),u=o>e.length;t.issues.push({origin:a,...u?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},input:t.value,inst:n,continue:!e.abort})}}),Zs=J("$ZodCheckStringFormat",(n,e)=>{var t;un.init(n,e),n._zod.onattach.push(r=>{const o=r._zod.bag;o.format=e.format,e.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(e.pattern))}),(t=n._zod).check??(t.check=r=>{if(!e.pattern)throw new Error("Not implemented.");e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:e.format,input:r.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:n,continue:!e.abort})})}),iy=J("$ZodCheckRegex",(n,e)=>{Zs.init(n,e),n._zod.check=t=>{e.pattern.lastIndex=0,!e.pattern.test(t.value)&&t.issues.push({origin:"string",code:"invalid_format",format:"regex",input:t.value,pattern:e.pattern.toString(),inst:n,continue:!e.abort})}}),oy=J("$ZodCheckLowerCase",(n,e)=>{e.pattern??(e.pattern=Y_),Zs.init(n,e)}),sy=J("$ZodCheckUpperCase",(n,e)=>{e.pattern??(e.pattern=Q_),Zs.init(n,e)}),ay=J("$ZodCheckIncludes",(n,e)=>{un.init(n,e);const t=Io(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${t}`:t);e.pattern=r,n._zod.onattach.push(o=>{const a=o._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),n._zod.check=o=>{o.value.includes(e.includes,e.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:o.value,inst:n,continue:!e.abort})}}),uy=J("$ZodCheckStartsWith",(n,e)=>{un.init(n,e);const t=new RegExp(`^${Io(e.prefix)}.*`);e.pattern??(e.pattern=t),n._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(t)}),n._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:n,continue:!e.abort})}}),ly=J("$ZodCheckEndsWith",(n,e)=>{un.init(n,e);const t=new RegExp(`.*${Io(e.suffix)}$`);e.pattern??(e.pattern=t),n._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(t)}),n._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:n,continue:!e.abort})}}),cy=J("$ZodCheckOverwrite",(n,e)=>{un.init(n,e),n._zod.check=t=>{t.value=e.tx(t.value)}});class hy{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(u=>u),o=Math.min(...r.map(u=>u.length-u.trimStart().length)),a=r.map(u=>u.slice(o)).map(u=>" ".repeat(this.indent*2)+u);for(const u of a)this.content.push(u)}compile(){const e=Function,t=this==null?void 0:this.args,o=[...((this==null?void 0:this.content)??[""]).map(a=>`  ${a}`)];return new e(...t,o.join(`
`))}}const fy={major:4,minor:0,patch:0},ht=J("$ZodType",(n,e)=>{var o;var t;n??(n={}),gt(n._zod,"id",()=>e.type+"_"+vd(10)),n._zod.def=e,n._zod.bag=n._zod.bag||{},n._zod.version=fy;const r=[...n._zod.def.checks??[]];n._zod.traits.has("$ZodCheck")&&r.unshift(n);for(const a of r)for(const u of a._zod.onattach)u(n);if(r.length===0)(t=n._zod).deferred??(t.deferred=[]),(o=n._zod.deferred)==null||o.push(()=>{n._zod.run=n._zod.parse});else{const a=(u,h,c)=>{let f=Po(u),p;for(const g of h){if(g._zod.when){if(!g._zod.when(u))continue}else if(f)continue;const m=u.issues.length,b=g._zod.check(u);if(b instanceof Promise&&(c==null?void 0:c.async)===!1)throw new Eo;if(p||b instanceof Promise)p=(p??Promise.resolve()).then(async()=>{await b,u.issues.length!==m&&(f||(f=Po(u,m)))});else{if(u.issues.length===m)continue;f||(f=Po(u,m))}}return p?p.then(()=>u):u};n._zod.run=(u,h)=>{const c=n._zod.parse(u,h);if(c instanceof Promise){if(h.async===!1)throw new Eo;return c.then(f=>a(f,r,h))}return a(c,r,h)}}n["~standard"]={validate:a=>{var u;try{const h=T_(n,a);return h.success?{value:h.data}:{issues:(u=h.error)==null?void 0:u.issues}}catch{return Sd(n,a).then(c=>{var f;return c.success?{value:c.data}:{issues:(f=c.error)==null?void 0:f.issues}})}},vendor:"zod",version:1}}),al=J("$ZodString",(n,e)=>{var t;ht.init(n,e),n._zod.pattern=[...((t=n==null?void 0:n._zod.bag)==null?void 0:t.patterns)??[]].pop()??W_(n._zod.bag),n._zod.parse=(r,o)=>{if(e.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:n}),r}}),mt=J("$ZodStringFormat",(n,e)=>{Zs.init(n,e),al.init(n,e)}),dy=J("$ZodGUID",(n,e)=>{e.pattern??(e.pattern=k_),mt.init(n,e)}),py=J("$ZodUUID",(n,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Md(r))}else e.pattern??(e.pattern=Md());mt.init(n,e)}),gy=J("$ZodEmail",(n,e)=>{e.pattern??(e.pattern=$_),mt.init(n,e)}),my=J("$ZodURL",(n,e)=>{mt.init(n,e),n._zod.check=t=>{try{const r=new URL(t.value);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(r.hostname)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:F_.source,input:t.value,inst:n,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||t.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:t.value,inst:n,continue:!e.abort}));return}catch{t.issues.push({code:"invalid_format",format:"url",input:t.value,inst:n,continue:!e.abort})}}}),vy=J("$ZodEmoji",(n,e)=>{e.pattern??(e.pattern=N_()),mt.init(n,e)}),_y=J("$ZodNanoID",(n,e)=>{e.pattern??(e.pattern=I_),mt.init(n,e)}),yy=J("$ZodCUID",(n,e)=>{e.pattern??(e.pattern=S_),mt.init(n,e)}),by=J("$ZodCUID2",(n,e)=>{e.pattern??(e.pattern=M_),mt.init(n,e)}),wy=J("$ZodULID",(n,e)=>{e.pattern??(e.pattern=E_),mt.init(n,e)}),xy=J("$ZodXID",(n,e)=>{e.pattern??(e.pattern=C_),mt.init(n,e)}),Ty=J("$ZodKSUID",(n,e)=>{e.pattern??(e.pattern=A_),mt.init(n,e)}),Sy=J("$ZodISODateTime",(n,e)=>{e.pattern??(e.pattern=H_(e)),mt.init(n,e),n._zod.check}),My=J("$ZodISODate",(n,e)=>{e.pattern??(e.pattern=q_),mt.init(n,e)}),Ey=J("$ZodISOTime",(n,e)=>{e.pattern??(e.pattern=G_(e)),mt.init(n,e),n._zod.check}),Cy=J("$ZodISODuration",(n,e)=>{e.pattern??(e.pattern=P_),mt.init(n,e)}),Ay=J("$ZodIPv4",(n,e)=>{e.pattern??(e.pattern=R_),mt.init(n,e),n._zod.onattach.push(t=>{const r=t._zod.bag;r.format="ipv4"})}),Iy=J("$ZodIPv6",(n,e)=>{e.pattern??(e.pattern=z_),mt.init(n,e),n._zod.onattach.push(t=>{const r=t._zod.bag;r.format="ipv6"}),n._zod.check=t=>{try{new URL(`http://[${t.value}]`)}catch{t.issues.push({code:"invalid_format",format:"ipv6",input:t.value,inst:n,continue:!e.abort})}}}),Py=J("$ZodCIDRv4",(n,e)=>{e.pattern??(e.pattern=D_),mt.init(n,e)}),ky=J("$ZodCIDRv6",(n,e)=>{e.pattern??(e.pattern=L_),mt.init(n,e),n._zod.check=t=>{const[r,o]=t.value.split("/");try{if(!o)throw new Error;const a=Number(o);if(`${a}`!==o)throw new Error;if(a<0||a>128)throw new Error;new URL(`http://[${r}]`)}catch{t.issues.push({code:"invalid_format",format:"cidrv6",input:t.value,inst:n,continue:!e.abort})}}});function $d(n){if(n==="")return!0;if(n.length%4!==0)return!1;try{return atob(n),!0}catch{return!1}}const $y=J("$ZodBase64",(n,e)=>{e.pattern??(e.pattern=B_),mt.init(n,e),n._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64"}),n._zod.check=t=>{$d(t.value)||t.issues.push({code:"invalid_format",format:"base64",input:t.value,inst:n,continue:!e.abort})}});function Oy(n){if(!Ed.test(n))return!1;const e=n.replace(/[-_]/g,r=>r==="-"?"+":"/"),t=e.padEnd(Math.ceil(e.length/4)*4,"=");return $d(t)}const Ny=J("$ZodBase64URL",(n,e)=>{e.pattern??(e.pattern=Ed),mt.init(n,e),n._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64url"}),n._zod.check=t=>{Oy(t.value)||t.issues.push({code:"invalid_format",format:"base64url",input:t.value,inst:n,continue:!e.abort})}}),Ry=J("$ZodE164",(n,e)=>{e.pattern??(e.pattern=Z_),mt.init(n,e)});function zy(n,e=null){try{const t=n.split(".");if(t.length!==3)return!1;const[r]=t,o=JSON.parse(atob(r));return!("typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||e&&(!("alg"in o)||o.alg!==e))}catch{return!1}}const Dy=J("$ZodJWT",(n,e)=>{mt.init(n,e),n._zod.check=t=>{zy(t.value,e.alg)||t.issues.push({code:"invalid_format",format:"jwt",input:t.value,inst:n,continue:!e.abort})}}),Od=J("$ZodNumber",(n,e)=>{ht.init(n,e),n._zod.pattern=n._zod.bag.pattern??V_,n._zod.parse=(t,r)=>{if(e.coerce)try{t.value=Number(t.value)}catch{}const o=t.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return t;const a=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return t.issues.push({expected:"number",code:"invalid_type",input:o,inst:n,...a?{received:a}:{}}),t}}),Ly=J("$ZodNumber",(n,e)=>{ey.init(n,e),Od.init(n,e)}),By=J("$ZodBoolean",(n,e)=>{ht.init(n,e),n._zod.pattern=K_,n._zod.parse=(t,r)=>{if(e.coerce)try{t.value=!!t.value}catch{}const o=t.value;return typeof o=="boolean"||t.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:n}),t}}),Fy=J("$ZodNull",(n,e)=>{ht.init(n,e),n._zod.pattern=J_,n._zod.values=new Set([null]),n._zod.parse=(t,r)=>{const{value:o}=t;return o===null||t.issues.push({expected:"null",code:"invalid_type",input:o,inst:n}),t}}),Uy=J("$ZodUnknown",(n,e)=>{ht.init(n,e),n._zod.parse=t=>t}),Zy=J("$ZodNever",(n,e)=>{ht.init(n,e),n._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:n}),t)});function Nd(n,e,t){n.issues.length&&e.issues.push(...ai(t,n.issues)),e.value[t]=n.value}const qy=J("$ZodArray",(n,e)=>{ht.init(n,e),n._zod.parse=(t,r)=>{const o=t.value;if(!Array.isArray(o))return t.issues.push({expected:"array",code:"invalid_type",input:o,inst:n}),t;t.value=Array(o.length);const a=[];for(let u=0;u<o.length;u++){const h=o[u],c=e.element._zod.run({value:h,issues:[]},r);c instanceof Promise?a.push(c.then(f=>Nd(f,t,u))):Nd(c,t,u)}return a.length?Promise.all(a).then(()=>t):t}});function qs(n,e,t){n.issues.length&&e.issues.push(...ai(t,n.issues)),e.value[t]=n.value}function Rd(n,e,t,r){n.issues.length?r[t]===void 0?t in r?e.value[t]=void 0:e.value[t]=n.value:e.issues.push(...ai(t,n.issues)):n.value===void 0?t in r&&(e.value[t]=void 0):e.value[t]=n.value}const zd=J("$ZodObject",(n,e)=>{ht.init(n,e);const t=nl(()=>{const g=Object.keys(e.shape);for(const b of g)if(!(e.shape[b]instanceof ht))throw new Error(`Invalid element at key "${b}": expected a Zod schema`);const m=l_(e.shape);return{shape:e.shape,keys:g,keySet:new Set(g),numKeys:g.length,optionalKeys:new Set(m)}});gt(n._zod,"propValues",()=>{const g=e.shape,m={};for(const b in g){const _=g[b]._zod;if(_.values){m[b]??(m[b]=new Set);for(const $ of _.values)m[b].add($)}}return m});const r=g=>{const m=new hy(["shape","payload","ctx"]),{keys:b,optionalKeys:_}=t.value,$=I=>{const T=Ao(I);return`shape[${T}]._zod.run({ value: input[${T}], issues: [] }, ctx)`};m.write("const input = payload.value;");const C=Object.create(null);for(const I of b)C[I]=vd(15);m.write("const newResult = {}");for(const I of b)if(_.has(I)){const T=C[I];m.write(`const ${T} = ${$(I)};`);const A=Ao(I);m.write(`
        if (${T}.issues.length) {
          if (input[${A}] === undefined) {
            if (${A} in input) {
              newResult[${A}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${T}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${A}, ...iss.path] : [${A}],
              }))
            );
          }
        } else if (${T}.value === undefined) {
          if (${A} in input) newResult[${A}] = undefined;
        } else {
          newResult[${A}] = ${T}.value;
        }
        `)}else{const T=C[I];m.write(`const ${T} = ${$(I)};`),m.write(`
          if (${T}.issues.length) payload.issues = payload.issues.concat(${T}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${Ao(I)}, ...iss.path] : [${Ao(I)}]
          })));`),m.write(`newResult[${Ao(I)}] = ${T}.value`)}m.write("payload.value = newResult;"),m.write("return payload;");const S=m.compile();return(I,T)=>S(g,I,T)};let o;const a=Fs,u=!md.jitless,c=u&&a_.value,{catchall:f}=e;let p;n._zod.parse=(g,m)=>{p??(p=t.value);const b=g.value;if(!a(b))return g.issues.push({expected:"object",code:"invalid_type",input:b,inst:n}),g;const _=[];if(u&&c&&(m==null?void 0:m.async)===!1&&m.jitless!==!0)o||(o=r(e.shape)),g=o(g,m);else{g.value={};const T=p.shape;for(const A of p.keys){const N=T[A],D=N._zod.run({value:b[A],issues:[]},m),L=N._zod.optin==="optional"&&N._zod.optout==="optional";D instanceof Promise?_.push(D.then(q=>L?Rd(q,g,A,b):qs(q,g,A))):L?Rd(D,g,A,b):qs(D,g,A)}}if(!f)return _.length?Promise.all(_).then(()=>g):g;const $=[],C=p.keySet,S=f._zod,I=S.def.type;for(const T of Object.keys(b)){if(C.has(T))continue;if(I==="never"){$.push(T);continue}const A=S.run({value:b[T],issues:[]},m);A instanceof Promise?_.push(A.then(N=>qs(N,g,T))):qs(A,g,T)}return $.length&&g.issues.push({code:"unrecognized_keys",keys:$,input:b,inst:n}),_.length?Promise.all(_).then(()=>g):g}});function Dd(n,e,t,r){for(const o of n)if(o.issues.length===0)return e.value=o.value,e;return e.issues.push({code:"invalid_union",input:e.value,inst:t,errors:n.map(o=>o.issues.map(a=>Rr(a,r,Nr())))}),e}const Ld=J("$ZodUnion",(n,e)=>{ht.init(n,e),gt(n._zod,"values",()=>{if(e.options.every(t=>t._zod.values))return new Set(e.options.flatMap(t=>Array.from(t._zod.values)))}),gt(n._zod,"pattern",()=>{if(e.options.every(t=>t._zod.pattern)){const t=e.options.map(r=>r._zod.pattern);return new RegExp(`^(${t.map(r=>il(r.source)).join("|")})$`)}}),n._zod.parse=(t,r)=>{let o=!1;const a=[];for(const u of e.options){const h=u._zod.run({value:t.value,issues:[]},r);if(h instanceof Promise)a.push(h),o=!0;else{if(h.issues.length===0)return h;a.push(h)}}return o?Promise.all(a).then(u=>Dd(u,t,n,r)):Dd(a,t,n,r)}}),Gy=J("$ZodDiscriminatedUnion",(n,e)=>{Ld.init(n,e);const t=n._zod.parse;gt(n._zod,"propValues",()=>{const o={};for(const a of e.options){const u=a._zod.propValues;if(!u||Object.keys(u).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(a)}"`);for(const[h,c]of Object.entries(u)){o[h]||(o[h]=new Set);for(const f of c)o[h].add(f)}}return o});const r=nl(()=>{const o=e.options,a=new Map;for(const u of o){const h=u._zod.propValues[e.discriminator];if(!h||h.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(u)}"`);for(const c of h){if(a.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);a.set(c,u)}}return a});n._zod.parse=(o,a)=>{const u=o.value;if(!Fs(u))return o.issues.push({code:"invalid_type",expected:"object",input:u,inst:n}),o;const h=r.value.get(u==null?void 0:u[e.discriminator]);return h?h._zod.run(o,a):e.unionFallback?t(o,a):(o.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:u,path:[e.discriminator],inst:n}),o)}}),Hy=J("$ZodIntersection",(n,e)=>{ht.init(n,e),n._zod.parse=(t,r)=>{const{value:o}=t,a=e.left._zod.run({value:o,issues:[]},r),u=e.right._zod.run({value:o,issues:[]},r);return a instanceof Promise||u instanceof Promise?Promise.all([a,u]).then(([c,f])=>Bd(t,c,f)):Bd(t,a,u)}});function ul(n,e){if(n===e)return{valid:!0,data:n};if(n instanceof Date&&e instanceof Date&&+n==+e)return{valid:!0,data:n};if(ol(n)&&ol(e)){const t=Object.keys(e),r=Object.keys(n).filter(a=>t.indexOf(a)!==-1),o={...n,...e};for(const a of r){const u=ul(n[a],e[a]);if(!u.valid)return{valid:!1,mergeErrorPath:[a,...u.mergeErrorPath]};o[a]=u.data}return{valid:!0,data:o}}if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return{valid:!1,mergeErrorPath:[]};const t=[];for(let r=0;r<n.length;r++){const o=n[r],a=e[r],u=ul(o,a);if(!u.valid)return{valid:!1,mergeErrorPath:[r,...u.mergeErrorPath]};t.push(u.data)}return{valid:!0,data:t}}return{valid:!1,mergeErrorPath:[]}}function Bd(n,e,t){if(e.issues.length&&n.issues.push(...e.issues),t.issues.length&&n.issues.push(...t.issues),Po(n))return n;const r=ul(e.value,t.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return n.value=r.data,n}const Wy=J("$ZodRecord",(n,e)=>{ht.init(n,e),n._zod.parse=(t,r)=>{const o=t.value;if(!ol(o))return t.issues.push({expected:"record",code:"invalid_type",input:o,inst:n}),t;const a=[];if(e.keyType._zod.values){const u=e.keyType._zod.values;t.value={};for(const c of u)if(typeof c=="string"||typeof c=="number"||typeof c=="symbol"){const f=e.valueType._zod.run({value:o[c],issues:[]},r);f instanceof Promise?a.push(f.then(p=>{p.issues.length&&t.issues.push(...ai(c,p.issues)),t.value[c]=p.value})):(f.issues.length&&t.issues.push(...ai(c,f.issues)),t.value[c]=f.value)}let h;for(const c in o)u.has(c)||(h=h??[],h.push(c));h&&h.length>0&&t.issues.push({code:"unrecognized_keys",input:o,inst:n,keys:h})}else{t.value={};for(const u of Reflect.ownKeys(o)){if(u==="__proto__")continue;const h=e.keyType._zod.run({value:u,issues:[]},r);if(h instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(h.issues.length){t.issues.push({origin:"record",code:"invalid_key",issues:h.issues.map(f=>Rr(f,r,Nr())),input:u,path:[u],inst:n}),t.value[h.value]=h.value;continue}const c=e.valueType._zod.run({value:o[u],issues:[]},r);c instanceof Promise?a.push(c.then(f=>{f.issues.length&&t.issues.push(...ai(u,f.issues)),t.value[h.value]=f.value})):(c.issues.length&&t.issues.push(...ai(u,c.issues)),t.value[h.value]=c.value)}}return a.length?Promise.all(a).then(()=>t):t}}),jy=J("$ZodEnum",(n,e)=>{ht.init(n,e);const t=i_(e.entries);n._zod.values=new Set(t),n._zod.pattern=new RegExp(`^(${t.filter(r=>u_.has(typeof r)).map(r=>typeof r=="string"?Io(r):r.toString()).join("|")})$`),n._zod.parse=(r,o)=>{const a=r.value;return n._zod.values.has(a)||r.issues.push({code:"invalid_value",values:t,input:a,inst:n}),r}}),Vy=J("$ZodLiteral",(n,e)=>{ht.init(n,e),n._zod.values=new Set(e.values),n._zod.pattern=new RegExp(`^(${e.values.map(t=>typeof t=="string"?Io(t):t?t.toString():String(t)).join("|")})$`),n._zod.parse=(t,r)=>{const o=t.value;return n._zod.values.has(o)||t.issues.push({code:"invalid_value",values:e.values,input:o,inst:n}),t}}),Ky=J("$ZodTransform",(n,e)=>{ht.init(n,e),n._zod.parse=(t,r)=>{const o=e.transform(t.value,t);if(r.async)return(o instanceof Promise?o:Promise.resolve(o)).then(u=>(t.value=u,t));if(o instanceof Promise)throw new Eo;return t.value=o,t}}),Fd=J("$ZodOptional",(n,e)=>{ht.init(n,e),n._zod.optin="optional",n._zod.optout="optional",gt(n._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),gt(n._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${il(t.source)})?$`):void 0}),n._zod.parse=(t,r)=>t.value===void 0?t:e.innerType._zod.run(t,r)}),Jy=J("$ZodNullable",(n,e)=>{ht.init(n,e),gt(n._zod,"optin",()=>e.innerType._zod.optin),gt(n._zod,"optout",()=>e.innerType._zod.optout),gt(n._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${il(t.source)}|null)$`):void 0}),gt(n._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),n._zod.parse=(t,r)=>t.value===null?t:e.innerType._zod.run(t,r)}),Yy=J("$ZodDefault",(n,e)=>{ht.init(n,e),n._zod.optin="optional",gt(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>{if(t.value===void 0)return t.value=e.defaultValue,t;const o=e.innerType._zod.run(t,r);return o instanceof Promise?o.then(a=>Ud(a,e)):Ud(o,e)}});function Ud(n,e){return n.value===void 0&&(n.value=e.defaultValue),n}const Qy=J("$ZodPrefault",(n,e)=>{ht.init(n,e),n._zod.optin="optional",gt(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>(t.value===void 0&&(t.value=e.defaultValue),e.innerType._zod.run(t,r))}),Xy=J("$ZodNonOptional",(n,e)=>{ht.init(n,e),gt(n._zod,"values",()=>{const t=e.innerType._zod.values;return t?new Set([...t].filter(r=>r!==void 0)):void 0}),n._zod.parse=(t,r)=>{const o=e.innerType._zod.run(t,r);return o instanceof Promise?o.then(a=>Zd(a,n)):Zd(o,n)}});function Zd(n,e){return!n.issues.length&&n.value===void 0&&n.issues.push({code:"invalid_type",expected:"nonoptional",input:n.value,inst:e}),n}const e2=J("$ZodCatch",(n,e)=>{ht.init(n,e),gt(n._zod,"optin",()=>e.innerType._zod.optin),gt(n._zod,"optout",()=>e.innerType._zod.optout),gt(n._zod,"values",()=>e.innerType._zod.values),n._zod.parse=(t,r)=>{const o=e.innerType._zod.run(t,r);return o instanceof Promise?o.then(a=>(t.value=a.value,a.issues.length&&(t.value=e.catchValue({...t,error:{issues:a.issues.map(u=>Rr(u,r,Nr()))},input:t.value}),t.issues=[]),t)):(t.value=o.value,o.issues.length&&(t.value=e.catchValue({...t,error:{issues:o.issues.map(a=>Rr(a,r,Nr()))},input:t.value}),t.issues=[]),t)}}),t2=J("$ZodPipe",(n,e)=>{ht.init(n,e),gt(n._zod,"values",()=>e.in._zod.values),gt(n._zod,"optin",()=>e.in._zod.optin),gt(n._zod,"optout",()=>e.out._zod.optout),n._zod.parse=(t,r)=>{const o=e.in._zod.run(t,r);return o instanceof Promise?o.then(a=>qd(a,e,r)):qd(o,e,r)}});function qd(n,e,t){return Po(n)?n:e.out._zod.run({value:n.value,issues:n.issues},t)}const n2=J("$ZodReadonly",(n,e)=>{ht.init(n,e),gt(n._zod,"propValues",()=>e.innerType._zod.propValues),gt(n._zod,"optin",()=>e.innerType._zod.optin),gt(n._zod,"optout",()=>e.innerType._zod.optout),n._zod.parse=(t,r)=>{const o=e.innerType._zod.run(t,r);return o instanceof Promise?o.then(Gd):Gd(o)}});function Gd(n){return n.value=Object.freeze(n.value),n}const r2=J("$ZodCustom",(n,e)=>{un.init(n,e),ht.init(n,e),n._zod.parse=(t,r)=>t,n._zod.check=t=>{const r=t.value,o=e.fn(r);if(o instanceof Promise)return o.then(a=>Hd(a,t,r,n));Hd(o,t,r,n)}});function Hd(n,e,t,r){if(!n){const o={code:"custom",input:t,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(o.params=r._zod.def.params),e.issues.push(ko(o))}}class i2{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...t){const r=t[0];if(this._map.set(e,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}remove(e){return this._map.delete(e),this}get(e){const t=e._zod.parent;if(t){const r={...this.get(t)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}function o2(){return new i2}const Gs=o2();function s2(n,e){return new n({type:"string",...ve(e)})}function a2(n,e){return new n({type:"string",format:"email",check:"string_format",abort:!1,...ve(e)})}function Wd(n,e){return new n({type:"string",format:"guid",check:"string_format",abort:!1,...ve(e)})}function u2(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,...ve(e)})}function l2(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ve(e)})}function c2(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ve(e)})}function h2(n,e){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ve(e)})}function jd(n,e){return new n({type:"string",format:"url",check:"string_format",abort:!1,...ve(e)})}function f2(n,e){return new n({type:"string",format:"emoji",check:"string_format",abort:!1,...ve(e)})}function d2(n,e){return new n({type:"string",format:"nanoid",check:"string_format",abort:!1,...ve(e)})}function p2(n,e){return new n({type:"string",format:"cuid",check:"string_format",abort:!1,...ve(e)})}function g2(n,e){return new n({type:"string",format:"cuid2",check:"string_format",abort:!1,...ve(e)})}function m2(n,e){return new n({type:"string",format:"ulid",check:"string_format",abort:!1,...ve(e)})}function v2(n,e){return new n({type:"string",format:"xid",check:"string_format",abort:!1,...ve(e)})}function _2(n,e){return new n({type:"string",format:"ksuid",check:"string_format",abort:!1,...ve(e)})}function y2(n,e){return new n({type:"string",format:"ipv4",check:"string_format",abort:!1,...ve(e)})}function b2(n,e){return new n({type:"string",format:"ipv6",check:"string_format",abort:!1,...ve(e)})}function w2(n,e){return new n({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ve(e)})}function x2(n,e){return new n({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ve(e)})}function T2(n,e){return new n({type:"string",format:"base64",check:"string_format",abort:!1,...ve(e)})}function S2(n,e){return new n({type:"string",format:"base64url",check:"string_format",abort:!1,...ve(e)})}function M2(n,e){return new n({type:"string",format:"e164",check:"string_format",abort:!1,...ve(e)})}function E2(n,e){return new n({type:"string",format:"jwt",check:"string_format",abort:!1,...ve(e)})}function C2(n,e){return new n({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ve(e)})}function A2(n,e){return new n({type:"string",format:"date",check:"string_format",...ve(e)})}function I2(n,e){return new n({type:"string",format:"time",check:"string_format",precision:null,...ve(e)})}function P2(n,e){return new n({type:"string",format:"duration",check:"string_format",...ve(e)})}function k2(n,e){return new n({type:"number",checks:[],...ve(e)})}function $2(n,e){return new n({type:"number",check:"number_format",abort:!1,format:"safeint",...ve(e)})}function O2(n,e){return new n({type:"boolean",...ve(e)})}function N2(n,e){return new n({type:"null",...ve(e)})}function R2(n){return new n({type:"unknown"})}function z2(n,e){return new n({type:"never",...ve(e)})}function Vd(n,e){return new Pd({check:"less_than",...ve(e),value:n,inclusive:!1})}function ll(n,e){return new Pd({check:"less_than",...ve(e),value:n,inclusive:!0})}function Kd(n,e){return new kd({check:"greater_than",...ve(e),value:n,inclusive:!1})}function cl(n,e){return new kd({check:"greater_than",...ve(e),value:n,inclusive:!0})}function Jd(n,e){return new X_({check:"multiple_of",...ve(e),value:n})}function Yd(n,e){return new ty({check:"max_length",...ve(e),maximum:n})}function Hs(n,e){return new ny({check:"min_length",...ve(e),minimum:n})}function Qd(n,e){return new ry({check:"length_equals",...ve(e),length:n})}function D2(n,e){return new iy({check:"string_format",format:"regex",...ve(e),pattern:n})}function L2(n){return new oy({check:"string_format",format:"lowercase",...ve(n)})}function B2(n){return new sy({check:"string_format",format:"uppercase",...ve(n)})}function F2(n,e){return new ay({check:"string_format",format:"includes",...ve(e),includes:n})}function U2(n,e){return new uy({check:"string_format",format:"starts_with",...ve(e),prefix:n})}function Z2(n,e){return new ly({check:"string_format",format:"ends_with",...ve(e),suffix:n})}function $o(n){return new cy({check:"overwrite",tx:n})}function q2(n){return $o(e=>e.normalize(n))}function G2(){return $o(n=>n.trim())}function H2(){return $o(n=>n.toLowerCase())}function W2(){return $o(n=>n.toUpperCase())}function j2(n,e,t){return new n({type:"array",element:e,...ve(t)})}function V2(n,e,t){const r=ve(t);return r.abort??(r.abort=!0),new n({type:"custom",check:"custom",fn:e,...r})}function K2(n,e,t){return new n({type:"custom",check:"custom",fn:e,...ve(t)})}const J2=J("ZodISODateTime",(n,e)=>{Sy.init(n,e),bt.init(n,e)});function hl(n){return C2(J2,n)}const Y2=J("ZodISODate",(n,e)=>{My.init(n,e),bt.init(n,e)});function Q2(n){return A2(Y2,n)}const X2=J("ZodISOTime",(n,e)=>{Ey.init(n,e),bt.init(n,e)});function eb(n){return I2(X2,n)}const tb=J("ZodISODuration",(n,e)=>{Cy.init(n,e),bt.init(n,e)});function nb(n){return P2(tb,n)}const Ws=J("ZodError",(n,e)=>{bd.init(n,e),n.name="ZodError",Object.defineProperties(n,{format:{value:t=>__(n,t)},flatten:{value:t=>v_(n,t)},addIssue:{value:t=>n.issues.push(t)},addIssues:{value:t=>n.issues.push(...t)},isEmpty:{get(){return n.issues.length===0}}})},{Parent:Error}),rb=w_(Ws),ib=x_(Ws),ob=xd(Ws),sb=Td(Ws),yt=J("ZodType",(n,e)=>(ht.init(n,e),n.def=e,Object.defineProperty(n,"_def",{value:e}),n.check=(...t)=>n.clone({...e,checks:[...e.checks??[],...t.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),n.clone=(t,r)=>si(n,t,r),n.brand=()=>n,n.register=(t,r)=>(t.add(n,r),n),n.parse=(t,r)=>rb(n,t,r,{callee:n.parse}),n.safeParse=(t,r)=>ob(n,t,r),n.parseAsync=async(t,r)=>ib(n,t,r,{callee:n.parseAsync}),n.safeParseAsync=async(t,r)=>sb(n,t,r),n.spa=n.safeParseAsync,n.refine=(t,r)=>n.check(Yb(t,r)),n.superRefine=t=>n.check(Qb(t)),n.overwrite=t=>n.check($o(t)),n.optional=()=>Vs(n),n.nullable=()=>up(n),n.nullish=()=>Vs(up(n)),n.nonoptional=t=>Gb(n,t),n.array=()=>it(n),n.or=t=>kb([n,t]),n.and=t=>Nb(n,t),n.transform=t=>cp(n,Lb(t)),n.default=t=>Ub(n,t),n.prefault=t=>qb(n,t),n.catch=t=>Wb(n,t),n.pipe=t=>cp(n,t),n.readonly=()=>Kb(n),n.describe=t=>{const r=n.clone();return Gs.add(r,{description:t}),r},Object.defineProperty(n,"description",{get(){var t;return(t=Gs.get(n))==null?void 0:t.description},configurable:!0}),n.meta=(...t)=>{if(t.length===0)return Gs.get(n);const r=n.clone();return Gs.add(r,t[0]),r},n.isOptional=()=>n.safeParse(void 0).success,n.isNullable=()=>n.safeParse(null).success,n)),Xd=J("_ZodString",(n,e)=>{al.init(n,e),yt.init(n,e);const t=n._zod.bag;n.format=t.format??null,n.minLength=t.minimum??null,n.maxLength=t.maximum??null,n.regex=(...r)=>n.check(D2(...r)),n.includes=(...r)=>n.check(F2(...r)),n.startsWith=(...r)=>n.check(U2(...r)),n.endsWith=(...r)=>n.check(Z2(...r)),n.min=(...r)=>n.check(Hs(...r)),n.max=(...r)=>n.check(Yd(...r)),n.length=(...r)=>n.check(Qd(...r)),n.nonempty=(...r)=>n.check(Hs(1,...r)),n.lowercase=r=>n.check(L2(r)),n.uppercase=r=>n.check(B2(r)),n.trim=()=>n.check(G2()),n.normalize=(...r)=>n.check(q2(...r)),n.toLowerCase=()=>n.check(H2()),n.toUpperCase=()=>n.check(W2())}),ab=J("ZodString",(n,e)=>{al.init(n,e),Xd.init(n,e),n.email=t=>n.check(a2(ub,t)),n.url=t=>n.check(jd(tp,t)),n.jwt=t=>n.check(E2(Tb,t)),n.emoji=t=>n.check(f2(lb,t)),n.guid=t=>n.check(Wd(ep,t)),n.uuid=t=>n.check(u2(js,t)),n.uuidv4=t=>n.check(l2(js,t)),n.uuidv6=t=>n.check(c2(js,t)),n.uuidv7=t=>n.check(h2(js,t)),n.nanoid=t=>n.check(d2(cb,t)),n.guid=t=>n.check(Wd(ep,t)),n.cuid=t=>n.check(p2(hb,t)),n.cuid2=t=>n.check(g2(fb,t)),n.ulid=t=>n.check(m2(db,t)),n.base64=t=>n.check(T2(bb,t)),n.base64url=t=>n.check(S2(wb,t)),n.xid=t=>n.check(v2(pb,t)),n.ksuid=t=>n.check(_2(gb,t)),n.ipv4=t=>n.check(y2(mb,t)),n.ipv6=t=>n.check(b2(vb,t)),n.cidrv4=t=>n.check(w2(_b,t)),n.cidrv6=t=>n.check(x2(yb,t)),n.e164=t=>n.check(M2(xb,t)),n.datetime=t=>n.check(hl(t)),n.date=t=>n.check(Q2(t)),n.time=t=>n.check(eb(t)),n.duration=t=>n.check(nb(t))});function Ge(n){return s2(ab,n)}const bt=J("ZodStringFormat",(n,e)=>{mt.init(n,e),Xd.init(n,e)}),ub=J("ZodEmail",(n,e)=>{gy.init(n,e),bt.init(n,e)}),ep=J("ZodGUID",(n,e)=>{dy.init(n,e),bt.init(n,e)}),js=J("ZodUUID",(n,e)=>{py.init(n,e),bt.init(n,e)}),tp=J("ZodURL",(n,e)=>{my.init(n,e),bt.init(n,e)});function np(n){return jd(tp,n)}const lb=J("ZodEmoji",(n,e)=>{vy.init(n,e),bt.init(n,e)}),cb=J("ZodNanoID",(n,e)=>{_y.init(n,e),bt.init(n,e)}),hb=J("ZodCUID",(n,e)=>{yy.init(n,e),bt.init(n,e)}),fb=J("ZodCUID2",(n,e)=>{by.init(n,e),bt.init(n,e)}),db=J("ZodULID",(n,e)=>{wy.init(n,e),bt.init(n,e)}),pb=J("ZodXID",(n,e)=>{xy.init(n,e),bt.init(n,e)}),gb=J("ZodKSUID",(n,e)=>{Ty.init(n,e),bt.init(n,e)}),mb=J("ZodIPv4",(n,e)=>{Ay.init(n,e),bt.init(n,e)}),vb=J("ZodIPv6",(n,e)=>{Iy.init(n,e),bt.init(n,e)}),_b=J("ZodCIDRv4",(n,e)=>{Py.init(n,e),bt.init(n,e)}),yb=J("ZodCIDRv6",(n,e)=>{ky.init(n,e),bt.init(n,e)}),bb=J("ZodBase64",(n,e)=>{$y.init(n,e),bt.init(n,e)}),wb=J("ZodBase64URL",(n,e)=>{Ny.init(n,e),bt.init(n,e)}),xb=J("ZodE164",(n,e)=>{Ry.init(n,e),bt.init(n,e)}),Tb=J("ZodJWT",(n,e)=>{Dy.init(n,e),bt.init(n,e)}),rp=J("ZodNumber",(n,e)=>{Od.init(n,e),yt.init(n,e),n.gt=(r,o)=>n.check(Kd(r,o)),n.gte=(r,o)=>n.check(cl(r,o)),n.min=(r,o)=>n.check(cl(r,o)),n.lt=(r,o)=>n.check(Vd(r,o)),n.lte=(r,o)=>n.check(ll(r,o)),n.max=(r,o)=>n.check(ll(r,o)),n.int=r=>n.check(ip(r)),n.safe=r=>n.check(ip(r)),n.positive=r=>n.check(Kd(0,r)),n.nonnegative=r=>n.check(cl(0,r)),n.negative=r=>n.check(Vd(0,r)),n.nonpositive=r=>n.check(ll(0,r)),n.multipleOf=(r,o)=>n.check(Jd(r,o)),n.step=(r,o)=>n.check(Jd(r,o)),n.finite=()=>n;const t=n._zod.bag;n.minValue=Math.max(t.minimum??Number.NEGATIVE_INFINITY,t.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,n.maxValue=Math.min(t.maximum??Number.POSITIVE_INFINITY,t.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,n.isInt=(t.format??"").includes("int")||Number.isSafeInteger(t.multipleOf??.5),n.isFinite=!0,n.format=t.format??null});function K(n){return k2(rp,n)}const Sb=J("ZodNumberFormat",(n,e)=>{Ly.init(n,e),rp.init(n,e)});function ip(n){return $2(Sb,n)}const Mb=J("ZodBoolean",(n,e)=>{By.init(n,e),yt.init(n,e)});function wt(n){return O2(Mb,n)}const Eb=J("ZodNull",(n,e)=>{Fy.init(n,e),yt.init(n,e)});function Ye(n){return N2(Eb,n)}const Cb=J("ZodUnknown",(n,e)=>{Uy.init(n,e),yt.init(n,e)});function fl(){return R2(Cb)}const Ab=J("ZodNever",(n,e)=>{Zy.init(n,e),yt.init(n,e)});function op(n){return z2(Ab,n)}const Ib=J("ZodArray",(n,e)=>{qy.init(n,e),yt.init(n,e),n.element=e.element,n.min=(t,r)=>n.check(Hs(t,r)),n.nonempty=t=>n.check(Hs(1,t)),n.max=(t,r)=>n.check(Yd(t,r)),n.length=(t,r)=>n.check(Qd(t,r)),n.unwrap=()=>n.element});function it(n,e){return j2(Ib,n,e)}const dl=J("ZodObject",(n,e)=>{zd.init(n,e),yt.init(n,e),gt(n,"shape",()=>e.shape),n.keyof=()=>Rt(Object.keys(n._zod.def.shape)),n.catchall=t=>n.clone({...n._zod.def,catchall:t}),n.passthrough=()=>n.clone({...n._zod.def,catchall:fl()}),n.loose=()=>n.clone({...n._zod.def,catchall:fl()}),n.strict=()=>n.clone({...n._zod.def,catchall:op()}),n.strip=()=>n.clone({...n._zod.def,catchall:void 0}),n.extend=t=>d_(n,t),n.merge=t=>p_(n,t),n.pick=t=>h_(n,t),n.omit=t=>f_(n,t),n.partial=(...t)=>g_(ap,n,t[0]),n.required=(...t)=>m_(lp,n,t[0])});function ui(n,e){const t={type:"object",get shape(){return Co(this,"shape",{...n}),this.shape},...ve(e)};return new dl(t)}function ke(n,e){return new dl({type:"object",get shape(){return Co(this,"shape",{...n}),this.shape},catchall:op(),...ve(e)})}function Pb(n,e){return new dl({type:"object",get shape(){return Co(this,"shape",{...n}),this.shape},catchall:fl(),...ve(e)})}const sp=J("ZodUnion",(n,e)=>{Ld.init(n,e),yt.init(n,e),n.options=e.options});function kb(n,e){return new sp({type:"union",options:n,...ve(e)})}const $b=J("ZodDiscriminatedUnion",(n,e)=>{sp.init(n,e),Gy.init(n,e)});function pl(n,e,t){return new $b({type:"union",options:e,discriminator:n,...ve(t)})}const Ob=J("ZodIntersection",(n,e)=>{Hy.init(n,e),yt.init(n,e)});function Nb(n,e){return new Ob({type:"intersection",left:n,right:e})}const Rb=J("ZodRecord",(n,e)=>{Wy.init(n,e),yt.init(n,e),n.keyType=e.keyType,n.valueType=e.valueType});function cr(n,e,t){return new Rb({type:"record",keyType:n,valueType:e,...ve(t)})}const gl=J("ZodEnum",(n,e)=>{jy.init(n,e),yt.init(n,e),n.enum=e.entries,n.options=Object.values(e.entries);const t=new Set(Object.keys(e.entries));n.extract=(r,o)=>{const a={};for(const u of r)if(t.has(u))a[u]=e.entries[u];else throw new Error(`Key ${u} not found in enum`);return new gl({...e,checks:[],...ve(o),entries:a})},n.exclude=(r,o)=>{const a={...e.entries};for(const u of r)if(t.has(u))delete a[u];else throw new Error(`Key ${u} not found in enum`);return new gl({...e,checks:[],...ve(o),entries:a})}});function Rt(n,e){const t=Array.isArray(n)?Object.fromEntries(n.map(r=>[r,r])):n;return new gl({type:"enum",entries:t,...ve(e)})}const zb=J("ZodLiteral",(n,e)=>{Vy.init(n,e),yt.init(n,e),n.values=new Set(e.values),Object.defineProperty(n,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function li(n,e){return new zb({type:"literal",values:Array.isArray(n)?n:[n],...ve(e)})}const Db=J("ZodTransform",(n,e)=>{Ky.init(n,e),yt.init(n,e),n._zod.parse=(t,r)=>{t.addIssue=a=>{if(typeof a=="string")t.issues.push(ko(a,t.value,e));else{const u=a;u.fatal&&(u.continue=!1),u.code??(u.code="custom"),u.input??(u.input=t.value),u.inst??(u.inst=n),u.continue??(u.continue=!0),t.issues.push(ko(u))}};const o=e.transform(t.value,t);return o instanceof Promise?o.then(a=>(t.value=a,t)):(t.value=o,t)}});function Lb(n){return new Db({type:"transform",transform:n})}const ap=J("ZodOptional",(n,e)=>{Fd.init(n,e),yt.init(n,e),n.unwrap=()=>n._zod.def.innerType});function Vs(n){return new ap({type:"optional",innerType:n})}const Bb=J("ZodNullable",(n,e)=>{Jy.init(n,e),yt.init(n,e),n.unwrap=()=>n._zod.def.innerType});function up(n){return new Bb({type:"nullable",innerType:n})}const Fb=J("ZodDefault",(n,e)=>{Yy.init(n,e),yt.init(n,e),n.unwrap=()=>n._zod.def.innerType,n.removeDefault=n.unwrap});function Ub(n,e){return new Fb({type:"default",innerType:n,get defaultValue(){return typeof e=="function"?e():e}})}const Zb=J("ZodPrefault",(n,e)=>{Qy.init(n,e),yt.init(n,e),n.unwrap=()=>n._zod.def.innerType});function qb(n,e){return new Zb({type:"prefault",innerType:n,get defaultValue(){return typeof e=="function"?e():e}})}const lp=J("ZodNonOptional",(n,e)=>{Xy.init(n,e),yt.init(n,e),n.unwrap=()=>n._zod.def.innerType});function Gb(n,e){return new lp({type:"nonoptional",innerType:n,...ve(e)})}const Hb=J("ZodCatch",(n,e)=>{e2.init(n,e),yt.init(n,e),n.unwrap=()=>n._zod.def.innerType,n.removeCatch=n.unwrap});function Wb(n,e){return new Hb({type:"catch",innerType:n,catchValue:typeof e=="function"?e:()=>e})}const jb=J("ZodPipe",(n,e)=>{t2.init(n,e),yt.init(n,e),n.in=e.in,n.out=e.out});function cp(n,e){return new jb({type:"pipe",in:n,out:e})}const Vb=J("ZodReadonly",(n,e)=>{n2.init(n,e),yt.init(n,e)});function Kb(n){return new Vb({type:"readonly",innerType:n})}const ml=J("ZodCustom",(n,e)=>{r2.init(n,e),yt.init(n,e)});function Jb(n,e){const t=new un({check:"custom",...ve(e)});return t._zod.check=n,t}function hp(n,e){return V2(ml,()=>!0,e)}function Yb(n,e={}){return K2(ml,n,e)}function Qb(n,e){const t=Jb(r=>(r.addIssue=o=>{if(typeof o=="string")r.issues.push(ko(o,r.value,t._zod.def));else{const a=o;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),r.issues.push(ko(a))}},n(r.value,r)),e);return t}function fp(n,e={error:`Input not instance of ${n.name}`}){const t=new ml({type:"custom",check:"custom",fn:r=>r instanceof n,abort:!0,...ve(e)});return t._zod.bag.Class=n,t}function Xb(n){let t=new st(n).to("srgb").toString({format:"hex"}).toUpperCase();return t.length===4&&(t=`#${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`),t}const zt=Ge().transform(Xb),vl=pl("colorType",[ke({colorType:li("solid"),value:zt,opacity:K().min(0).max(1).optional()}),ke({colorType:li("gradient"),direction:K().min(0).max(360),colors:it(zt),opacity:K().min(0).max(1).optional()}),ke({colorType:li("radial-gradient"),colors:it(zt),opacity:K().min(0).max(1).optional()})]);Rt(["plain","markdown","html"]);const ew=Rt(["top","top-right","top-left","left","center","right","bottom","bottom-left","bottom-right","automatic"]),tw=np({protocol:/^https?$/,hostname:U_}),nw=Ge().startsWith("data:image/png;base64,"),rw=tw.or(nw),iw=ke({x:K(),y:K(),z:K()}),ow=Rt(["top","top-left","top-right","left","center","right","bottom","bottom-left","bottom-right"]),sw=Rt(["left","center","right"]),aw=Rt(["pulse","bounce","shake","glow","fill"]),uw=Rt(["notification","label","label-success","label-warning","label-danger","count","icon","progress","dot"]),lw=Rt(["linear","radial"]),cw=Rt(["vertical","horizontal","diagonal"]),hw=Rt(["round","bevel","miter"]),fw=ke({width:K(),color:zt,spacing:K()}),Oo=ke({enabled:wt().default(!1).optional(),textPath:Ge().optional(),location:ew.default("top").optional(),text:Ge().optional(),font:Ge().default("Verdana").optional(),fontSize:K().default(48).optional(),fontWeight:Ge().default("normal").optional(),lineHeight:K().default(1.2).optional(),textColor:zt.default("#000000").optional(),backgroundColor:vl.or(zt).optional(),borderWidth:K().default(0).optional(),borderColor:zt.default("#000000").optional(),borders:it(fw).optional(),marginTop:K().default(5).optional(),marginBottom:K().default(5).optional(),marginLeft:K().default(5).optional(),marginRight:K().default(5).optional(),textAlign:sw.default("center").optional(),cornerRadius:K().default(0).optional(),autoSize:wt().default(!0).optional(),resolution:K().default(128).optional(),billboardMode:K().default(7).optional(),position:iw.optional(),attachPosition:ow.optional(),attachOffset:K().default(0).optional(),depthFadeEnabled:wt().default(!1).optional(),depthFadeNear:K().default(10).optional(),depthFadeFar:K().default(50).optional(),textOutline:wt().default(!1).optional(),textOutlineWidth:K().default(2).optional(),textOutlineColor:zt.default("#000000").optional(),textOutlineJoin:hw.default("round").optional(),textShadow:wt().default(!1).optional(),textShadowColor:zt.default("#000000").optional(),textShadowBlur:K().default(4).optional(),textShadowOffsetX:K().default(2).optional(),textShadowOffsetY:K().default(2).optional(),backgroundPadding:K().default(0).optional(),backgroundGradient:wt().default(!1).optional(),backgroundGradientType:lw.default("linear").optional(),backgroundGradientColors:it(zt).optional(),backgroundGradientDirection:cw.default("vertical").optional(),pointer:wt().default(!1).optional(),pointerDirection:Rt(["top","bottom","left","right","auto"]).default("auto").optional(),pointerWidth:K().default(20).optional(),pointerHeight:K().default(10).optional(),pointerOffset:K().default(0).optional(),pointerCurve:wt().default(!1).optional(),animation:aw.nullable().default(null).optional(),animationSpeed:K().default(1).optional(),badge:uw.optional(),icon:Ge().optional(),iconPosition:Rt(["left","right"]).default("left").optional(),progress:K().min(0).max(1).optional(),smartOverflow:wt().default(!1).optional(),maxNumber:K().default(999).optional(),overflowSuffix:Ge().default("+").optional(),size:K().optional(),color:zt.optional(),background:vl.or(zt).optional(),backgroundCornerRadius:K().optional(),margin:K().optional(),style:Ge().optional()});function dw(n){const e={...n};return e.size!==void 0&&e.fontSize===void 0&&(e.fontSize=e.size,delete e.size),e.color!==void 0&&e.textColor===void 0&&(e.textColor=e.color,delete e.color),e.background!==void 0&&e.backgroundColor===void 0&&(e.backgroundColor=e.background,delete e.background),e.backgroundCornerRadius!==void 0&&e.cornerRadius===void 0&&(e.cornerRadius=e.backgroundCornerRadius,delete e.backgroundCornerRadius),e.margin!==void 0&&(e.marginTop??(e.marginTop=e.margin),e.marginBottom??(e.marginBottom=e.margin),e.marginLeft??(e.marginLeft=e.margin),e.marginRight??(e.marginRight=e.margin),delete e.margin),e.style!==void 0&&e.fontWeight===void 0&&(e.style.includes("bold")?e.fontWeight="bold":e.style.includes("normal")?e.fontWeight="normal":e.fontWeight=e.style,delete e.style),e}const pw=Rt(["normal","inverted","dot","open-dot","none","tee","empty","diamond","open-diamond","crow","box","open","half-open","vee"]),dp=ke({type:pw.default("normal"),size:K().positive().default(1),color:zt.default("white"),opacity:K().min(0).max(1).default(1),text:Oo.prefault({location:"top"})}),gw=Rt(["solid","dash","dash-dot","dots","equal-dash","sinewave","zigzag"]),mw=ke({type:gw.optional(),animationSpeed:K().min(0).optional(),width:K().positive().optional(),color:zt.optional(),opacity:K().min(0).max(1).optional(),bezier:wt().optional()}),_l=ke({arrowHead:dp.optional(),arrowTail:dp.optional(),line:mw.optional(),label:Oo.prefault({location:"top"}).optional(),tooltip:Oo.prefault({location:"bottom"}).optional(),enabled:wt().default(!0)}),vw={line:{type:"solid",animationSpeed:.1,width:.25,color:"darkgrey"},enabled:!0},_w=Rt(["box","sphere","cylinder","cone","capsule","torus-knot","tetrahedron","octahedron","dodecahedron","icosahedron","rhombicuboctahedron","triangular_prism","pentagonal_prism","hexagonal_prism","square_pyramid","pentagonal_pyramid","triangular_dipyramid","pentagonal_dipyramid","elongated_square_dypyramid","elongated_pentagonal_dipyramid","elongated_pentagonal_cupola","goldberg","icosphere","geodesic"]),Ks=ke({shape:ke({size:K().positive().optional(),type:_w.optional()}).optional(),texture:ke({color:vl.or(zt).optional(),image:np().optional(),icon:Ge().optional()}).optional(),effect:ke({glow:ke({color:zt.optional(),strength:K().positive().optional()}).optional(),outline:ke({color:zt.optional(),width:K().positive().optional()}).optional(),wireframe:wt().optional(),flatShaded:wt().optional()}).optional(),label:Oo.prefault({location:"top",textColor:"#000000"}).optional(),tooltip:Oo.prefault({location:"top-right",textColor:"#000000",backgroundColor:"#FFFFFF"}).optional(),enabled:wt().default(!0)}),yw={shape:{type:"icosphere",size:1},texture:{color:"grey"},enabled:!0},bw=ui({nodeIdPath:Ge().default("id"),nodeWeightPath:Ge().or(Ye()).default(null),nodeTimePath:Ge().or(Ye()).default(null),edgeSrcIdPath:Ge().default("src"),edgeDstIdPath:Ge().default("dst"),edgeWeightPath:Ge().or(Ye()).default(null),edgeTimePath:Ge().or(Ye()).default(null)}),ww=ke({algorithms:it(Ge()).optional(),knownFields:bw.prefault({})}),xw=ke({pinOnDrag:wt().default(!0)}).prefault({}),Tw=ke({type:Ge().default("ngraph"),preSteps:K().default(0),stepMultiplier:K().default(1),minDelta:K().default(0)}),Sw=ke({layout:Tw.prefault({}),node:xw,fetchNodes:Vs(fp(Function)),fetchEdges:Vs(fp(Function))}),yl=Ge().or(K());ui({id:yl,metadata:ui()}),ui({src:yl,dst:yl,metadata:ui()});const Mw=ke({backgroundType:li("color"),color:zt}),Ew=ke({backgroundType:li("skybox"),data:rw}),Cw=pl("backgroundType",[Mw,Ew]),Aw=ke({motionBlur:K().optional(),depthOfField:K().optional(),screenSpaceReflections:wt().optional()}),Iw=ke({addDefaultStyle:wt().default(!0),background:Cw.prefault({backgroundType:"color",color:"whitesmoke"}),effects:Aw.optional(),startingCameraDistance:K().default(30),layout:Ge().default("ngraph"),layoutOptions:ui().optional(),twoD:wt().default(!1)}),Pw=Ge().regex(/^data\.|algorithmResults\./),kw=Ge().startsWith("style."),pp=ke({inputs:it(Pw),output:kw,expr:Ge()}),$w=ke({selector:Ge(),style:Ks,calculatedStyle:pp.optional()}),Ow=ke({selector:Ge(),style:_l,calculatedStyle:pp.optional()}),Nw=ke({node:$w,edge:Ow}).partial().refine(n=>!!n.node||!!n.edge,"StyleLayer requires either 'node' or 'edge'."),Rw=ke({templateName:Ge().optional(),templateCreator:Ge().optional(),templateCreationTimestamp:hl().optional(),templateModificationTimestamp:hl().optional()}),zw=ke({graphtyTemplate:li(!0),majorVersion:li("1"),metadata:Rw.optional(),graph:Iw.prefault({}),layers:it(Nw).prefault([]),data:ww.prefault({}),behavior:Sw.prefault({})}),gp=pl("majorVersion",[zw]),mp=new Map;class Js{constructor(){this.edgeSchema=null,this.nodeSchema=null}async*getData(){for await(const e of this.sourceFetchData()){if(this.nodeSchema)for(const t of e.nodes)await this.dataValidator(this.nodeSchema,t);if(this.edgeSchema)for(const t of e.edges)await this.dataValidator(this.edgeSchema,t);yield e}}async dataValidator(e,t){const r=await Sd(e,t);if(!r.success){const o=b_(r.error);throw new TypeError(`Error while validating data in '${this.type}' data source:
${o}`)}}get type(){return this.constructor.type}static register(e){const t=e.type;return mp.set(t,e),e}static get(e,t={}){const r=mp.get(e);return r?new r(t):null}}var Ys=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function No(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var bl={},vp;function Dw(){return vp||(vp=1,function(n){(function(e){function t(x){return x!==null?Object.prototype.toString.call(x)==="[object Array]":!1}function r(x){return x!==null?Object.prototype.toString.call(x)==="[object Object]":!1}function o(x,k){if(x===k)return!0;var z=Object.prototype.toString.call(x);if(z!==Object.prototype.toString.call(k))return!1;if(t(x)===!0){if(x.length!==k.length)return!1;for(var H=0;H<x.length;H++)if(o(x[H],k[H])===!1)return!1;return!0}if(r(x)===!0){var X={};for(var ce in x)if(hasOwnProperty.call(x,ce)){if(o(x[ce],k[ce])===!1)return!1;X[ce]=!0}for(var Pe in k)if(hasOwnProperty.call(k,Pe)&&X[Pe]!==!0)return!1;return!0}return!1}function a(x){if(x===""||x===!1||x===null)return!0;if(t(x)&&x.length===0)return!0;if(r(x)){for(var k in x)if(x.hasOwnProperty(k))return!1;return!0}else return!1}function u(x){for(var k=Object.keys(x),z=[],H=0;H<k.length;H++)z.push(x[k[H]]);return z}var h;typeof String.prototype.trimLeft=="function"?h=function(x){return x.trimLeft()}:h=function(x){return x.match(/^\s*(.*)/)[1]};var c=0,f=1,p=2,g=3,m=4,b=5,_=6,$=7,C=8,S=9,I={0:"number",1:"any",2:"string",3:"array",4:"object",5:"boolean",6:"expression",7:"null",8:"Array<number>",9:"Array<string>"},T="EOF",A="UnquotedIdentifier",N="QuotedIdentifier",D="Rbracket",L="Rparen",q="Comma",se="Colon",we="Rbrace",me="Number",ge="Current",Xe="Expref",Ue="Pipe",ut="Or",Ve="And",ne="EQ",ae="GT",ie="LT",he="GTE",_e="LTE",Te="NE",Le="Flatten",Qe="Star",ue="Filter",te="Dot",U="Not",j="Lbrace",Y="Lbracket",fe="Lparen",xe="Literal",He={".":te,"*":Qe,",":q,":":se,"{":j,"}":we,"]":D,"(":fe,")":L,"@":ge},Tt={"<":!0,">":!0,"=":!0,"!":!0},ze={" ":!0,"	":!0,"\n":!0};function ot(x){return x>="a"&&x<="z"||x>="A"&&x<="Z"||x==="_"}function Lt(x){return x>="0"&&x<="9"||x==="-"}function St(x){return x>="a"&&x<="z"||x>="A"&&x<="Z"||x>="0"&&x<="9"||x==="_"}function Ln(){}Ln.prototype={tokenize:function(x){var k=[];this._current=0;for(var z,H,X;this._current<x.length;)if(ot(x[this._current]))z=this._current,H=this._consumeUnquotedIdentifier(x),k.push({type:A,value:H,start:z});else if(He[x[this._current]]!==void 0)k.push({type:He[x[this._current]],value:x[this._current],start:this._current}),this._current++;else if(Lt(x[this._current]))X=this._consumeNumber(x),k.push(X);else if(x[this._current]==="[")X=this._consumeLBracket(x),k.push(X);else if(x[this._current]==='"')z=this._current,H=this._consumeQuotedIdentifier(x),k.push({type:N,value:H,start:z});else if(x[this._current]==="'")z=this._current,H=this._consumeRawStringLiteral(x),k.push({type:xe,value:H,start:z});else if(x[this._current]==="`"){z=this._current;var ce=this._consumeLiteral(x);k.push({type:xe,value:ce,start:z})}else if(Tt[x[this._current]]!==void 0)k.push(this._consumeOperator(x));else if(ze[x[this._current]]!==void 0)this._current++;else if(x[this._current]==="&")z=this._current,this._current++,x[this._current]==="&"?(this._current++,k.push({type:Ve,value:"&&",start:z})):k.push({type:Xe,value:"&",start:z});else if(x[this._current]==="|")z=this._current,this._current++,x[this._current]==="|"?(this._current++,k.push({type:ut,value:"||",start:z})):k.push({type:Ue,value:"|",start:z});else{var Pe=new Error("Unknown character:"+x[this._current]);throw Pe.name="LexerError",Pe}return k},_consumeUnquotedIdentifier:function(x){var k=this._current;for(this._current++;this._current<x.length&&St(x[this._current]);)this._current++;return x.slice(k,this._current)},_consumeQuotedIdentifier:function(x){var k=this._current;this._current++;for(var z=x.length;x[this._current]!=='"'&&this._current<z;){var H=this._current;x[H]==="\\"&&(x[H+1]==="\\"||x[H+1]==='"')?H+=2:H++,this._current=H}return this._current++,JSON.parse(x.slice(k,this._current))},_consumeRawStringLiteral:function(x){var k=this._current;this._current++;for(var z=x.length;x[this._current]!=="'"&&this._current<z;){var H=this._current;x[H]==="\\"&&(x[H+1]==="\\"||x[H+1]==="'")?H+=2:H++,this._current=H}this._current++;var X=x.slice(k+1,this._current-1);return X.replace("\\'","'")},_consumeNumber:function(x){var k=this._current;this._current++;for(var z=x.length;Lt(x[this._current])&&this._current<z;)this._current++;var H=parseInt(x.slice(k,this._current));return{type:me,value:H,start:k}},_consumeLBracket:function(x){var k=this._current;return this._current++,x[this._current]==="?"?(this._current++,{type:ue,value:"[?",start:k}):x[this._current]==="]"?(this._current++,{type:Le,value:"[]",start:k}):{type:Y,value:"[",start:k}},_consumeOperator:function(x){var k=this._current,z=x[k];if(this._current++,z==="!")return x[this._current]==="="?(this._current++,{type:Te,value:"!=",start:k}):{type:U,value:"!",start:k};if(z==="<")return x[this._current]==="="?(this._current++,{type:_e,value:"<=",start:k}):{type:ie,value:"<",start:k};if(z===">")return x[this._current]==="="?(this._current++,{type:he,value:">=",start:k}):{type:ae,value:">",start:k};if(z==="="&&x[this._current]==="=")return this._current++,{type:ne,value:"==",start:k}},_consumeLiteral:function(x){this._current++;for(var k=this._current,z=x.length,H;x[this._current]!=="`"&&this._current<z;){var X=this._current;x[X]==="\\"&&(x[X+1]==="\\"||x[X+1]==="`")?X+=2:X++,this._current=X}var ce=h(x.slice(k,this._current));return ce=ce.replace("\\`","`"),this._looksLikeJSON(ce)?H=JSON.parse(ce):H=JSON.parse('"'+ce+'"'),this._current++,H},_looksLikeJSON:function(x){var k='[{"',z=["true","false","null"],H="-0123456789";if(x==="")return!1;if(k.indexOf(x[0])>=0)return!0;if(z.indexOf(x)>=0)return!0;if(H.indexOf(x[0])>=0)try{return JSON.parse(x),!0}catch{return!1}else return!1}};var Ee={};Ee[T]=0,Ee[A]=0,Ee[N]=0,Ee[D]=0,Ee[L]=0,Ee[q]=0,Ee[we]=0,Ee[me]=0,Ee[ge]=0,Ee[Xe]=0,Ee[Ue]=1,Ee[ut]=2,Ee[Ve]=3,Ee[ne]=5,Ee[ae]=5,Ee[ie]=5,Ee[he]=5,Ee[_e]=5,Ee[Te]=5,Ee[Le]=9,Ee[Qe]=20,Ee[ue]=21,Ee[te]=40,Ee[U]=45,Ee[j]=50,Ee[Y]=55,Ee[fe]=60;function qt(){}qt.prototype={parse:function(x){this._loadTokens(x),this.index=0;var k=this.expression(0);if(this._lookahead(0)!==T){var z=this._lookaheadToken(0),H=new Error("Unexpected token type: "+z.type+", value: "+z.value);throw H.name="ParserError",H}return k},_loadTokens:function(x){var k=new Ln,z=k.tokenize(x);z.push({type:T,value:"",start:x.length}),this.tokens=z},expression:function(x){var k=this._lookaheadToken(0);this._advance();for(var z=this.nud(k),H=this._lookahead(0);x<Ee[H];)this._advance(),z=this.led(H,z),H=this._lookahead(0);return z},_lookahead:function(x){return this.tokens[this.index+x].type},_lookaheadToken:function(x){return this.tokens[this.index+x]},_advance:function(){this.index++},nud:function(x){var k,z,H;switch(x.type){case xe:return{type:"Literal",value:x.value};case A:return{type:"Field",name:x.value};case N:var X={type:"Field",name:x.value};if(this._lookahead(0)===fe)throw new Error("Quoted identifier not allowed for function names.");return X;case U:return z=this.expression(Ee.Not),{type:"NotExpression",children:[z]};case Qe:return k={type:"Identity"},z=null,this._lookahead(0)===D?z={type:"Identity"}:z=this._parseProjectionRHS(Ee.Star),{type:"ValueProjection",children:[k,z]};case ue:return this.led(x.type,{type:"Identity"});case j:return this._parseMultiselectHash();case Le:return k={type:Le,children:[{type:"Identity"}]},z=this._parseProjectionRHS(Ee.Flatten),{type:"Projection",children:[k,z]};case Y:return this._lookahead(0)===me||this._lookahead(0)===se?(z=this._parseIndexExpression(),this._projectIfSlice({type:"Identity"},z)):this._lookahead(0)===Qe&&this._lookahead(1)===D?(this._advance(),this._advance(),z=this._parseProjectionRHS(Ee.Star),{type:"Projection",children:[{type:"Identity"},z]}):this._parseMultiselectList();case ge:return{type:ge};case Xe:return H=this.expression(Ee.Expref),{type:"ExpressionReference",children:[H]};case fe:for(var ce=[];this._lookahead(0)!==L;)this._lookahead(0)===ge?(H={type:ge},this._advance()):H=this.expression(0),ce.push(H);return this._match(L),ce[0];default:this._errorToken(x)}},led:function(x,k){var z;switch(x){case te:var H=Ee.Dot;return this._lookahead(0)!==Qe?(z=this._parseDotRHS(H),{type:"Subexpression",children:[k,z]}):(this._advance(),z=this._parseProjectionRHS(H),{type:"ValueProjection",children:[k,z]});case Ue:return z=this.expression(Ee.Pipe),{type:Ue,children:[k,z]};case ut:return z=this.expression(Ee.Or),{type:"OrExpression",children:[k,z]};case Ve:return z=this.expression(Ee.And),{type:"AndExpression",children:[k,z]};case fe:for(var X=k.name,ce=[],Pe,Ze;this._lookahead(0)!==L;)this._lookahead(0)===ge?(Pe={type:ge},this._advance()):Pe=this.expression(0),this._lookahead(0)===q&&this._match(q),ce.push(Pe);return this._match(L),Ze={type:"Function",name:X,children:ce},Ze;case ue:var Et=this.expression(0);return this._match(D),this._lookahead(0)===Le?z={type:"Identity"}:z=this._parseProjectionRHS(Ee.Filter),{type:"FilterProjection",children:[k,z,Et]};case Le:var tn={type:Le,children:[k]},ft=this._parseProjectionRHS(Ee.Flatten);return{type:"Projection",children:[tn,ft]};case ne:case Te:case ae:case he:case ie:case _e:return this._parseComparator(k,x);case Y:var Se=this._lookaheadToken(0);return Se.type===me||Se.type===se?(z=this._parseIndexExpression(),this._projectIfSlice(k,z)):(this._match(Qe),this._match(D),z=this._parseProjectionRHS(Ee.Star),{type:"Projection",children:[k,z]});default:this._errorToken(this._lookaheadToken(0))}},_match:function(x){if(this._lookahead(0)===x)this._advance();else{var k=this._lookaheadToken(0),z=new Error("Expected "+x+", got: "+k.type);throw z.name="ParserError",z}},_errorToken:function(x){var k=new Error("Invalid token ("+x.type+'): "'+x.value+'"');throw k.name="ParserError",k},_parseIndexExpression:function(){if(this._lookahead(0)===se||this._lookahead(1)===se)return this._parseSliceExpression();var x={type:"Index",value:this._lookaheadToken(0).value};return this._advance(),this._match(D),x},_projectIfSlice:function(x,k){var z={type:"IndexExpression",children:[x,k]};return k.type==="Slice"?{type:"Projection",children:[z,this._parseProjectionRHS(Ee.Star)]}:z},_parseSliceExpression:function(){for(var x=[null,null,null],k=0,z=this._lookahead(0);z!==D&&k<3;){if(z===se)k++,this._advance();else if(z===me)x[k]=this._lookaheadToken(0).value,this._advance();else{var H=this._lookahead(0),X=new Error("Syntax error, unexpected token: "+H.value+"("+H.type+")");throw X.name="Parsererror",X}z=this._lookahead(0)}return this._match(D),{type:"Slice",children:x}},_parseComparator:function(x,k){var z=this.expression(Ee[k]);return{type:"Comparator",name:k,children:[x,z]}},_parseDotRHS:function(x){var k=this._lookahead(0),z=[A,N,Qe];if(z.indexOf(k)>=0)return this.expression(x);if(k===Y)return this._match(Y),this._parseMultiselectList();if(k===j)return this._match(j),this._parseMultiselectHash()},_parseProjectionRHS:function(x){var k;if(Ee[this._lookahead(0)]<10)k={type:"Identity"};else if(this._lookahead(0)===Y)k=this.expression(x);else if(this._lookahead(0)===ue)k=this.expression(x);else if(this._lookahead(0)===te)this._match(te),k=this._parseDotRHS(x);else{var z=this._lookaheadToken(0),H=new Error("Sytanx error, unexpected token: "+z.value+"("+z.type+")");throw H.name="ParserError",H}return k},_parseMultiselectList:function(){for(var x=[];this._lookahead(0)!==D;){var k=this.expression(0);if(x.push(k),this._lookahead(0)===q&&(this._match(q),this._lookahead(0)===D))throw new Error("Unexpected token Rbracket")}return this._match(D),{type:"MultiSelectList",children:x}},_parseMultiselectHash:function(){for(var x=[],k=[A,N],z,H,X,ce;;){if(z=this._lookaheadToken(0),k.indexOf(z.type)<0)throw new Error("Expecting an identifier token, got: "+z.type);if(H=z.value,this._advance(),this._match(se),X=this.expression(0),ce={type:"KeyValuePair",name:H,value:X},x.push(ce),this._lookahead(0)===q)this._match(q);else if(this._lookahead(0)===we){this._match(we);break}}return{type:"MultiSelectHash",children:x}}};function tt(x){this.runtime=x}tt.prototype={search:function(x,k){return this.visit(x,k)},visit:function(x,k){var z,H,X,ce,Pe,Ze,Et,tn,ft,Se;switch(x.type){case"Field":return k!==null&&r(k)?(Ze=k[x.name],Ze===void 0?null:Ze):null;case"Subexpression":for(X=this.visit(x.children[0],k),Se=1;Se<x.children.length;Se++)if(X=this.visit(x.children[1],X),X===null)return null;return X;case"IndexExpression":return Et=this.visit(x.children[0],k),tn=this.visit(x.children[1],Et),tn;case"Index":if(!t(k))return null;var jt=x.value;return jt<0&&(jt=k.length+jt),X=k[jt],X===void 0&&(X=null),X;case"Slice":if(!t(k))return null;var ts=x.children.slice(0),_i=this.computeSliceParams(k.length,ts),Zr=_i[0],qr=_i[1],gr=_i[2];if(X=[],gr>0)for(Se=Zr;Se<qr;Se+=gr)X.push(k[Se]);else for(Se=Zr;Se>qr;Se+=gr)X.push(k[Se]);return X;case"Projection":var nn=this.visit(x.children[0],k);if(!t(nn))return null;for(ft=[],Se=0;Se<nn.length;Se++)H=this.visit(x.children[1],nn[Se]),H!==null&&ft.push(H);return ft;case"ValueProjection":if(nn=this.visit(x.children[0],k),!r(nn))return null;ft=[];var Ji=u(nn);for(Se=0;Se<Ji.length;Se++)H=this.visit(x.children[1],Ji[Se]),H!==null&&ft.push(H);return ft;case"FilterProjection":if(nn=this.visit(x.children[0],k),!t(nn))return null;var yi=[],Gr=[];for(Se=0;Se<nn.length;Se++)z=this.visit(x.children[2],nn[Se]),a(z)||yi.push(nn[Se]);for(var bi=0;bi<yi.length;bi++)H=this.visit(x.children[1],yi[bi]),H!==null&&Gr.push(H);return Gr;case"Comparator":switch(ce=this.visit(x.children[0],k),Pe=this.visit(x.children[1],k),x.name){case ne:X=o(ce,Pe);break;case Te:X=!o(ce,Pe);break;case ae:X=ce>Pe;break;case he:X=ce>=Pe;break;case ie:X=ce<Pe;break;case _e:X=ce<=Pe;break;default:throw new Error("Unknown comparator: "+x.name)}return X;case Le:var wi=this.visit(x.children[0],k);if(!t(wi))return null;var Hr=[];for(Se=0;Se<wi.length;Se++)H=wi[Se],t(H)?Hr.push.apply(Hr,H):Hr.push(H);return Hr;case"Identity":return k;case"MultiSelectList":if(k===null)return null;for(ft=[],Se=0;Se<x.children.length;Se++)ft.push(this.visit(x.children[Se],k));return ft;case"MultiSelectHash":if(k===null)return null;ft={};var Fn;for(Se=0;Se<x.children.length;Se++)Fn=x.children[Se],ft[Fn.name]=this.visit(Fn.value,k);return ft;case"OrExpression":return z=this.visit(x.children[0],k),a(z)&&(z=this.visit(x.children[1],k)),z;case"AndExpression":return ce=this.visit(x.children[0],k),a(ce)===!0?ce:this.visit(x.children[1],k);case"NotExpression":return ce=this.visit(x.children[0],k),a(ce);case"Literal":return x.value;case Ue:return Et=this.visit(x.children[0],k),this.visit(x.children[1],Et);case ge:return k;case"Function":var Yi=[];for(Se=0;Se<x.children.length;Se++)Yi.push(this.visit(x.children[Se],k));return this.runtime.callFunction(x.name,Yi);case"ExpressionReference":var Wr=x.children[0];return Wr.jmespathType=Xe,Wr;default:throw new Error("Unknown node type: "+x.type)}},computeSliceParams:function(x,k){var z=k[0],H=k[1],X=k[2],ce=[null,null,null];if(X===null)X=1;else if(X===0){var Pe=new Error("Invalid slice, step cannot be 0");throw Pe.name="RuntimeError",Pe}var Ze=X<0;return z===null?z=Ze?x-1:0:z=this.capSliceRange(x,z,X),H===null?H=Ze?-1:x:H=this.capSliceRange(x,H,X),ce[0]=z,ce[1]=H,ce[2]=X,ce},capSliceRange:function(x,k,z){return k<0?(k+=x,k<0&&(k=z<0?-1:0)):k>=x&&(k=z<0?x-1:x),k}};function En(x){this._interpreter=x,this.functionTable={abs:{_func:this._functionAbs,_signature:[{types:[c]}]},avg:{_func:this._functionAvg,_signature:[{types:[C]}]},ceil:{_func:this._functionCeil,_signature:[{types:[c]}]},contains:{_func:this._functionContains,_signature:[{types:[p,g]},{types:[f]}]},ends_with:{_func:this._functionEndsWith,_signature:[{types:[p]},{types:[p]}]},floor:{_func:this._functionFloor,_signature:[{types:[c]}]},length:{_func:this._functionLength,_signature:[{types:[p,g,m]}]},map:{_func:this._functionMap,_signature:[{types:[_]},{types:[g]}]},max:{_func:this._functionMax,_signature:[{types:[C,S]}]},merge:{_func:this._functionMerge,_signature:[{types:[m],variadic:!0}]},max_by:{_func:this._functionMaxBy,_signature:[{types:[g]},{types:[_]}]},sum:{_func:this._functionSum,_signature:[{types:[C]}]},starts_with:{_func:this._functionStartsWith,_signature:[{types:[p]},{types:[p]}]},min:{_func:this._functionMin,_signature:[{types:[C,S]}]},min_by:{_func:this._functionMinBy,_signature:[{types:[g]},{types:[_]}]},type:{_func:this._functionType,_signature:[{types:[f]}]},keys:{_func:this._functionKeys,_signature:[{types:[m]}]},values:{_func:this._functionValues,_signature:[{types:[m]}]},sort:{_func:this._functionSort,_signature:[{types:[S,C]}]},sort_by:{_func:this._functionSortBy,_signature:[{types:[g]},{types:[_]}]},join:{_func:this._functionJoin,_signature:[{types:[p]},{types:[S]}]},reverse:{_func:this._functionReverse,_signature:[{types:[p,g]}]},to_array:{_func:this._functionToArray,_signature:[{types:[f]}]},to_string:{_func:this._functionToString,_signature:[{types:[f]}]},to_number:{_func:this._functionToNumber,_signature:[{types:[f]}]},not_null:{_func:this._functionNotNull,_signature:[{types:[f],variadic:!0}]}}}En.prototype={callFunction:function(x,k){var z=this.functionTable[x];if(z===void 0)throw new Error("Unknown function: "+x+"()");return this._validateArgs(x,k,z._signature),z._func.call(this,k)},_validateArgs:function(x,k,z){var H;if(z[z.length-1].variadic){if(k.length<z.length)throw H=z.length===1?" argument":" arguments",new Error("ArgumentError: "+x+"() takes at least"+z.length+H+" but received "+k.length)}else if(k.length!==z.length)throw H=z.length===1?" argument":" arguments",new Error("ArgumentError: "+x+"() takes "+z.length+H+" but received "+k.length);for(var X,ce,Pe,Ze=0;Ze<z.length;Ze++){Pe=!1,X=z[Ze].types,ce=this._getTypeName(k[Ze]);for(var Et=0;Et<X.length;Et++)if(this._typeMatches(ce,X[Et],k[Ze])){Pe=!0;break}if(!Pe){var tn=X.map(function(ft){return I[ft]}).join(",");throw new Error("TypeError: "+x+"() expected argument "+(Ze+1)+" to be type "+tn+" but received type "+I[ce]+" instead.")}}},_typeMatches:function(x,k,z){if(k===f)return!0;if(k===S||k===C||k===g){if(k===g)return x===g;if(x===g){var H;k===C?H=c:k===S&&(H=p);for(var X=0;X<z.length;X++)if(!this._typeMatches(this._getTypeName(z[X]),H,z[X]))return!1;return!0}}else return x===k},_getTypeName:function(x){switch(Object.prototype.toString.call(x)){case"[object String]":return p;case"[object Number]":return c;case"[object Array]":return g;case"[object Boolean]":return b;case"[object Null]":return $;case"[object Object]":return x.jmespathType===Xe?_:m}},_functionStartsWith:function(x){return x[0].lastIndexOf(x[1])===0},_functionEndsWith:function(x){var k=x[0],z=x[1];return k.indexOf(z,k.length-z.length)!==-1},_functionReverse:function(x){var k=this._getTypeName(x[0]);if(k===p){for(var z=x[0],H="",X=z.length-1;X>=0;X--)H+=z[X];return H}else{var ce=x[0].slice(0);return ce.reverse(),ce}},_functionAbs:function(x){return Math.abs(x[0])},_functionCeil:function(x){return Math.ceil(x[0])},_functionAvg:function(x){for(var k=0,z=x[0],H=0;H<z.length;H++)k+=z[H];return k/z.length},_functionContains:function(x){return x[0].indexOf(x[1])>=0},_functionFloor:function(x){return Math.floor(x[0])},_functionLength:function(x){return r(x[0])?Object.keys(x[0]).length:x[0].length},_functionMap:function(x){for(var k=[],z=this._interpreter,H=x[0],X=x[1],ce=0;ce<X.length;ce++)k.push(z.visit(H,X[ce]));return k},_functionMerge:function(x){for(var k={},z=0;z<x.length;z++){var H=x[z];for(var X in H)k[X]=H[X]}return k},_functionMax:function(x){if(x[0].length>0){var k=this._getTypeName(x[0][0]);if(k===c)return Math.max.apply(Math,x[0]);for(var z=x[0],H=z[0],X=1;X<z.length;X++)H.localeCompare(z[X])<0&&(H=z[X]);return H}else return null},_functionMin:function(x){if(x[0].length>0){var k=this._getTypeName(x[0][0]);if(k===c)return Math.min.apply(Math,x[0]);for(var z=x[0],H=z[0],X=1;X<z.length;X++)z[X].localeCompare(H)<0&&(H=z[X]);return H}else return null},_functionSum:function(x){for(var k=0,z=x[0],H=0;H<z.length;H++)k+=z[H];return k},_functionType:function(x){switch(this._getTypeName(x[0])){case c:return"number";case p:return"string";case g:return"array";case m:return"object";case b:return"boolean";case _:return"expref";case $:return"null"}},_functionKeys:function(x){return Object.keys(x[0])},_functionValues:function(x){for(var k=x[0],z=Object.keys(k),H=[],X=0;X<z.length;X++)H.push(k[z[X]]);return H},_functionJoin:function(x){var k=x[0],z=x[1];return z.join(k)},_functionToArray:function(x){return this._getTypeName(x[0])===g?x[0]:[x[0]]},_functionToString:function(x){return this._getTypeName(x[0])===p?x[0]:JSON.stringify(x[0])},_functionToNumber:function(x){var k=this._getTypeName(x[0]),z;return k===c?x[0]:k===p&&(z=+x[0],!isNaN(z))?z:null},_functionNotNull:function(x){for(var k=0;k<x.length;k++)if(this._getTypeName(x[k])!==$)return x[k];return null},_functionSort:function(x){var k=x[0].slice(0);return k.sort(),k},_functionSortBy:function(x){var k=x[0].slice(0);if(k.length===0)return k;var z=this._interpreter,H=x[1],X=this._getTypeName(z.visit(H,k[0]));if([c,p].indexOf(X)<0)throw new Error("TypeError");for(var ce=this,Pe=[],Ze=0;Ze<k.length;Ze++)Pe.push([Ze,k[Ze]]);Pe.sort(function(tn,ft){var Se=z.visit(H,tn[1]),jt=z.visit(H,ft[1]);if(ce._getTypeName(Se)!==X)throw new Error("TypeError: expected "+X+", received "+ce._getTypeName(Se));if(ce._getTypeName(jt)!==X)throw new Error("TypeError: expected "+X+", received "+ce._getTypeName(jt));return Se>jt?1:Se<jt?-1:tn[0]-ft[0]});for(var Et=0;Et<Pe.length;Et++)k[Et]=Pe[Et][1];return k},_functionMaxBy:function(x){for(var k=x[1],z=x[0],H=this.createKeyFunction(k,[c,p]),X=-1/0,ce,Pe,Ze=0;Ze<z.length;Ze++)Pe=H(z[Ze]),Pe>X&&(X=Pe,ce=z[Ze]);return ce},_functionMinBy:function(x){for(var k=x[1],z=x[0],H=this.createKeyFunction(k,[c,p]),X=1/0,ce,Pe,Ze=0;Ze<z.length;Ze++)Pe=H(z[Ze]),Pe<X&&(X=Pe,ce=z[Ze]);return ce},createKeyFunction:function(x,k){var z=this,H=this._interpreter,X=function(ce){var Pe=H.visit(x,ce);if(k.indexOf(z._getTypeName(Pe))<0){var Ze="TypeError: expected one of "+k+", received "+z._getTypeName(Pe);throw new Error(Ze)}return Pe};return X}};function Bn(x){var k=new qt,z=k.parse(x);return z}function es(x){var k=new Ln;return k.tokenize(x)}function pr(x,k){var z=new qt,H=new En,X=new tt(H);H._interpreter=X;var ce=z.parse(k);return X.search(ce,x)}e.tokenize=es,e.compile=Bn,e.search=pr,e.strictDeepEqual=o})(n)}(bl)),bl}var _p=Dw();const zr=No(_p),_a=class _a{constructor(e,t={}){this.mesh=null,this.texture=null,this.material=null,this.parsedContent=[],this.actualDimensions={width:0,height:0},this.contentArea={x:0,y:0,width:0,height:0},this.totalBorderWidth=0,this.pointerInfo=null,this.animationTime=0,this._progressValue=0,this.originalPosition=null,this.scene=e,t.fontSize!==void 0&&t.fontSize>500&&(console.warn(`RichTextLabel: fontSize ${t.fontSize} exceeds maximum of 500, clamping to 500`),t.fontSize=500);const r={text:"Label",font:"Verdana",fontSize:48,fontWeight:"normal",lineHeight:1.2,textColor:"black",backgroundColor:"transparent",borderWidth:0,borderColor:"rgba(255, 255, 255, 0.8)",borders:[],marginTop:5,marginBottom:5,marginLeft:5,marginRight:5,textAlign:"center",cornerRadius:0,autoSize:!0,resolution:1024,billboardMode:W.Mesh.BILLBOARDMODE_ALL,depthFadeEnabled:!1,depthFadeNear:5,depthFadeFar:20,position:{x:0,y:0,z:0},attachTo:null,attachPosition:"top",attachOffset:.5,textOutline:!1,textOutlineWidth:2,textOutlineColor:"black",textOutlineJoin:"round",textShadow:!1,textShadowColor:"rgba(0, 0, 0, 0.5)",textShadowBlur:4,textShadowOffsetX:2,textShadowOffsetY:2,backgroundPadding:0,backgroundGradient:!1,backgroundGradientType:"linear",backgroundGradientColors:["rgba(0, 0, 0, 0.8)","rgba(50, 50, 50, 0.8)"],backgroundGradientDirection:"vertical",pointer:!1,pointerDirection:"bottom",pointerWidth:20,pointerHeight:15,pointerOffset:0,pointerCurve:!0,animation:null,animationSpeed:1,badge:void 0,icon:void 0,iconPosition:"left",progress:void 0,smartOverflow:!1,maxNumber:999,overflowSuffix:"+",_badgeType:void 0,_smartSizing:void 0,_paddingRatio:void 0,_removeText:void 0,_progressBar:void 0};let o=Object.assign({},r);if(t.badge!==void 0){const a=_a.BADGE_STYLES[t.badge];o=Object.assign(o,a),this._applyBadgeBehaviors(o,t)}if(o=Object.assign(o,t),o.smartOverflow&&o.text&&!isNaN(Number(o.text))){const a=parseInt(o.text);a>o.maxNumber&&(a>=1e3?o.text=`${Math.floor(a/1e3)}k`:o.text=`${o.maxNumber}${o.overflowSuffix}`)}o.borderWidth>0&&o.borders.length===0&&(o.borders=[{width:o.borderWidth,color:o.borderColor,spacing:0}]),this.options=o,this.id=`richLabel_${Math.random().toString(36).substring(2,11)}`,this._create()}_applyBadgeBehaviors(e,t){const r=e._badgeType;if(e._paddingRatio&&!t.marginTop){const o=e.fontSize*e._paddingRatio;e.marginTop=e.marginBottom=o,e.marginLeft=e.marginRight=o}switch(r){case"notification":case"count":{if(e.smartOverflow&&!isNaN(Number(t.text))){const o=parseInt(t.text??"0");o>e.maxNumber&&(o>=1e3?e.text=`${Math.floor(o/1e3)}k`:e.text=`${e.maxNumber}${e.overflowSuffix}`)}break}case"dot":{e._removeText&&(e.text="");break}case"progress":{t.progress!==void 0&&(this._progressValue=Math.max(0,Math.min(1,t.progress)));break}case"icon":{t.icon&&!t.text?e.text=t.icon:t.icon&&t.text&&((t.iconPosition??"left")==="left"?e.text=`${t.icon} ${t.text}`:e.text=`${t.text} ${t.icon}`);break}}}_create(){this._parseRichText(),this._calculateDimensions(),this._createTexture(),this._createMaterial(),this._createMesh(),this.options.attachTo?this._attachToTarget():this.mesh&&(this.mesh.position=new W.Vector3(this.options.position.x,this.options.position.y,this.options.position.z),this.originalPosition??(this.originalPosition=this.mesh.position.clone())),this.options.depthFadeEnabled&&this._setupDepthFading(),this.options.animation&&this._setupAnimation()}_parseRichText(){const{text:e}=this.options,t=e.split(`
`);this.parsedContent=[];for(const r of t){const o=[];let a=0;const u=[{font:this.options.font,size:this.options.fontSize,weight:this.options.fontWeight,style:"normal",color:this.options.textColor,background:null}],h=/<(\/?)(bold|italic|color|size|font|bg)(?:='([^']*)')?>/g;let c;for(;(c=h.exec(r))!==null;){c.index>a&&o.push({text:r.substring(a,c.index),style:Object.assign({},u[u.length-1])});const f=c[1]==="/",p=c[2],g=c[3];if(f)u.length>1&&u.pop();else{const m=Object.assign({},u[u.length-1]);switch(p){case"bold":m.weight="bold";break;case"italic":m.style="italic";break;case"color":m.color=g||this.options.textColor;break;case"size":m.size=parseInt(g||"0")||this.options.fontSize;break;case"font":m.font=g||this.options.font;break;case"bg":m.background=g||null;break}u.push(m)}a=c.index+c[0].length}a<r.length&&o.push({text:r.substring(a),style:Object.assign({},u[u.length-1])}),this.parsedContent.push(o)}}_calculateDimensions(){const t=document.createElement("canvas").getContext("2d");if(!t)return;let r=0,o=0;for(const c of this.parsedContent){let f=0,p=0;for(const g of c){const{style:m}=g;t.font=`${m.style} ${m.weight} ${m.size}px ${m.font}`;const b=t.measureText(g.text);f+=b.width,p=Math.max(p,m.size)}this.options.textOutline&&(f+=this.options.textOutlineWidth*2,p+=this.options.textOutlineWidth*2),r=Math.max(r,f),o+=p*this.options.lineHeight}const a=this.options.backgroundPadding*2;if(this.totalBorderWidth=0,this.options.borders.length>0)for(let c=0;c<this.options.borders.length;c++)this.totalBorderWidth+=this.options.borders[c].width,c<this.options.borders.length-1&&this.options.borders[c].spacing>0&&(this.totalBorderWidth+=this.options.borders[c].spacing);const u=r+this.options.marginLeft+this.options.marginRight+a,h=o+this.options.marginTop+this.options.marginBottom+a;if(this.contentArea={x:this.totalBorderWidth,y:this.totalBorderWidth,width:u,height:h},this.actualDimensions.width=u+this.totalBorderWidth*2,this.actualDimensions.height=h+this.totalBorderWidth*2,this.options.pointer&&(this._calculatePointerDimensions(),this.pointerInfo))switch(this.pointerInfo.direction){case"top":this.actualDimensions.height+=this.options.pointerHeight,this.contentArea.y=this.totalBorderWidth+this.options.pointerHeight;break;case"bottom":this.actualDimensions.height+=this.options.pointerHeight;break;case"left":this.actualDimensions.width+=this.options.pointerHeight,this.contentArea.x=this.totalBorderWidth+this.options.pointerHeight;break;case"right":this.actualDimensions.width+=this.options.pointerHeight;break}if(this.options._smartSizing){const c=this.actualDimensions.height;if(this.actualDimensions.width<c){const f=c-this.actualDimensions.width;this.actualDimensions.width=c,this.contentArea.x+=f/2}}}_calculatePointerDimensions(){let e=this.options.pointerDirection;e==="auto"&&this.options.attachTo&&(e="bottom"),this.pointerInfo={direction:e,width:this.options.pointerWidth,height:this.options.pointerHeight,offset:this.options.pointerOffset,curve:this.options.pointerCurve}}_createTexture(){let t=this.options.autoSize?Math.pow(2,Math.ceil(Math.log2(this.actualDimensions.width))):this.options.resolution;const r=this.actualDimensions.width/this.actualDimensions.height;let o=this.options.autoSize?Math.pow(2,Math.ceil(Math.log2(this.actualDimensions.height))):Math.floor(t/r);if(t>4096||o>4096){const a=4096/Math.max(t,o);t=Math.floor(t*a),o=Math.floor(o*a),console.warn(`RichTextLabel: Texture size clamped to ${t}x${o} (max: 4096)`)}this.texture=new W.DynamicTexture(`richTextTexture_${this.id}`,{width:t,height:o},this.scene,!0),this.texture.hasAlpha=!0,this.texture.updateSamplingMode(W.Texture.TRILINEAR_SAMPLINGMODE),this._drawContent()}_drawContent(){if(!this.texture)return;const e=this.texture.getContext(),{width:t}=this.texture.getSize(),{height:r}=this.texture.getSize();e.clearRect(0,0,t,r);const o=t/this.actualDimensions.width,a=r/this.actualDimensions.height;e.save(),e.scale(o,a),this.options.pointer?this._drawBackgroundWithPointer(e):this._drawBackgroundWithBorders(e),this._drawRichText(e),e.restore(),this.texture.update()}_drawBackgroundWithBorders(e){const{width:t}=this.actualDimensions,{height:r}=this.actualDimensions,o=this.options.cornerRadius;if(this.options.borders.length>0){let p=0;for(let g=0;g<this.options.borders.length;g++){const m=this.options.borders[g];g>0&&this.options.borders[g-1].spacing>0&&(p+=this.options.borders[g-1].spacing);const b=p,_=p,$=t-p*2,C=r-p*2,S=Math.max(0,o-p),I=p+m.width,T=I,A=I,N=t-I*2,D=r-I*2;let L;if(o>0){const q=Math.max(2,o*.2);if(L=Math.max(q,o-I),g===this.options.borders.length-1){const se=Math.max(0,o-this.totalBorderWidth);L<se+5&&(L=se)}}else L=0;e.fillStyle=m.color,e.beginPath(),this._createRoundedRectPath(e,b,_,$,C,S),(g<this.options.borders.length-1||I<this.totalBorderWidth)&&(e.moveTo(T+L,A),e.arcTo(T+N,A,T+N,A+L,L),e.lineTo(T+N,A+D-L),e.arcTo(T+N,A+D,T+N-L,A+D,L),e.lineTo(T+L,A+D),e.arcTo(T,A+D,T,A+D-L,L),e.lineTo(T,A+L),e.arcTo(T,A,T+L,A,L),e.closePath()),e.fill("evenodd"),p=I}}const a=this.totalBorderWidth,u=this.totalBorderWidth,h=t-this.totalBorderWidth*2,c=r-this.totalBorderWidth*2;let f;if(o>0){const p=Math.max(2,o*.2);f=Math.max(p,o-this.totalBorderWidth)}else f=0;if(e.beginPath(),this._createRoundedRectPath(e,a,u,h,c,f),this.options.backgroundGradient){let p;if(this.options.backgroundGradientType==="radial")p=e.createRadialGradient(t/2,r/2,0,t/2,r/2,Math.max(t,r)/2);else switch(this.options.backgroundGradientDirection){case"horizontal":p=e.createLinearGradient(0,0,t,0);break;case"diagonal":p=e.createLinearGradient(0,0,t,r);break;case"vertical":default:p=e.createLinearGradient(0,0,0,r);break}const g=this.options.backgroundGradientColors;for(let m=0;m<g.length;m++)p.addColorStop(m/(g.length-1),g[m]);e.fillStyle=p}else e.fillStyle=this.options.backgroundColor;e.fill()}_drawBackgroundWithPointer(e){const{width:t}=this.actualDimensions,{height:r}=this.actualDimensions,o=this.options.cornerRadius,{pointerHeight:a}=this.options,{pointerWidth:u}=this.options,{pointerOffset:h}=this.options,c=this.contentArea.x,f=this.contentArea.y,p=this.contentArea.width,g=this.contentArea.height;if(this.options.borders.length>0){let m=0;for(let b=0;b<this.options.borders.length;b++){const _=this.options.borders[b];b>0&&this.options.borders[b-1].spacing>0&&(m+=this.options.borders[b-1].spacing),e.save(),e.fillStyle=_.color,e.beginPath(),this.pointerInfo&&this._createSpeechBubblePath(e,c-this.totalBorderWidth+m,f-this.totalBorderWidth+m,p+(this.totalBorderWidth-m)*2,g+(this.totalBorderWidth-m)*2,Math.max(0,o-m),u,a,h,this.pointerInfo.direction,this.options.pointerCurve);const $=m+_.width;if(b<this.options.borders.length-1||$<this.totalBorderWidth){let C;if(o>0){const T=Math.max(2,o*.2);if(C=Math.max(T,o-$),b===this.options.borders.length-1){const A=Math.max(T,o-this.totalBorderWidth);C<A+5&&(C=A)}}else C=0;const S=c-this.totalBorderWidth+$,I=f-this.totalBorderWidth+$;e.moveTo(S+C,I),this.pointerInfo&&this._createSpeechBubblePathCCW(e,S,I,p+(this.totalBorderWidth-$)*2,g+(this.totalBorderWidth-$)*2,C,u,a,h,this.pointerInfo.direction,this.options.pointerCurve)}e.fill("evenodd"),e.restore(),m=$}}if(e.beginPath(),this.pointerInfo&&this._createSpeechBubblePath(e,c,f,p,g,o,u,a,h,this.pointerInfo.direction,this.options.pointerCurve),e.closePath(),this.options.backgroundGradient){let m;if(this.options.backgroundGradientType==="radial")m=e.createRadialGradient(t/2,r/2,0,t/2,r/2,Math.max(t,r)/2);else switch(this.options.backgroundGradientDirection){case"horizontal":m=e.createLinearGradient(0,0,t,0);break;case"diagonal":m=e.createLinearGradient(0,0,t,r);break;case"vertical":default:m=e.createLinearGradient(0,0,0,r);break}const b=this.options.backgroundGradientColors;for(let _=0;_<b.length;_++)m.addColorStop(_/(b.length-1),b[_]);e.fillStyle=m}else e.fillStyle=this.options.backgroundColor;e.fill()}_createSpeechBubblePath(e,t,r,o,a,u,h,c,f,p,g){switch(p){case"bottom":{e.moveTo(t+u,r),e.lineTo(t+o-u,r),e.quadraticCurveTo(t+o,r,t+o,r+u),e.lineTo(t+o,r+a-u),e.quadraticCurveTo(t+o,r+a,t+o-u,r+a);const m=t+o/2+f;e.lineTo(Math.min(m+h/2,t+o-u),r+a),g?e.quadraticCurveTo(m,r+a+c,Math.max(m-h/2,t+u),r+a):(e.lineTo(m,r+a+c),e.lineTo(Math.max(m-h/2,t+u),r+a)),e.lineTo(t+u,r+a),e.quadraticCurveTo(t,r+a,t,r+a-u),e.lineTo(t,r+u),e.quadraticCurveTo(t,r,t+u,r);break}case"top":{const m=t+o/2+f;e.moveTo(Math.max(m-h/2,t+u),r),g?e.quadraticCurveTo(m,r-c,Math.min(m+h/2,t+o-u),r):(e.lineTo(m,r-c),e.lineTo(Math.min(m+h/2,t+o-u),r)),e.lineTo(t+o-u,r),e.quadraticCurveTo(t+o,r,t+o,r+u),e.lineTo(t+o,r+a-u),e.quadraticCurveTo(t+o,r+a,t+o-u,r+a),e.lineTo(t+u,r+a),e.quadraticCurveTo(t,r+a,t,r+a-u),e.lineTo(t,r+u),e.quadraticCurveTo(t,r,t+u,r),e.lineTo(Math.max(m-h/2,t+u),r);break}case"left":{const m=r+a/2+f;e.moveTo(t,Math.max(m-h/2,r+u)),g?e.quadraticCurveTo(t-c,m,t,Math.min(m+h/2,r+a-u)):(e.lineTo(t-c,m),e.lineTo(t,Math.min(m+h/2,r+a-u))),e.lineTo(t,r+a-u),e.quadraticCurveTo(t,r+a,t+u,r+a),e.lineTo(t+o-u,r+a),e.quadraticCurveTo(t+o,r+a,t+o,r+a-u),e.lineTo(t+o,r+u),e.quadraticCurveTo(t+o,r,t+o-u,r),e.lineTo(t+u,r),e.quadraticCurveTo(t,r,t,r+u),e.lineTo(t,Math.max(m-h/2,r+u));break}case"right":{e.moveTo(t+u,r),e.lineTo(t+o-u,r),e.quadraticCurveTo(t+o,r,t+o,r+u);const m=r+a/2+f;e.lineTo(t+o,Math.max(m-h/2,r+u)),g?e.quadraticCurveTo(t+o+c,m,t+o,Math.min(m+h/2,r+a-u)):(e.lineTo(t+o+c,m),e.lineTo(t+o,Math.min(m+h/2,r+a-u))),e.lineTo(t+o,r+a-u),e.quadraticCurveTo(t+o,r+a,t+o-u,r+a),e.lineTo(t+u,r+a),e.quadraticCurveTo(t,r+a,t,r+a-u),e.lineTo(t,r+u),e.quadraticCurveTo(t,r,t+u,r);break}default:this._createRoundedRectPath(e,t,r,o,a,u);break}}_createSpeechBubblePathCCW(e,t,r,o,a,u,h,c,f,p,g){switch(p){case"bottom":{e.lineTo(t+u,r+a),e.arcTo(t,r+a,t,r+a-u,u),e.lineTo(t,r+u),e.arcTo(t,r,t+u,r,u),e.lineTo(t+o-u,r),e.arcTo(t+o,r,t+o,r+u,u),e.lineTo(t+o,r+a-u),e.arcTo(t+o,r+a,t+o-u,r+a,u);const m=t+o/2+f;e.lineTo(Math.min(m+h/2,t+o-u),r+a),g?e.quadraticCurveTo(m,r+a+c,Math.max(m-h/2,t+u),r+a):(e.lineTo(m,r+a+c),e.lineTo(Math.max(m-h/2,t+u),r+a)),e.lineTo(t+u,r+a);break}case"top":{const m=t+o/2+f;e.lineTo(Math.min(m+h/2,t+o-u),r),e.lineTo(t+o-u,r),e.arcTo(t+o,r,t+o,r+u,u),e.lineTo(t+o,r+a-u),e.arcTo(t+o,r+a,t+o-u,r+a,u),e.lineTo(t+u,r+a),e.arcTo(t,r+a,t,r+a-u,u),e.lineTo(t,r+u),e.arcTo(t,r,t+u,r,u),e.lineTo(Math.max(m-h/2,t+u),r),g?e.quadraticCurveTo(m,r-c,Math.min(m+h/2,t+o-u),r):(e.lineTo(m,r-c),e.lineTo(Math.min(m+h/2,t+o-u),r));break}case"left":{const m=r+a/2+f;e.lineTo(t,Math.min(m+h/2,r+a-u)),e.lineTo(t,r+a-u),e.arcTo(t,r+a,t+u,r+a,u),e.lineTo(t+o-u,r+a),e.arcTo(t+o,r+a,t+o,r+a-u,u),e.lineTo(t+o,r+u),e.arcTo(t+o,r,t+o-u,r,u),e.lineTo(t+u,r),e.arcTo(t,r,t,r+u,u),e.lineTo(t,Math.max(m-h/2,r+u)),g?e.quadraticCurveTo(t-c,m,t,Math.min(m+h/2,r+a-u)):(e.lineTo(t-c,m),e.lineTo(t,Math.min(m+h/2,r+a-u)));break}case"right":{const m=r+a/2+f;e.lineTo(t+o,Math.max(m-h/2,r+u)),e.lineTo(t+o,r+u),e.arcTo(t+o,r,t+o-u,r,u),e.lineTo(t+u,r),e.arcTo(t,r,t,r+u,u),e.lineTo(t,r+a-u),e.arcTo(t,r+a,t+u,r+a,u),e.lineTo(t+o-u,r+a),e.arcTo(t+o,r+a,t+o,r+a-u,u),e.lineTo(t+o,Math.min(m+h/2,r+a-u)),g?e.quadraticCurveTo(t+o+c,m,t+o,Math.max(m-h/2,r+u)):(e.lineTo(t+o+c,m),e.lineTo(t+o,Math.max(m-h/2,r+u)));break}}}_drawRichText(e){const t=this.options.backgroundPadding;let r=this.contentArea.y+this.options.marginTop+t;this.options.textOutline&&(r+=this.options.textOutlineWidth);for(const o of this.parsedContent){let a=0;for(const m of o)a=Math.max(a,m.style.size);let u=0;for(const m of o){const{style:b}=m;e.font=`${b.style} ${b.weight} ${b.size}px ${b.font}`,u+=e.measureText(m.text).width}let h;const c=this.contentArea.x+this.options.marginLeft+t,f=this.contentArea.x+this.contentArea.width-this.options.marginRight-t,p=this.contentArea.x+this.contentArea.width/2;switch(this.options.textAlign){case"left":h=c,this.options.textOutline&&(h+=this.options.textOutlineWidth);break;case"right":h=f-u,this.options.textOutline&&(h-=this.options.textOutlineWidth);break;case"center":default:h=p-u/2;break}let g=h;for(const m of o){const{style:b}=m;if(e.font=`${b.style} ${b.weight} ${b.size}px ${b.font}`,e.textBaseline="top",b.background){const _=e.measureText(m.text);e.fillStyle=b.background,e.fillRect(g,r,_.width,a)}this.options.textShadow&&(e.save(),e.shadowColor=this.options.textShadowColor,e.shadowBlur=this.options.textShadowBlur,e.shadowOffsetX=this.options.textShadowOffsetX,e.shadowOffsetY=this.options.textShadowOffsetY,e.fillStyle=b.color,e.fillText(m.text,g,r),e.restore()),this.options.textOutline&&(e.save(),e.strokeStyle=this.options.textOutlineColor,e.lineWidth=this.options.textOutlineWidth*2,e.lineJoin=this.options.textOutlineJoin,e.miterLimit=2,e.strokeText(m.text,g,r),e.restore()),e.fillStyle=b.color,e.fillText(m.text,g,r),g+=e.measureText(m.text).width}r+=a*this.options.lineHeight}}_createRoundedRectPath(e,t,r,o,a,u){e.beginPath(),e.moveTo(t+u,r),e.lineTo(t+o-u,r),e.quadraticCurveTo(t+o,r,t+o,r+u),e.lineTo(t+o,r+a-u),e.quadraticCurveTo(t+o,r+a,t+o-u,r+a),e.lineTo(t+u,r+a),e.quadraticCurveTo(t,r+a,t,r+a-u),e.lineTo(t,r+u),e.quadraticCurveTo(t,r,t+u,r),e.closePath()}_createMaterial(){this.material=new W.StandardMaterial(`richTextMaterial_${this.id}`,this.scene),this.texture&&(this.material.diffuseTexture=this.texture),this.material.specularColor=new W.Color3(0,0,0),this.material.emissiveColor=new W.Color3(1,1,1),this.material.backFaceCulling=!1,this.material.useAlphaFromDiffuseTexture=!0,this.material.alphaMode=W.Engine.ALPHA_COMBINE}_createMesh(){const e=this.options.fontSize/48,t=this.actualDimensions.width/this.actualDimensions.height,r=e,o=t*e;this.mesh=W.MeshBuilder.CreatePlane(`richTextPlane_${this.id}`,{width:o,height:r,sideOrientation:W.Mesh.DOUBLESIDE},this.scene),this.mesh.material=this.material,this.mesh.billboardMode=this.options.billboardMode}_attachToTarget(){const e=this.options.attachTo,t=this.options.attachPosition,r=this.options.attachOffset;if(!this.mesh)return;let o,a;if(e instanceof W.Vector3)o=e.clone(),a={min:o.clone(),max:o.clone()};else if(e&&"getBoundingInfo"in e){this.mesh.parent=e,o=W.Vector3.Zero();const p=e.getBoundingInfo();a={min:p.boundingBox.minimum,max:p.boundingBox.maximum}}else{this.mesh.position=new W.Vector3(this.options.position.x,this.options.position.y,this.options.position.z);return}const u=this.options.fontSize/48,h=this.actualDimensions.width/this.actualDimensions.height*u,c=u,f=o.clone();if(this.options.pointer&&this.options.pointerDirection==="auto"&&this.pointerInfo){switch(t){case"top":case"top-left":case"top-right":this.pointerInfo.direction="bottom";break;case"bottom":case"bottom-left":case"bottom-right":this.pointerInfo.direction="top";break;case"left":this.pointerInfo.direction="right";break;case"right":this.pointerInfo.direction="left";break;default:this.pointerInfo.direction="bottom"}this._calculateDimensions(),this._drawContent()}switch(t){case"top-left":f.x=a.min.x-h/2-r,f.y=a.max.y+c/2+r;break;case"top":f.x=(a.min.x+a.max.x)/2,f.y=a.max.y+c/2+r;break;case"top-right":f.x=a.max.x+h/2+r,f.y=a.max.y+c/2+r;break;case"left":f.x=a.min.x-h/2-r,f.y=(a.min.y+a.max.y)/2;break;case"center":f.x=(a.min.x+a.max.x)/2,f.y=(a.min.y+a.max.y)/2;break;case"right":f.x=a.max.x+h/2+r,f.y=(a.min.y+a.max.y)/2;break;case"bottom-left":f.x=a.min.x-h/2-r,f.y=a.min.y-c/2-r;break;case"bottom":f.x=(a.min.x+a.max.x)/2,f.y=a.min.y-c/2-r;break;case"bottom-right":f.x=a.max.x+h/2+r,f.y=a.min.y-c/2-r;break;default:f.x=(a.min.x+a.max.x)/2,f.y=a.max.y+c/2+r}this.mesh.position=f,this.originalPosition??(this.originalPosition=f.clone())}_setupDepthFading(){const e=this.scene.activeCamera;this.scene.registerBeforeRender(()=>{if(!e||!this.mesh||!this.material)return;const t=W.Vector3.Distance(e.position,this.mesh.position);let r=1;if(t<this.options.depthFadeNear)r=1;else if(t>this.options.depthFadeFar)r=0;else{const o=this.options.depthFadeFar-this.options.depthFadeNear;r=1-(t-this.options.depthFadeNear)/o}this.material.alpha=r})}_setupAnimation(){this.scene.registerBeforeRender(()=>{if(this.mesh)switch(this.animationTime+=.016*this.options.animationSpeed,this.options.animation){case"pulse":{const e=1+Math.sin(this.animationTime*3)*.1;this.mesh.scaling.x=e,this.mesh.scaling.y=e;break}case"bounce":{if(this.originalPosition){const e=Math.abs(Math.sin(this.animationTime*2))*.3;this.mesh.position.y=this.originalPosition.y+e}break}case"shake":{if(this.originalPosition){const e=Math.sin(this.animationTime*20)*.02,t=Math.cos(this.animationTime*25)*.02;this.mesh.position.x=this.originalPosition.x+e,this.mesh.position.y=this.originalPosition.y+t}break}case"glow":{const e=.8+Math.sin(this.animationTime*2)*.2;this.material&&(this.material.emissiveColor=new W.Color3(e,e,e));break}case"fill":{this.options._progressBar&&(this._progressValue=(Math.sin(this.animationTime)+1)/2,this._drawContent());break}}})}setText(e){if(this.options.smartOverflow&&!isNaN(Number(e))){const t=parseInt(e);t>this.options.maxNumber?t>=1e3?this.options.text=`${Math.floor(t/1e3)}k`:this.options.text=`${this.options.maxNumber}${this.options.overflowSuffix}`:this.options.text=e}else this.options.text=e;this._parseRichText(),this._calculateDimensions(),this._drawContent()}setProgress(e){this._progressValue=Math.max(0,Math.min(1,e)),this._drawContent()}attachTo(e,t="top",r=.5){var o;this.options.attachTo=e,this.options.attachPosition=t,this.options.attachOffset=r,(o=this.mesh)!=null&&o.parent&&this.mesh.parent!==e&&(this.mesh.parent=null),this._attachToTarget()}dispose(){this.mesh&&this.mesh.dispose(),this.material&&this.material.dispose(),this.texture&&this.texture.dispose()}get labelMesh(){return this.mesh}get labelId(){return this.id}};_a.BADGE_STYLES={notification:{backgroundColor:"rgba(255, 59, 48, 1)",textColor:"white",fontWeight:"bold",fontSize:24,cornerRadius:999,textAlign:"center",smartOverflow:!0,animation:"pulse",textOutline:!0,textOutlineWidth:1,textOutlineColor:"rgba(0, 0, 0, 0.3)",pointer:!1,_badgeType:"notification",_smartSizing:!0,_paddingRatio:.8},label:{fontSize:24,cornerRadius:12,fontWeight:"600",backgroundColor:"rgba(0, 122, 255, 1)",textColor:"white",textShadow:!0,textShadowColor:"rgba(0, 0, 0, 0.3)",textShadowBlur:2,textShadowOffsetX:1,textShadowOffsetY:1,_badgeType:"label",_paddingRatio:.6},"label-success":{fontSize:24,cornerRadius:12,fontWeight:"600",backgroundColor:"rgba(52, 199, 89, 1)",textColor:"white",textShadow:!0,textShadowColor:"rgba(0, 0, 0, 0.3)",_badgeType:"label",_paddingRatio:.6},"label-warning":{fontSize:24,cornerRadius:12,fontWeight:"600",backgroundColor:"rgba(255, 204, 0, 1)",textColor:"black",textOutline:!0,textOutlineWidth:1,textOutlineColor:"rgba(255, 255, 255, 0.5)",_badgeType:"label",_paddingRatio:.6},"label-danger":{fontSize:24,cornerRadius:12,fontWeight:"600",backgroundColor:"rgba(255, 59, 48, 1)",textColor:"white",textShadow:!0,textShadowColor:"rgba(0, 0, 0, 0.3)",_badgeType:"label",_paddingRatio:.6},count:{backgroundColor:"rgba(0, 122, 255, 1)",textColor:"white",fontWeight:"bold",fontSize:22,cornerRadius:999,textAlign:"center",smartOverflow:!0,textOutline:!0,textOutlineWidth:1,textOutlineColor:"rgba(0, 0, 0, 0.2)",_badgeType:"count",_smartSizing:!0,_paddingRatio:.7},icon:{fontSize:28,cornerRadius:999,textAlign:"center",backgroundColor:"rgba(100, 100, 100, 0.8)",textShadow:!0,_badgeType:"icon",_paddingRatio:.5},progress:{backgroundColor:"rgba(235, 235, 235, 1)",textColor:"black",fontSize:24,cornerRadius:12,fontWeight:"600",animation:"fill",textOutline:!0,textOutlineWidth:1,textOutlineColor:"white",_badgeType:"progress",_paddingRatio:.8,_progressBar:!0},dot:{backgroundColor:"rgba(255, 59, 48, 1)",cornerRadius:999,animation:"pulse",pointer:!1,_badgeType:"dot",_removeText:!0,marginTop:6,marginBottom:6,marginLeft:6,marginRight:6,fontSize:8}};let Qs=_a;var Ro={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Lw=Ro.exports,yp;function Bw(){return yp||(yp=1,function(n,e){(function(){var t,r="4.17.21",o=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",h="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",f=500,p="__lodash_placeholder__",g=1,m=2,b=4,_=1,$=2,C=1,S=2,I=4,T=8,A=16,N=32,D=64,L=128,q=256,se=512,we=30,me="...",ge=800,Xe=16,Ue=1,ut=2,Ve=3,ne=1/0,ae=9007199254740991,ie=17976931348623157e292,he=NaN,_e=4294967295,Te=_e-1,Le=_e>>>1,Qe=[["ary",L],["bind",C],["bindKey",S],["curry",T],["curryRight",A],["flip",se],["partial",N],["partialRight",D],["rearg",q]],ue="[object Arguments]",te="[object Array]",U="[object AsyncFunction]",j="[object Boolean]",Y="[object Date]",fe="[object DOMException]",xe="[object Error]",He="[object Function]",Tt="[object GeneratorFunction]",ze="[object Map]",ot="[object Number]",Lt="[object Null]",St="[object Object]",Ln="[object Promise]",Ee="[object Proxy]",qt="[object RegExp]",tt="[object Set]",En="[object String]",Bn="[object Symbol]",es="[object Undefined]",pr="[object WeakMap]",x="[object WeakSet]",k="[object ArrayBuffer]",z="[object DataView]",H="[object Float32Array]",X="[object Float64Array]",ce="[object Int8Array]",Pe="[object Int16Array]",Ze="[object Int32Array]",Et="[object Uint8Array]",tn="[object Uint8ClampedArray]",ft="[object Uint16Array]",Se="[object Uint32Array]",jt=/\b__p \+= '';/g,ts=/\b(__p \+=) '' \+/g,_i=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Zr=/&(?:amp|lt|gt|quot|#39);/g,qr=/[&<>"']/g,gr=RegExp(Zr.source),nn=RegExp(qr.source),Ji=/<%-([\s\S]+?)%>/g,yi=/<%([\s\S]+?)%>/g,Gr=/<%=([\s\S]+?)%>/g,bi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,wi=/^\w*$/,Hr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fn=/[\\^$.*+?()[\]{}|]/g,Yi=RegExp(Fn.source),Wr=/^\s+/,za=/\s/,ns=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,bc=/\{\n\/\* \[wrapped with (.+)\] \*/,Da=/,? & /,wc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,La=/[()=,{}\[\]\/\s]/,Ba=/\\(\\)?/g,Fa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rs=/\w*$/,is=/^[-+]0x[0-9a-f]+$/i,mr=/^0b[01]+$/i,xi=/^\[object .+?Constructor\]$/,Ti=/^0o[0-7]+$/i,Qi=/^(?:0|[1-9]\d*)$/,os=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xi=/($^)/,xc=/['\n\r\u2028\u2029\\]/g,vr="\\ud800-\\udfff",dn="\\u0300-\\u036f",jr="\\ufe20-\\ufe2f",or="\\u20d0-\\u20ff",Un=dn+jr+or,Vr="\\u2700-\\u27bf",Cn="a-z\\xdf-\\xf6\\xf8-\\xff",Yn="\\xac\\xb1\\xd7\\xf7",Ua="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Za="\\u2000-\\u206f",eo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pn="A-Z\\xc0-\\xd6\\xd8-\\xde",Si="\\ufe0e\\ufe0f",to=Yn+Ua+Za+eo,Mi="['’]",ss="["+vr+"]",no="["+to+"]",_r="["+Un+"]",Qn="\\d+",Tc="["+Vr+"]",as="["+Cn+"]",ro="[^"+vr+to+Qn+Vr+Cn+pn+"]",io="\\ud83c[\\udffb-\\udfff]",Sc="(?:"+_r+"|"+io+")",qa="[^"+vr+"]",y="(?:\\ud83c[\\udde6-\\uddff]){2}",E="[\\ud800-\\udbff][\\udc00-\\udfff]",O="["+pn+"]",Z="\\u200d",oe="(?:"+as+"|"+ro+")",de="(?:"+O+"|"+ro+")",Be="(?:"+Mi+"(?:d|ll|m|re|s|t|ve))?",Ct="(?:"+Mi+"(?:D|LL|M|RE|S|T|VE))?",kt=Sc+"?",Bt="["+Si+"]?",Zn="(?:"+Z+"(?:"+[qa,y,E].join("|")+")"+Bt+kt+")*",eS="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",tS="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",K0=Bt+kt+Zn,nS="(?:"+[Tc,y,E].join("|")+")"+K0,rS="(?:"+[qa+_r+"?",_r,y,E,ss].join("|")+")",iS=RegExp(Mi,"g"),oS=RegExp(_r,"g"),Mc=RegExp(io+"(?="+io+")|"+rS+K0,"g"),sS=RegExp([O+"?"+as+"+"+Be+"(?="+[no,O,"$"].join("|")+")",de+"+"+Ct+"(?="+[no,O+oe,"$"].join("|")+")",O+"?"+oe+"+"+Be,O+"+"+Ct,tS,eS,Qn,nS].join("|"),"g"),aS=RegExp("["+Z+vr+Un+Si+"]"),uS=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,lS=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],cS=-1,dt={};dt[H]=dt[X]=dt[ce]=dt[Pe]=dt[Ze]=dt[Et]=dt[tn]=dt[ft]=dt[Se]=!0,dt[ue]=dt[te]=dt[k]=dt[j]=dt[z]=dt[Y]=dt[xe]=dt[He]=dt[ze]=dt[ot]=dt[St]=dt[qt]=dt[tt]=dt[En]=dt[pr]=!1;var ct={};ct[ue]=ct[te]=ct[k]=ct[z]=ct[j]=ct[Y]=ct[H]=ct[X]=ct[ce]=ct[Pe]=ct[Ze]=ct[ze]=ct[ot]=ct[St]=ct[qt]=ct[tt]=ct[En]=ct[Bn]=ct[Et]=ct[tn]=ct[ft]=ct[Se]=!0,ct[xe]=ct[He]=ct[pr]=!1;var hS={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},fS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},dS={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pS={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},gS=parseFloat,mS=parseInt,J0=typeof Ys=="object"&&Ys&&Ys.Object===Object&&Ys,vS=typeof self=="object"&&self&&self.Object===Object&&self,Gt=J0||vS||Function("return this")(),Ec=e&&!e.nodeType&&e,Ei=Ec&&!0&&n&&!n.nodeType&&n,Y0=Ei&&Ei.exports===Ec,Cc=Y0&&J0.process,qn=function(){try{var B=Ei&&Ei.require&&Ei.require("util").types;return B||Cc&&Cc.binding&&Cc.binding("util")}catch{}}(),Q0=qn&&qn.isArrayBuffer,X0=qn&&qn.isDate,eg=qn&&qn.isMap,tg=qn&&qn.isRegExp,ng=qn&&qn.isSet,rg=qn&&qn.isTypedArray;function An(B,V,G){switch(G.length){case 0:return B.call(V);case 1:return B.call(V,G[0]);case 2:return B.call(V,G[0],G[1]);case 3:return B.call(V,G[0],G[1],G[2])}return B.apply(V,G)}function _S(B,V,G,pe){for(var $e=-1,et=B==null?0:B.length;++$e<et;){var Ot=B[$e];V(pe,Ot,G(Ot),B)}return pe}function Gn(B,V){for(var G=-1,pe=B==null?0:B.length;++G<pe&&V(B[G],G,B)!==!1;);return B}function yS(B,V){for(var G=B==null?0:B.length;G--&&V(B[G],G,B)!==!1;);return B}function ig(B,V){for(var G=-1,pe=B==null?0:B.length;++G<pe;)if(!V(B[G],G,B))return!1;return!0}function Kr(B,V){for(var G=-1,pe=B==null?0:B.length,$e=0,et=[];++G<pe;){var Ot=B[G];V(Ot,G,B)&&(et[$e++]=Ot)}return et}function Ga(B,V){var G=B==null?0:B.length;return!!G&&oo(B,V,0)>-1}function Ac(B,V,G){for(var pe=-1,$e=B==null?0:B.length;++pe<$e;)if(G(V,B[pe]))return!0;return!1}function _t(B,V){for(var G=-1,pe=B==null?0:B.length,$e=Array(pe);++G<pe;)$e[G]=V(B[G],G,B);return $e}function Jr(B,V){for(var G=-1,pe=V.length,$e=B.length;++G<pe;)B[$e+G]=V[G];return B}function Ic(B,V,G,pe){var $e=-1,et=B==null?0:B.length;for(pe&&et&&(G=B[++$e]);++$e<et;)G=V(G,B[$e],$e,B);return G}function bS(B,V,G,pe){var $e=B==null?0:B.length;for(pe&&$e&&(G=B[--$e]);$e--;)G=V(G,B[$e],$e,B);return G}function Pc(B,V){for(var G=-1,pe=B==null?0:B.length;++G<pe;)if(V(B[G],G,B))return!0;return!1}var wS=kc("length");function xS(B){return B.split("")}function TS(B){return B.match(wc)||[]}function og(B,V,G){var pe;return G(B,function($e,et,Ot){if(V($e,et,Ot))return pe=et,!1}),pe}function Ha(B,V,G,pe){for(var $e=B.length,et=G+(pe?1:-1);pe?et--:++et<$e;)if(V(B[et],et,B))return et;return-1}function oo(B,V,G){return V===V?RS(B,V,G):Ha(B,sg,G)}function SS(B,V,G,pe){for(var $e=G-1,et=B.length;++$e<et;)if(pe(B[$e],V))return $e;return-1}function sg(B){return B!==B}function ag(B,V){var G=B==null?0:B.length;return G?Oc(B,V)/G:he}function kc(B){return function(V){return V==null?t:V[B]}}function $c(B){return function(V){return B==null?t:B[V]}}function ug(B,V,G,pe,$e){return $e(B,function(et,Ot,lt){G=pe?(pe=!1,et):V(G,et,Ot,lt)}),G}function MS(B,V){var G=B.length;for(B.sort(V);G--;)B[G]=B[G].value;return B}function Oc(B,V){for(var G,pe=-1,$e=B.length;++pe<$e;){var et=V(B[pe]);et!==t&&(G=G===t?et:G+et)}return G}function Nc(B,V){for(var G=-1,pe=Array(B);++G<B;)pe[G]=V(G);return pe}function ES(B,V){return _t(V,function(G){return[G,B[G]]})}function lg(B){return B&&B.slice(0,dg(B)+1).replace(Wr,"")}function In(B){return function(V){return B(V)}}function Rc(B,V){return _t(V,function(G){return B[G]})}function us(B,V){return B.has(V)}function cg(B,V){for(var G=-1,pe=B.length;++G<pe&&oo(V,B[G],0)>-1;);return G}function hg(B,V){for(var G=B.length;G--&&oo(V,B[G],0)>-1;);return G}function CS(B,V){for(var G=B.length,pe=0;G--;)B[G]===V&&++pe;return pe}var AS=$c(hS),IS=$c(fS);function PS(B){return"\\"+pS[B]}function kS(B,V){return B==null?t:B[V]}function so(B){return aS.test(B)}function $S(B){return uS.test(B)}function OS(B){for(var V,G=[];!(V=B.next()).done;)G.push(V.value);return G}function zc(B){var V=-1,G=Array(B.size);return B.forEach(function(pe,$e){G[++V]=[$e,pe]}),G}function fg(B,V){return function(G){return B(V(G))}}function Yr(B,V){for(var G=-1,pe=B.length,$e=0,et=[];++G<pe;){var Ot=B[G];(Ot===V||Ot===p)&&(B[G]=p,et[$e++]=G)}return et}function Wa(B){var V=-1,G=Array(B.size);return B.forEach(function(pe){G[++V]=pe}),G}function NS(B){var V=-1,G=Array(B.size);return B.forEach(function(pe){G[++V]=[pe,pe]}),G}function RS(B,V,G){for(var pe=G-1,$e=B.length;++pe<$e;)if(B[pe]===V)return pe;return-1}function zS(B,V,G){for(var pe=G+1;pe--;)if(B[pe]===V)return pe;return pe}function ao(B){return so(B)?LS(B):wS(B)}function Xn(B){return so(B)?BS(B):xS(B)}function dg(B){for(var V=B.length;V--&&za.test(B.charAt(V)););return V}var DS=$c(dS);function LS(B){for(var V=Mc.lastIndex=0;Mc.test(B);)++V;return V}function BS(B){return B.match(Mc)||[]}function FS(B){return B.match(sS)||[]}var US=function B(V){V=V==null?Gt:uo.defaults(Gt.Object(),V,uo.pick(Gt,lS));var G=V.Array,pe=V.Date,$e=V.Error,et=V.Function,Ot=V.Math,lt=V.Object,Dc=V.RegExp,ZS=V.String,Hn=V.TypeError,ja=G.prototype,qS=et.prototype,lo=lt.prototype,Va=V["__core-js_shared__"],Ka=qS.toString,rt=lo.hasOwnProperty,GS=0,pg=function(){var i=/[^.]+$/.exec(Va&&Va.keys&&Va.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),Ja=lo.toString,HS=Ka.call(lt),WS=Gt._,jS=Dc("^"+Ka.call(rt).replace(Fn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ya=Y0?V.Buffer:t,Qr=V.Symbol,Qa=V.Uint8Array,gg=Ya?Ya.allocUnsafe:t,Xa=fg(lt.getPrototypeOf,lt),mg=lt.create,vg=lo.propertyIsEnumerable,eu=ja.splice,_g=Qr?Qr.isConcatSpreadable:t,ls=Qr?Qr.iterator:t,Ci=Qr?Qr.toStringTag:t,tu=function(){try{var i=$i(lt,"defineProperty");return i({},"",{}),i}catch{}}(),VS=V.clearTimeout!==Gt.clearTimeout&&V.clearTimeout,KS=pe&&pe.now!==Gt.Date.now&&pe.now,JS=V.setTimeout!==Gt.setTimeout&&V.setTimeout,nu=Ot.ceil,ru=Ot.floor,Lc=lt.getOwnPropertySymbols,YS=Ya?Ya.isBuffer:t,yg=V.isFinite,QS=ja.join,XS=fg(lt.keys,lt),Nt=Ot.max,Vt=Ot.min,eM=pe.now,tM=V.parseInt,bg=Ot.random,nM=ja.reverse,Bc=$i(V,"DataView"),cs=$i(V,"Map"),Fc=$i(V,"Promise"),co=$i(V,"Set"),hs=$i(V,"WeakMap"),fs=$i(lt,"create"),iu=hs&&new hs,ho={},rM=Oi(Bc),iM=Oi(cs),oM=Oi(Fc),sM=Oi(co),aM=Oi(hs),ou=Qr?Qr.prototype:t,ds=ou?ou.valueOf:t,wg=ou?ou.toString:t;function w(i){if(Mt(i)&&!Oe(i)&&!(i instanceof je)){if(i instanceof Wn)return i;if(rt.call(i,"__wrapped__"))return xm(i)}return new Wn(i)}var fo=function(){function i(){}return function(s){if(!xt(s))return{};if(mg)return mg(s);i.prototype=s;var l=new i;return i.prototype=t,l}}();function su(){}function Wn(i,s){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=t}w.templateSettings={escape:Ji,evaluate:yi,interpolate:Gr,variable:"",imports:{_:w}},w.prototype=su.prototype,w.prototype.constructor=w,Wn.prototype=fo(su.prototype),Wn.prototype.constructor=Wn;function je(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function uM(){var i=new je(this.__wrapped__);return i.__actions__=gn(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=gn(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=gn(this.__views__),i}function lM(){if(this.__filtered__){var i=new je(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function cM(){var i=this.__wrapped__.value(),s=this.__dir__,l=Oe(i),d=s<0,v=l?i.length:0,M=xE(0,v,this.__views__),P=M.start,R=M.end,F=R-P,Q=d?R:P-1,ee=this.__iteratees__,re=ee.length,le=0,ye=Vt(F,this.__takeCount__);if(!l||!d&&v==F&&ye==F)return Hg(i,this.__actions__);var Ae=[];e:for(;F--&&le<ye;){Q+=s;for(var Fe=-1,Ie=i[Q];++Fe<re;){var We=ee[Fe],Ke=We.iteratee,$n=We.type,sn=Ke(Ie);if($n==ut)Ie=sn;else if(!sn){if($n==Ue)continue e;break e}}Ae[le++]=Ie}return Ae}je.prototype=fo(su.prototype),je.prototype.constructor=je;function Ai(i){var s=-1,l=i==null?0:i.length;for(this.clear();++s<l;){var d=i[s];this.set(d[0],d[1])}}function hM(){this.__data__=fs?fs(null):{},this.size=0}function fM(i){var s=this.has(i)&&delete this.__data__[i];return this.size-=s?1:0,s}function dM(i){var s=this.__data__;if(fs){var l=s[i];return l===c?t:l}return rt.call(s,i)?s[i]:t}function pM(i){var s=this.__data__;return fs?s[i]!==t:rt.call(s,i)}function gM(i,s){var l=this.__data__;return this.size+=this.has(i)?0:1,l[i]=fs&&s===t?c:s,this}Ai.prototype.clear=hM,Ai.prototype.delete=fM,Ai.prototype.get=dM,Ai.prototype.has=pM,Ai.prototype.set=gM;function yr(i){var s=-1,l=i==null?0:i.length;for(this.clear();++s<l;){var d=i[s];this.set(d[0],d[1])}}function mM(){this.__data__=[],this.size=0}function vM(i){var s=this.__data__,l=au(s,i);if(l<0)return!1;var d=s.length-1;return l==d?s.pop():eu.call(s,l,1),--this.size,!0}function _M(i){var s=this.__data__,l=au(s,i);return l<0?t:s[l][1]}function yM(i){return au(this.__data__,i)>-1}function bM(i,s){var l=this.__data__,d=au(l,i);return d<0?(++this.size,l.push([i,s])):l[d][1]=s,this}yr.prototype.clear=mM,yr.prototype.delete=vM,yr.prototype.get=_M,yr.prototype.has=yM,yr.prototype.set=bM;function br(i){var s=-1,l=i==null?0:i.length;for(this.clear();++s<l;){var d=i[s];this.set(d[0],d[1])}}function wM(){this.size=0,this.__data__={hash:new Ai,map:new(cs||yr),string:new Ai}}function xM(i){var s=yu(this,i).delete(i);return this.size-=s?1:0,s}function TM(i){return yu(this,i).get(i)}function SM(i){return yu(this,i).has(i)}function MM(i,s){var l=yu(this,i),d=l.size;return l.set(i,s),this.size+=l.size==d?0:1,this}br.prototype.clear=wM,br.prototype.delete=xM,br.prototype.get=TM,br.prototype.has=SM,br.prototype.set=MM;function Ii(i){var s=-1,l=i==null?0:i.length;for(this.__data__=new br;++s<l;)this.add(i[s])}function EM(i){return this.__data__.set(i,c),this}function CM(i){return this.__data__.has(i)}Ii.prototype.add=Ii.prototype.push=EM,Ii.prototype.has=CM;function er(i){var s=this.__data__=new yr(i);this.size=s.size}function AM(){this.__data__=new yr,this.size=0}function IM(i){var s=this.__data__,l=s.delete(i);return this.size=s.size,l}function PM(i){return this.__data__.get(i)}function kM(i){return this.__data__.has(i)}function $M(i,s){var l=this.__data__;if(l instanceof yr){var d=l.__data__;if(!cs||d.length<o-1)return d.push([i,s]),this.size=++l.size,this;l=this.__data__=new br(d)}return l.set(i,s),this.size=l.size,this}er.prototype.clear=AM,er.prototype.delete=IM,er.prototype.get=PM,er.prototype.has=kM,er.prototype.set=$M;function xg(i,s){var l=Oe(i),d=!l&&Ni(i),v=!l&&!d&&ri(i),M=!l&&!d&&!v&&vo(i),P=l||d||v||M,R=P?Nc(i.length,ZS):[],F=R.length;for(var Q in i)(s||rt.call(i,Q))&&!(P&&(Q=="length"||v&&(Q=="offset"||Q=="parent")||M&&(Q=="buffer"||Q=="byteLength"||Q=="byteOffset")||Sr(Q,F)))&&R.push(Q);return R}function Tg(i){var s=i.length;return s?i[Yc(0,s-1)]:t}function OM(i,s){return bu(gn(i),Pi(s,0,i.length))}function NM(i){return bu(gn(i))}function Uc(i,s,l){(l!==t&&!tr(i[s],l)||l===t&&!(s in i))&&wr(i,s,l)}function ps(i,s,l){var d=i[s];(!(rt.call(i,s)&&tr(d,l))||l===t&&!(s in i))&&wr(i,s,l)}function au(i,s){for(var l=i.length;l--;)if(tr(i[l][0],s))return l;return-1}function RM(i,s,l,d){return Xr(i,function(v,M,P){s(d,v,l(v),P)}),d}function Sg(i,s){return i&&ar(s,Ft(s),i)}function zM(i,s){return i&&ar(s,vn(s),i)}function wr(i,s,l){s=="__proto__"&&tu?tu(i,s,{configurable:!0,enumerable:!0,value:l,writable:!0}):i[s]=l}function Zc(i,s){for(var l=-1,d=s.length,v=G(d),M=i==null;++l<d;)v[l]=M?t:xh(i,s[l]);return v}function Pi(i,s,l){return i===i&&(l!==t&&(i=i<=l?i:l),s!==t&&(i=i>=s?i:s)),i}function jn(i,s,l,d,v,M){var P,R=s&g,F=s&m,Q=s&b;if(l&&(P=v?l(i,d,v,M):l(i)),P!==t)return P;if(!xt(i))return i;var ee=Oe(i);if(ee){if(P=SE(i),!R)return gn(i,P)}else{var re=Kt(i),le=re==He||re==Tt;if(ri(i))return Vg(i,R);if(re==St||re==ue||le&&!v){if(P=F||le?{}:dm(i),!R)return F?dE(i,zM(P,i)):fE(i,Sg(P,i))}else{if(!ct[re])return v?i:{};P=ME(i,re,R)}}M||(M=new er);var ye=M.get(i);if(ye)return ye;M.set(i,P),Zm(i)?i.forEach(function(Ie){P.add(jn(Ie,s,l,Ie,i,M))}):Fm(i)&&i.forEach(function(Ie,We){P.set(We,jn(Ie,s,l,We,i,M))});var Ae=Q?F?uh:ah:F?vn:Ft,Fe=ee?t:Ae(i);return Gn(Fe||i,function(Ie,We){Fe&&(We=Ie,Ie=i[We]),ps(P,We,jn(Ie,s,l,We,i,M))}),P}function DM(i){var s=Ft(i);return function(l){return Mg(l,i,s)}}function Mg(i,s,l){var d=l.length;if(i==null)return!d;for(i=lt(i);d--;){var v=l[d],M=s[v],P=i[v];if(P===t&&!(v in i)||!M(P))return!1}return!0}function Eg(i,s,l){if(typeof i!="function")throw new Hn(u);return ws(function(){i.apply(t,l)},s)}function gs(i,s,l,d){var v=-1,M=Ga,P=!0,R=i.length,F=[],Q=s.length;if(!R)return F;l&&(s=_t(s,In(l))),d?(M=Ac,P=!1):s.length>=o&&(M=us,P=!1,s=new Ii(s));e:for(;++v<R;){var ee=i[v],re=l==null?ee:l(ee);if(ee=d||ee!==0?ee:0,P&&re===re){for(var le=Q;le--;)if(s[le]===re)continue e;F.push(ee)}else M(s,re,d)||F.push(ee)}return F}var Xr=Xg(sr),Cg=Xg(Gc,!0);function LM(i,s){var l=!0;return Xr(i,function(d,v,M){return l=!!s(d,v,M),l}),l}function uu(i,s,l){for(var d=-1,v=i.length;++d<v;){var M=i[d],P=s(M);if(P!=null&&(R===t?P===P&&!kn(P):l(P,R)))var R=P,F=M}return F}function BM(i,s,l,d){var v=i.length;for(l=De(l),l<0&&(l=-l>v?0:v+l),d=d===t||d>v?v:De(d),d<0&&(d+=v),d=l>d?0:Gm(d);l<d;)i[l++]=s;return i}function Ag(i,s){var l=[];return Xr(i,function(d,v,M){s(d,v,M)&&l.push(d)}),l}function Ht(i,s,l,d,v){var M=-1,P=i.length;for(l||(l=CE),v||(v=[]);++M<P;){var R=i[M];s>0&&l(R)?s>1?Ht(R,s-1,l,d,v):Jr(v,R):d||(v[v.length]=R)}return v}var qc=em(),Ig=em(!0);function sr(i,s){return i&&qc(i,s,Ft)}function Gc(i,s){return i&&Ig(i,s,Ft)}function lu(i,s){return Kr(s,function(l){return Mr(i[l])})}function ki(i,s){s=ti(s,i);for(var l=0,d=s.length;i!=null&&l<d;)i=i[ur(s[l++])];return l&&l==d?i:t}function Pg(i,s,l){var d=s(i);return Oe(i)?d:Jr(d,l(i))}function rn(i){return i==null?i===t?es:Lt:Ci&&Ci in lt(i)?wE(i):NE(i)}function Hc(i,s){return i>s}function FM(i,s){return i!=null&&rt.call(i,s)}function UM(i,s){return i!=null&&s in lt(i)}function ZM(i,s,l){return i>=Vt(s,l)&&i<Nt(s,l)}function Wc(i,s,l){for(var d=l?Ac:Ga,v=i[0].length,M=i.length,P=M,R=G(M),F=1/0,Q=[];P--;){var ee=i[P];P&&s&&(ee=_t(ee,In(s))),F=Vt(ee.length,F),R[P]=!l&&(s||v>=120&&ee.length>=120)?new Ii(P&&ee):t}ee=i[0];var re=-1,le=R[0];e:for(;++re<v&&Q.length<F;){var ye=ee[re],Ae=s?s(ye):ye;if(ye=l||ye!==0?ye:0,!(le?us(le,Ae):d(Q,Ae,l))){for(P=M;--P;){var Fe=R[P];if(!(Fe?us(Fe,Ae):d(i[P],Ae,l)))continue e}le&&le.push(Ae),Q.push(ye)}}return Q}function qM(i,s,l,d){return sr(i,function(v,M,P){s(d,l(v),M,P)}),d}function ms(i,s,l){s=ti(s,i),i=vm(i,s);var d=i==null?i:i[ur(Kn(s))];return d==null?t:An(d,i,l)}function kg(i){return Mt(i)&&rn(i)==ue}function GM(i){return Mt(i)&&rn(i)==k}function HM(i){return Mt(i)&&rn(i)==Y}function vs(i,s,l,d,v){return i===s?!0:i==null||s==null||!Mt(i)&&!Mt(s)?i!==i&&s!==s:WM(i,s,l,d,vs,v)}function WM(i,s,l,d,v,M){var P=Oe(i),R=Oe(s),F=P?te:Kt(i),Q=R?te:Kt(s);F=F==ue?St:F,Q=Q==ue?St:Q;var ee=F==St,re=Q==St,le=F==Q;if(le&&ri(i)){if(!ri(s))return!1;P=!0,ee=!1}if(le&&!ee)return M||(M=new er),P||vo(i)?cm(i,s,l,d,v,M):yE(i,s,F,l,d,v,M);if(!(l&_)){var ye=ee&&rt.call(i,"__wrapped__"),Ae=re&&rt.call(s,"__wrapped__");if(ye||Ae){var Fe=ye?i.value():i,Ie=Ae?s.value():s;return M||(M=new er),v(Fe,Ie,l,d,M)}}return le?(M||(M=new er),bE(i,s,l,d,v,M)):!1}function jM(i){return Mt(i)&&Kt(i)==ze}function jc(i,s,l,d){var v=l.length,M=v,P=!d;if(i==null)return!M;for(i=lt(i);v--;){var R=l[v];if(P&&R[2]?R[1]!==i[R[0]]:!(R[0]in i))return!1}for(;++v<M;){R=l[v];var F=R[0],Q=i[F],ee=R[1];if(P&&R[2]){if(Q===t&&!(F in i))return!1}else{var re=new er;if(d)var le=d(Q,ee,F,i,s,re);if(!(le===t?vs(ee,Q,_|$,d,re):le))return!1}}return!0}function $g(i){if(!xt(i)||IE(i))return!1;var s=Mr(i)?jS:xi;return s.test(Oi(i))}function VM(i){return Mt(i)&&rn(i)==qt}function KM(i){return Mt(i)&&Kt(i)==tt}function JM(i){return Mt(i)&&Eu(i.length)&&!!dt[rn(i)]}function Og(i){return typeof i=="function"?i:i==null?_n:typeof i=="object"?Oe(i)?zg(i[0],i[1]):Rg(i):tv(i)}function Vc(i){if(!bs(i))return XS(i);var s=[];for(var l in lt(i))rt.call(i,l)&&l!="constructor"&&s.push(l);return s}function YM(i){if(!xt(i))return OE(i);var s=bs(i),l=[];for(var d in i)d=="constructor"&&(s||!rt.call(i,d))||l.push(d);return l}function Kc(i,s){return i<s}function Ng(i,s){var l=-1,d=mn(i)?G(i.length):[];return Xr(i,function(v,M,P){d[++l]=s(v,M,P)}),d}function Rg(i){var s=ch(i);return s.length==1&&s[0][2]?gm(s[0][0],s[0][1]):function(l){return l===i||jc(l,i,s)}}function zg(i,s){return fh(i)&&pm(s)?gm(ur(i),s):function(l){var d=xh(l,i);return d===t&&d===s?Th(l,i):vs(s,d,_|$)}}function cu(i,s,l,d,v){i!==s&&qc(s,function(M,P){if(v||(v=new er),xt(M))QM(i,s,P,l,cu,d,v);else{var R=d?d(ph(i,P),M,P+"",i,s,v):t;R===t&&(R=M),Uc(i,P,R)}},vn)}function QM(i,s,l,d,v,M,P){var R=ph(i,l),F=ph(s,l),Q=P.get(F);if(Q){Uc(i,l,Q);return}var ee=M?M(R,F,l+"",i,s,P):t,re=ee===t;if(re){var le=Oe(F),ye=!le&&ri(F),Ae=!le&&!ye&&vo(F);ee=F,le||ye||Ae?Oe(R)?ee=R:At(R)?ee=gn(R):ye?(re=!1,ee=Vg(F,!0)):Ae?(re=!1,ee=Kg(F,!0)):ee=[]:xs(F)||Ni(F)?(ee=R,Ni(R)?ee=Hm(R):(!xt(R)||Mr(R))&&(ee=dm(F))):re=!1}re&&(P.set(F,ee),v(ee,F,d,M,P),P.delete(F)),Uc(i,l,ee)}function Dg(i,s){var l=i.length;if(l)return s+=s<0?l:0,Sr(s,l)?i[s]:t}function Lg(i,s,l){s.length?s=_t(s,function(M){return Oe(M)?function(P){return ki(P,M.length===1?M[0]:M)}:M}):s=[_n];var d=-1;s=_t(s,In(Ce()));var v=Ng(i,function(M,P,R){var F=_t(s,function(Q){return Q(M)});return{criteria:F,index:++d,value:M}});return MS(v,function(M,P){return hE(M,P,l)})}function XM(i,s){return Bg(i,s,function(l,d){return Th(i,d)})}function Bg(i,s,l){for(var d=-1,v=s.length,M={};++d<v;){var P=s[d],R=ki(i,P);l(R,P)&&_s(M,ti(P,i),R)}return M}function eE(i){return function(s){return ki(s,i)}}function Jc(i,s,l,d){var v=d?SS:oo,M=-1,P=s.length,R=i;for(i===s&&(s=gn(s)),l&&(R=_t(i,In(l)));++M<P;)for(var F=0,Q=s[M],ee=l?l(Q):Q;(F=v(R,ee,F,d))>-1;)R!==i&&eu.call(R,F,1),eu.call(i,F,1);return i}function Fg(i,s){for(var l=i?s.length:0,d=l-1;l--;){var v=s[l];if(l==d||v!==M){var M=v;Sr(v)?eu.call(i,v,1):eh(i,v)}}return i}function Yc(i,s){return i+ru(bg()*(s-i+1))}function tE(i,s,l,d){for(var v=-1,M=Nt(nu((s-i)/(l||1)),0),P=G(M);M--;)P[d?M:++v]=i,i+=l;return P}function Qc(i,s){var l="";if(!i||s<1||s>ae)return l;do s%2&&(l+=i),s=ru(s/2),s&&(i+=i);while(s);return l}function qe(i,s){return gh(mm(i,s,_n),i+"")}function nE(i){return Tg(_o(i))}function rE(i,s){var l=_o(i);return bu(l,Pi(s,0,l.length))}function _s(i,s,l,d){if(!xt(i))return i;s=ti(s,i);for(var v=-1,M=s.length,P=M-1,R=i;R!=null&&++v<M;){var F=ur(s[v]),Q=l;if(F==="__proto__"||F==="constructor"||F==="prototype")return i;if(v!=P){var ee=R[F];Q=d?d(ee,F,R):t,Q===t&&(Q=xt(ee)?ee:Sr(s[v+1])?[]:{})}ps(R,F,Q),R=R[F]}return i}var Ug=iu?function(i,s){return iu.set(i,s),i}:_n,iE=tu?function(i,s){return tu(i,"toString",{configurable:!0,enumerable:!1,value:Mh(s),writable:!0})}:_n;function oE(i){return bu(_o(i))}function Vn(i,s,l){var d=-1,v=i.length;s<0&&(s=-s>v?0:v+s),l=l>v?v:l,l<0&&(l+=v),v=s>l?0:l-s>>>0,s>>>=0;for(var M=G(v);++d<v;)M[d]=i[d+s];return M}function sE(i,s){var l;return Xr(i,function(d,v,M){return l=s(d,v,M),!l}),!!l}function hu(i,s,l){var d=0,v=i==null?d:i.length;if(typeof s=="number"&&s===s&&v<=Le){for(;d<v;){var M=d+v>>>1,P=i[M];P!==null&&!kn(P)&&(l?P<=s:P<s)?d=M+1:v=M}return v}return Xc(i,s,_n,l)}function Xc(i,s,l,d){var v=0,M=i==null?0:i.length;if(M===0)return 0;s=l(s);for(var P=s!==s,R=s===null,F=kn(s),Q=s===t;v<M;){var ee=ru((v+M)/2),re=l(i[ee]),le=re!==t,ye=re===null,Ae=re===re,Fe=kn(re);if(P)var Ie=d||Ae;else Q?Ie=Ae&&(d||le):R?Ie=Ae&&le&&(d||!ye):F?Ie=Ae&&le&&!ye&&(d||!Fe):ye||Fe?Ie=!1:Ie=d?re<=s:re<s;Ie?v=ee+1:M=ee}return Vt(M,Te)}function Zg(i,s){for(var l=-1,d=i.length,v=0,M=[];++l<d;){var P=i[l],R=s?s(P):P;if(!l||!tr(R,F)){var F=R;M[v++]=P===0?0:P}}return M}function qg(i){return typeof i=="number"?i:kn(i)?he:+i}function Pn(i){if(typeof i=="string")return i;if(Oe(i))return _t(i,Pn)+"";if(kn(i))return wg?wg.call(i):"";var s=i+"";return s=="0"&&1/i==-ne?"-0":s}function ei(i,s,l){var d=-1,v=Ga,M=i.length,P=!0,R=[],F=R;if(l)P=!1,v=Ac;else if(M>=o){var Q=s?null:vE(i);if(Q)return Wa(Q);P=!1,v=us,F=new Ii}else F=s?[]:R;e:for(;++d<M;){var ee=i[d],re=s?s(ee):ee;if(ee=l||ee!==0?ee:0,P&&re===re){for(var le=F.length;le--;)if(F[le]===re)continue e;s&&F.push(re),R.push(ee)}else v(F,re,l)||(F!==R&&F.push(re),R.push(ee))}return R}function eh(i,s){return s=ti(s,i),i=vm(i,s),i==null||delete i[ur(Kn(s))]}function Gg(i,s,l,d){return _s(i,s,l(ki(i,s)),d)}function fu(i,s,l,d){for(var v=i.length,M=d?v:-1;(d?M--:++M<v)&&s(i[M],M,i););return l?Vn(i,d?0:M,d?M+1:v):Vn(i,d?M+1:0,d?v:M)}function Hg(i,s){var l=i;return l instanceof je&&(l=l.value()),Ic(s,function(d,v){return v.func.apply(v.thisArg,Jr([d],v.args))},l)}function th(i,s,l){var d=i.length;if(d<2)return d?ei(i[0]):[];for(var v=-1,M=G(d);++v<d;)for(var P=i[v],R=-1;++R<d;)R!=v&&(M[v]=gs(M[v]||P,i[R],s,l));return ei(Ht(M,1),s,l)}function Wg(i,s,l){for(var d=-1,v=i.length,M=s.length,P={};++d<v;){var R=d<M?s[d]:t;l(P,i[d],R)}return P}function nh(i){return At(i)?i:[]}function rh(i){return typeof i=="function"?i:_n}function ti(i,s){return Oe(i)?i:fh(i,s)?[i]:wm(nt(i))}var aE=qe;function ni(i,s,l){var d=i.length;return l=l===t?d:l,!s&&l>=d?i:Vn(i,s,l)}var jg=VS||function(i){return Gt.clearTimeout(i)};function Vg(i,s){if(s)return i.slice();var l=i.length,d=gg?gg(l):new i.constructor(l);return i.copy(d),d}function ih(i){var s=new i.constructor(i.byteLength);return new Qa(s).set(new Qa(i)),s}function uE(i,s){var l=s?ih(i.buffer):i.buffer;return new i.constructor(l,i.byteOffset,i.byteLength)}function lE(i){var s=new i.constructor(i.source,rs.exec(i));return s.lastIndex=i.lastIndex,s}function cE(i){return ds?lt(ds.call(i)):{}}function Kg(i,s){var l=s?ih(i.buffer):i.buffer;return new i.constructor(l,i.byteOffset,i.length)}function Jg(i,s){if(i!==s){var l=i!==t,d=i===null,v=i===i,M=kn(i),P=s!==t,R=s===null,F=s===s,Q=kn(s);if(!R&&!Q&&!M&&i>s||M&&P&&F&&!R&&!Q||d&&P&&F||!l&&F||!v)return 1;if(!d&&!M&&!Q&&i<s||Q&&l&&v&&!d&&!M||R&&l&&v||!P&&v||!F)return-1}return 0}function hE(i,s,l){for(var d=-1,v=i.criteria,M=s.criteria,P=v.length,R=l.length;++d<P;){var F=Jg(v[d],M[d]);if(F){if(d>=R)return F;var Q=l[d];return F*(Q=="desc"?-1:1)}}return i.index-s.index}function Yg(i,s,l,d){for(var v=-1,M=i.length,P=l.length,R=-1,F=s.length,Q=Nt(M-P,0),ee=G(F+Q),re=!d;++R<F;)ee[R]=s[R];for(;++v<P;)(re||v<M)&&(ee[l[v]]=i[v]);for(;Q--;)ee[R++]=i[v++];return ee}function Qg(i,s,l,d){for(var v=-1,M=i.length,P=-1,R=l.length,F=-1,Q=s.length,ee=Nt(M-R,0),re=G(ee+Q),le=!d;++v<ee;)re[v]=i[v];for(var ye=v;++F<Q;)re[ye+F]=s[F];for(;++P<R;)(le||v<M)&&(re[ye+l[P]]=i[v++]);return re}function gn(i,s){var l=-1,d=i.length;for(s||(s=G(d));++l<d;)s[l]=i[l];return s}function ar(i,s,l,d){var v=!l;l||(l={});for(var M=-1,P=s.length;++M<P;){var R=s[M],F=d?d(l[R],i[R],R,l,i):t;F===t&&(F=i[R]),v?wr(l,R,F):ps(l,R,F)}return l}function fE(i,s){return ar(i,hh(i),s)}function dE(i,s){return ar(i,hm(i),s)}function du(i,s){return function(l,d){var v=Oe(l)?_S:RM,M=s?s():{};return v(l,i,Ce(d,2),M)}}function po(i){return qe(function(s,l){var d=-1,v=l.length,M=v>1?l[v-1]:t,P=v>2?l[2]:t;for(M=i.length>3&&typeof M=="function"?(v--,M):t,P&&on(l[0],l[1],P)&&(M=v<3?t:M,v=1),s=lt(s);++d<v;){var R=l[d];R&&i(s,R,d,M)}return s})}function Xg(i,s){return function(l,d){if(l==null)return l;if(!mn(l))return i(l,d);for(var v=l.length,M=s?v:-1,P=lt(l);(s?M--:++M<v)&&d(P[M],M,P)!==!1;);return l}}function em(i){return function(s,l,d){for(var v=-1,M=lt(s),P=d(s),R=P.length;R--;){var F=P[i?R:++v];if(l(M[F],F,M)===!1)break}return s}}function pE(i,s,l){var d=s&C,v=ys(i);function M(){var P=this&&this!==Gt&&this instanceof M?v:i;return P.apply(d?l:this,arguments)}return M}function tm(i){return function(s){s=nt(s);var l=so(s)?Xn(s):t,d=l?l[0]:s.charAt(0),v=l?ni(l,1).join(""):s.slice(1);return d[i]()+v}}function go(i){return function(s){return Ic(Xm(Qm(s).replace(iS,"")),i,"")}}function ys(i){return function(){var s=arguments;switch(s.length){case 0:return new i;case 1:return new i(s[0]);case 2:return new i(s[0],s[1]);case 3:return new i(s[0],s[1],s[2]);case 4:return new i(s[0],s[1],s[2],s[3]);case 5:return new i(s[0],s[1],s[2],s[3],s[4]);case 6:return new i(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new i(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var l=fo(i.prototype),d=i.apply(l,s);return xt(d)?d:l}}function gE(i,s,l){var d=ys(i);function v(){for(var M=arguments.length,P=G(M),R=M,F=mo(v);R--;)P[R]=arguments[R];var Q=M<3&&P[0]!==F&&P[M-1]!==F?[]:Yr(P,F);if(M-=Q.length,M<l)return sm(i,s,pu,v.placeholder,t,P,Q,t,t,l-M);var ee=this&&this!==Gt&&this instanceof v?d:i;return An(ee,this,P)}return v}function nm(i){return function(s,l,d){var v=lt(s);if(!mn(s)){var M=Ce(l,3);s=Ft(s),l=function(R){return M(v[R],R,v)}}var P=i(s,l,d);return P>-1?v[M?s[P]:P]:t}}function rm(i){return Tr(function(s){var l=s.length,d=l,v=Wn.prototype.thru;for(i&&s.reverse();d--;){var M=s[d];if(typeof M!="function")throw new Hn(u);if(v&&!P&&_u(M)=="wrapper")var P=new Wn([],!0)}for(d=P?d:l;++d<l;){M=s[d];var R=_u(M),F=R=="wrapper"?lh(M):t;F&&dh(F[0])&&F[1]==(L|T|N|q)&&!F[4].length&&F[9]==1?P=P[_u(F[0])].apply(P,F[3]):P=M.length==1&&dh(M)?P[R]():P.thru(M)}return function(){var Q=arguments,ee=Q[0];if(P&&Q.length==1&&Oe(ee))return P.plant(ee).value();for(var re=0,le=l?s[re].apply(this,Q):ee;++re<l;)le=s[re].call(this,le);return le}})}function pu(i,s,l,d,v,M,P,R,F,Q){var ee=s&L,re=s&C,le=s&S,ye=s&(T|A),Ae=s&se,Fe=le?t:ys(i);function Ie(){for(var We=arguments.length,Ke=G(We),$n=We;$n--;)Ke[$n]=arguments[$n];if(ye)var sn=mo(Ie),On=CS(Ke,sn);if(d&&(Ke=Yg(Ke,d,v,ye)),M&&(Ke=Qg(Ke,M,P,ye)),We-=On,ye&&We<Q){var It=Yr(Ke,sn);return sm(i,s,pu,Ie.placeholder,l,Ke,It,R,F,Q-We)}var nr=re?l:this,Cr=le?nr[i]:i;return We=Ke.length,R?Ke=RE(Ke,R):Ae&&We>1&&Ke.reverse(),ee&&F<We&&(Ke.length=F),this&&this!==Gt&&this instanceof Ie&&(Cr=Fe||ys(Cr)),Cr.apply(nr,Ke)}return Ie}function im(i,s){return function(l,d){return qM(l,i,s(d),{})}}function gu(i,s){return function(l,d){var v;if(l===t&&d===t)return s;if(l!==t&&(v=l),d!==t){if(v===t)return d;typeof l=="string"||typeof d=="string"?(l=Pn(l),d=Pn(d)):(l=qg(l),d=qg(d)),v=i(l,d)}return v}}function oh(i){return Tr(function(s){return s=_t(s,In(Ce())),qe(function(l){var d=this;return i(s,function(v){return An(v,d,l)})})})}function mu(i,s){s=s===t?" ":Pn(s);var l=s.length;if(l<2)return l?Qc(s,i):s;var d=Qc(s,nu(i/ao(s)));return so(s)?ni(Xn(d),0,i).join(""):d.slice(0,i)}function mE(i,s,l,d){var v=s&C,M=ys(i);function P(){for(var R=-1,F=arguments.length,Q=-1,ee=d.length,re=G(ee+F),le=this&&this!==Gt&&this instanceof P?M:i;++Q<ee;)re[Q]=d[Q];for(;F--;)re[Q++]=arguments[++R];return An(le,v?l:this,re)}return P}function om(i){return function(s,l,d){return d&&typeof d!="number"&&on(s,l,d)&&(l=d=t),s=Er(s),l===t?(l=s,s=0):l=Er(l),d=d===t?s<l?1:-1:Er(d),tE(s,l,d,i)}}function vu(i){return function(s,l){return typeof s=="string"&&typeof l=="string"||(s=Jn(s),l=Jn(l)),i(s,l)}}function sm(i,s,l,d,v,M,P,R,F,Q){var ee=s&T,re=ee?P:t,le=ee?t:P,ye=ee?M:t,Ae=ee?t:M;s|=ee?N:D,s&=~(ee?D:N),s&I||(s&=-4);var Fe=[i,s,v,ye,re,Ae,le,R,F,Q],Ie=l.apply(t,Fe);return dh(i)&&_m(Ie,Fe),Ie.placeholder=d,ym(Ie,i,s)}function sh(i){var s=Ot[i];return function(l,d){if(l=Jn(l),d=d==null?0:Vt(De(d),292),d&&yg(l)){var v=(nt(l)+"e").split("e"),M=s(v[0]+"e"+(+v[1]+d));return v=(nt(M)+"e").split("e"),+(v[0]+"e"+(+v[1]-d))}return s(l)}}var vE=co&&1/Wa(new co([,-0]))[1]==ne?function(i){return new co(i)}:Ah;function am(i){return function(s){var l=Kt(s);return l==ze?zc(s):l==tt?NS(s):ES(s,i(s))}}function xr(i,s,l,d,v,M,P,R){var F=s&S;if(!F&&typeof i!="function")throw new Hn(u);var Q=d?d.length:0;if(Q||(s&=-97,d=v=t),P=P===t?P:Nt(De(P),0),R=R===t?R:De(R),Q-=v?v.length:0,s&D){var ee=d,re=v;d=v=t}var le=F?t:lh(i),ye=[i,s,l,d,v,ee,re,M,P,R];if(le&&$E(ye,le),i=ye[0],s=ye[1],l=ye[2],d=ye[3],v=ye[4],R=ye[9]=ye[9]===t?F?0:i.length:Nt(ye[9]-Q,0),!R&&s&(T|A)&&(s&=-25),!s||s==C)var Ae=pE(i,s,l);else s==T||s==A?Ae=gE(i,s,R):(s==N||s==(C|N))&&!v.length?Ae=mE(i,s,l,d):Ae=pu.apply(t,ye);var Fe=le?Ug:_m;return ym(Fe(Ae,ye),i,s)}function um(i,s,l,d){return i===t||tr(i,lo[l])&&!rt.call(d,l)?s:i}function lm(i,s,l,d,v,M){return xt(i)&&xt(s)&&(M.set(s,i),cu(i,s,t,lm,M),M.delete(s)),i}function _E(i){return xs(i)?t:i}function cm(i,s,l,d,v,M){var P=l&_,R=i.length,F=s.length;if(R!=F&&!(P&&F>R))return!1;var Q=M.get(i),ee=M.get(s);if(Q&&ee)return Q==s&&ee==i;var re=-1,le=!0,ye=l&$?new Ii:t;for(M.set(i,s),M.set(s,i);++re<R;){var Ae=i[re],Fe=s[re];if(d)var Ie=P?d(Fe,Ae,re,s,i,M):d(Ae,Fe,re,i,s,M);if(Ie!==t){if(Ie)continue;le=!1;break}if(ye){if(!Pc(s,function(We,Ke){if(!us(ye,Ke)&&(Ae===We||v(Ae,We,l,d,M)))return ye.push(Ke)})){le=!1;break}}else if(!(Ae===Fe||v(Ae,Fe,l,d,M))){le=!1;break}}return M.delete(i),M.delete(s),le}function yE(i,s,l,d,v,M,P){switch(l){case z:if(i.byteLength!=s.byteLength||i.byteOffset!=s.byteOffset)return!1;i=i.buffer,s=s.buffer;case k:return!(i.byteLength!=s.byteLength||!M(new Qa(i),new Qa(s)));case j:case Y:case ot:return tr(+i,+s);case xe:return i.name==s.name&&i.message==s.message;case qt:case En:return i==s+"";case ze:var R=zc;case tt:var F=d&_;if(R||(R=Wa),i.size!=s.size&&!F)return!1;var Q=P.get(i);if(Q)return Q==s;d|=$,P.set(i,s);var ee=cm(R(i),R(s),d,v,M,P);return P.delete(i),ee;case Bn:if(ds)return ds.call(i)==ds.call(s)}return!1}function bE(i,s,l,d,v,M){var P=l&_,R=ah(i),F=R.length,Q=ah(s),ee=Q.length;if(F!=ee&&!P)return!1;for(var re=F;re--;){var le=R[re];if(!(P?le in s:rt.call(s,le)))return!1}var ye=M.get(i),Ae=M.get(s);if(ye&&Ae)return ye==s&&Ae==i;var Fe=!0;M.set(i,s),M.set(s,i);for(var Ie=P;++re<F;){le=R[re];var We=i[le],Ke=s[le];if(d)var $n=P?d(Ke,We,le,s,i,M):d(We,Ke,le,i,s,M);if(!($n===t?We===Ke||v(We,Ke,l,d,M):$n)){Fe=!1;break}Ie||(Ie=le=="constructor")}if(Fe&&!Ie){var sn=i.constructor,On=s.constructor;sn!=On&&"constructor"in i&&"constructor"in s&&!(typeof sn=="function"&&sn instanceof sn&&typeof On=="function"&&On instanceof On)&&(Fe=!1)}return M.delete(i),M.delete(s),Fe}function Tr(i){return gh(mm(i,t,Mm),i+"")}function ah(i){return Pg(i,Ft,hh)}function uh(i){return Pg(i,vn,hm)}var lh=iu?function(i){return iu.get(i)}:Ah;function _u(i){for(var s=i.name+"",l=ho[s],d=rt.call(ho,s)?l.length:0;d--;){var v=l[d],M=v.func;if(M==null||M==i)return v.name}return s}function mo(i){var s=rt.call(w,"placeholder")?w:i;return s.placeholder}function Ce(){var i=w.iteratee||Eh;return i=i===Eh?Og:i,arguments.length?i(arguments[0],arguments[1]):i}function yu(i,s){var l=i.__data__;return AE(s)?l[typeof s=="string"?"string":"hash"]:l.map}function ch(i){for(var s=Ft(i),l=s.length;l--;){var d=s[l],v=i[d];s[l]=[d,v,pm(v)]}return s}function $i(i,s){var l=kS(i,s);return $g(l)?l:t}function wE(i){var s=rt.call(i,Ci),l=i[Ci];try{i[Ci]=t;var d=!0}catch{}var v=Ja.call(i);return d&&(s?i[Ci]=l:delete i[Ci]),v}var hh=Lc?function(i){return i==null?[]:(i=lt(i),Kr(Lc(i),function(s){return vg.call(i,s)}))}:Ih,hm=Lc?function(i){for(var s=[];i;)Jr(s,hh(i)),i=Xa(i);return s}:Ih,Kt=rn;(Bc&&Kt(new Bc(new ArrayBuffer(1)))!=z||cs&&Kt(new cs)!=ze||Fc&&Kt(Fc.resolve())!=Ln||co&&Kt(new co)!=tt||hs&&Kt(new hs)!=pr)&&(Kt=function(i){var s=rn(i),l=s==St?i.constructor:t,d=l?Oi(l):"";if(d)switch(d){case rM:return z;case iM:return ze;case oM:return Ln;case sM:return tt;case aM:return pr}return s});function xE(i,s,l){for(var d=-1,v=l.length;++d<v;){var M=l[d],P=M.size;switch(M.type){case"drop":i+=P;break;case"dropRight":s-=P;break;case"take":s=Vt(s,i+P);break;case"takeRight":i=Nt(i,s-P);break}}return{start:i,end:s}}function TE(i){var s=i.match(bc);return s?s[1].split(Da):[]}function fm(i,s,l){s=ti(s,i);for(var d=-1,v=s.length,M=!1;++d<v;){var P=ur(s[d]);if(!(M=i!=null&&l(i,P)))break;i=i[P]}return M||++d!=v?M:(v=i==null?0:i.length,!!v&&Eu(v)&&Sr(P,v)&&(Oe(i)||Ni(i)))}function SE(i){var s=i.length,l=new i.constructor(s);return s&&typeof i[0]=="string"&&rt.call(i,"index")&&(l.index=i.index,l.input=i.input),l}function dm(i){return typeof i.constructor=="function"&&!bs(i)?fo(Xa(i)):{}}function ME(i,s,l){var d=i.constructor;switch(s){case k:return ih(i);case j:case Y:return new d(+i);case z:return uE(i,l);case H:case X:case ce:case Pe:case Ze:case Et:case tn:case ft:case Se:return Kg(i,l);case ze:return new d;case ot:case En:return new d(i);case qt:return lE(i);case tt:return new d;case Bn:return cE(i)}}function EE(i,s){var l=s.length;if(!l)return i;var d=l-1;return s[d]=(l>1?"& ":"")+s[d],s=s.join(l>2?", ":" "),i.replace(ns,`{
/* [wrapped with `+s+`] */
`)}function CE(i){return Oe(i)||Ni(i)||!!(_g&&i&&i[_g])}function Sr(i,s){var l=typeof i;return s=s??ae,!!s&&(l=="number"||l!="symbol"&&Qi.test(i))&&i>-1&&i%1==0&&i<s}function on(i,s,l){if(!xt(l))return!1;var d=typeof s;return(d=="number"?mn(l)&&Sr(s,l.length):d=="string"&&s in l)?tr(l[s],i):!1}function fh(i,s){if(Oe(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||kn(i)?!0:wi.test(i)||!bi.test(i)||s!=null&&i in lt(s)}function AE(i){var s=typeof i;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?i!=="__proto__":i===null}function dh(i){var s=_u(i),l=w[s];if(typeof l!="function"||!(s in je.prototype))return!1;if(i===l)return!0;var d=lh(l);return!!d&&i===d[0]}function IE(i){return!!pg&&pg in i}var PE=Va?Mr:Ph;function bs(i){var s=i&&i.constructor,l=typeof s=="function"&&s.prototype||lo;return i===l}function pm(i){return i===i&&!xt(i)}function gm(i,s){return function(l){return l==null?!1:l[i]===s&&(s!==t||i in lt(l))}}function kE(i){var s=Su(i,function(d){return l.size===f&&l.clear(),d}),l=s.cache;return s}function $E(i,s){var l=i[1],d=s[1],v=l|d,M=v<(C|S|L),P=d==L&&l==T||d==L&&l==q&&i[7].length<=s[8]||d==(L|q)&&s[7].length<=s[8]&&l==T;if(!(M||P))return i;d&C&&(i[2]=s[2],v|=l&C?0:I);var R=s[3];if(R){var F=i[3];i[3]=F?Yg(F,R,s[4]):R,i[4]=F?Yr(i[3],p):s[4]}return R=s[5],R&&(F=i[5],i[5]=F?Qg(F,R,s[6]):R,i[6]=F?Yr(i[5],p):s[6]),R=s[7],R&&(i[7]=R),d&L&&(i[8]=i[8]==null?s[8]:Vt(i[8],s[8])),i[9]==null&&(i[9]=s[9]),i[0]=s[0],i[1]=v,i}function OE(i){var s=[];if(i!=null)for(var l in lt(i))s.push(l);return s}function NE(i){return Ja.call(i)}function mm(i,s,l){return s=Nt(s===t?i.length-1:s,0),function(){for(var d=arguments,v=-1,M=Nt(d.length-s,0),P=G(M);++v<M;)P[v]=d[s+v];v=-1;for(var R=G(s+1);++v<s;)R[v]=d[v];return R[s]=l(P),An(i,this,R)}}function vm(i,s){return s.length<2?i:ki(i,Vn(s,0,-1))}function RE(i,s){for(var l=i.length,d=Vt(s.length,l),v=gn(i);d--;){var M=s[d];i[d]=Sr(M,l)?v[M]:t}return i}function ph(i,s){if(!(s==="constructor"&&typeof i[s]=="function")&&s!="__proto__")return i[s]}var _m=bm(Ug),ws=JS||function(i,s){return Gt.setTimeout(i,s)},gh=bm(iE);function ym(i,s,l){var d=s+"";return gh(i,EE(d,zE(TE(d),l)))}function bm(i){var s=0,l=0;return function(){var d=eM(),v=Xe-(d-l);if(l=d,v>0){if(++s>=ge)return arguments[0]}else s=0;return i.apply(t,arguments)}}function bu(i,s){var l=-1,d=i.length,v=d-1;for(s=s===t?d:s;++l<s;){var M=Yc(l,v),P=i[M];i[M]=i[l],i[l]=P}return i.length=s,i}var wm=kE(function(i){var s=[];return i.charCodeAt(0)===46&&s.push(""),i.replace(Hr,function(l,d,v,M){s.push(v?M.replace(Ba,"$1"):d||l)}),s});function ur(i){if(typeof i=="string"||kn(i))return i;var s=i+"";return s=="0"&&1/i==-ne?"-0":s}function Oi(i){if(i!=null){try{return Ka.call(i)}catch{}try{return i+""}catch{}}return""}function zE(i,s){return Gn(Qe,function(l){var d="_."+l[0];s&l[1]&&!Ga(i,d)&&i.push(d)}),i.sort()}function xm(i){if(i instanceof je)return i.clone();var s=new Wn(i.__wrapped__,i.__chain__);return s.__actions__=gn(i.__actions__),s.__index__=i.__index__,s.__values__=i.__values__,s}function DE(i,s,l){(l?on(i,s,l):s===t)?s=1:s=Nt(De(s),0);var d=i==null?0:i.length;if(!d||s<1)return[];for(var v=0,M=0,P=G(nu(d/s));v<d;)P[M++]=Vn(i,v,v+=s);return P}function LE(i){for(var s=-1,l=i==null?0:i.length,d=0,v=[];++s<l;){var M=i[s];M&&(v[d++]=M)}return v}function BE(){var i=arguments.length;if(!i)return[];for(var s=G(i-1),l=arguments[0],d=i;d--;)s[d-1]=arguments[d];return Jr(Oe(l)?gn(l):[l],Ht(s,1))}var FE=qe(function(i,s){return At(i)?gs(i,Ht(s,1,At,!0)):[]}),UE=qe(function(i,s){var l=Kn(s);return At(l)&&(l=t),At(i)?gs(i,Ht(s,1,At,!0),Ce(l,2)):[]}),ZE=qe(function(i,s){var l=Kn(s);return At(l)&&(l=t),At(i)?gs(i,Ht(s,1,At,!0),t,l):[]});function qE(i,s,l){var d=i==null?0:i.length;return d?(s=l||s===t?1:De(s),Vn(i,s<0?0:s,d)):[]}function GE(i,s,l){var d=i==null?0:i.length;return d?(s=l||s===t?1:De(s),s=d-s,Vn(i,0,s<0?0:s)):[]}function HE(i,s){return i&&i.length?fu(i,Ce(s,3),!0,!0):[]}function WE(i,s){return i&&i.length?fu(i,Ce(s,3),!0):[]}function jE(i,s,l,d){var v=i==null?0:i.length;return v?(l&&typeof l!="number"&&on(i,s,l)&&(l=0,d=v),BM(i,s,l,d)):[]}function Tm(i,s,l){var d=i==null?0:i.length;if(!d)return-1;var v=l==null?0:De(l);return v<0&&(v=Nt(d+v,0)),Ha(i,Ce(s,3),v)}function Sm(i,s,l){var d=i==null?0:i.length;if(!d)return-1;var v=d-1;return l!==t&&(v=De(l),v=l<0?Nt(d+v,0):Vt(v,d-1)),Ha(i,Ce(s,3),v,!0)}function Mm(i){var s=i==null?0:i.length;return s?Ht(i,1):[]}function VE(i){var s=i==null?0:i.length;return s?Ht(i,ne):[]}function KE(i,s){var l=i==null?0:i.length;return l?(s=s===t?1:De(s),Ht(i,s)):[]}function JE(i){for(var s=-1,l=i==null?0:i.length,d={};++s<l;){var v=i[s];d[v[0]]=v[1]}return d}function Em(i){return i&&i.length?i[0]:t}function YE(i,s,l){var d=i==null?0:i.length;if(!d)return-1;var v=l==null?0:De(l);return v<0&&(v=Nt(d+v,0)),oo(i,s,v)}function QE(i){var s=i==null?0:i.length;return s?Vn(i,0,-1):[]}var XE=qe(function(i){var s=_t(i,nh);return s.length&&s[0]===i[0]?Wc(s):[]}),eC=qe(function(i){var s=Kn(i),l=_t(i,nh);return s===Kn(l)?s=t:l.pop(),l.length&&l[0]===i[0]?Wc(l,Ce(s,2)):[]}),tC=qe(function(i){var s=Kn(i),l=_t(i,nh);return s=typeof s=="function"?s:t,s&&l.pop(),l.length&&l[0]===i[0]?Wc(l,t,s):[]});function nC(i,s){return i==null?"":QS.call(i,s)}function Kn(i){var s=i==null?0:i.length;return s?i[s-1]:t}function rC(i,s,l){var d=i==null?0:i.length;if(!d)return-1;var v=d;return l!==t&&(v=De(l),v=v<0?Nt(d+v,0):Vt(v,d-1)),s===s?zS(i,s,v):Ha(i,sg,v,!0)}function iC(i,s){return i&&i.length?Dg(i,De(s)):t}var oC=qe(Cm);function Cm(i,s){return i&&i.length&&s&&s.length?Jc(i,s):i}function sC(i,s,l){return i&&i.length&&s&&s.length?Jc(i,s,Ce(l,2)):i}function aC(i,s,l){return i&&i.length&&s&&s.length?Jc(i,s,t,l):i}var uC=Tr(function(i,s){var l=i==null?0:i.length,d=Zc(i,s);return Fg(i,_t(s,function(v){return Sr(v,l)?+v:v}).sort(Jg)),d});function lC(i,s){var l=[];if(!(i&&i.length))return l;var d=-1,v=[],M=i.length;for(s=Ce(s,3);++d<M;){var P=i[d];s(P,d,i)&&(l.push(P),v.push(d))}return Fg(i,v),l}function mh(i){return i==null?i:nM.call(i)}function cC(i,s,l){var d=i==null?0:i.length;return d?(l&&typeof l!="number"&&on(i,s,l)?(s=0,l=d):(s=s==null?0:De(s),l=l===t?d:De(l)),Vn(i,s,l)):[]}function hC(i,s){return hu(i,s)}function fC(i,s,l){return Xc(i,s,Ce(l,2))}function dC(i,s){var l=i==null?0:i.length;if(l){var d=hu(i,s);if(d<l&&tr(i[d],s))return d}return-1}function pC(i,s){return hu(i,s,!0)}function gC(i,s,l){return Xc(i,s,Ce(l,2),!0)}function mC(i,s){var l=i==null?0:i.length;if(l){var d=hu(i,s,!0)-1;if(tr(i[d],s))return d}return-1}function vC(i){return i&&i.length?Zg(i):[]}function _C(i,s){return i&&i.length?Zg(i,Ce(s,2)):[]}function yC(i){var s=i==null?0:i.length;return s?Vn(i,1,s):[]}function bC(i,s,l){return i&&i.length?(s=l||s===t?1:De(s),Vn(i,0,s<0?0:s)):[]}function wC(i,s,l){var d=i==null?0:i.length;return d?(s=l||s===t?1:De(s),s=d-s,Vn(i,s<0?0:s,d)):[]}function xC(i,s){return i&&i.length?fu(i,Ce(s,3),!1,!0):[]}function TC(i,s){return i&&i.length?fu(i,Ce(s,3)):[]}var SC=qe(function(i){return ei(Ht(i,1,At,!0))}),MC=qe(function(i){var s=Kn(i);return At(s)&&(s=t),ei(Ht(i,1,At,!0),Ce(s,2))}),EC=qe(function(i){var s=Kn(i);return s=typeof s=="function"?s:t,ei(Ht(i,1,At,!0),t,s)});function CC(i){return i&&i.length?ei(i):[]}function AC(i,s){return i&&i.length?ei(i,Ce(s,2)):[]}function IC(i,s){return s=typeof s=="function"?s:t,i&&i.length?ei(i,t,s):[]}function vh(i){if(!(i&&i.length))return[];var s=0;return i=Kr(i,function(l){if(At(l))return s=Nt(l.length,s),!0}),Nc(s,function(l){return _t(i,kc(l))})}function Am(i,s){if(!(i&&i.length))return[];var l=vh(i);return s==null?l:_t(l,function(d){return An(s,t,d)})}var PC=qe(function(i,s){return At(i)?gs(i,s):[]}),kC=qe(function(i){return th(Kr(i,At))}),$C=qe(function(i){var s=Kn(i);return At(s)&&(s=t),th(Kr(i,At),Ce(s,2))}),OC=qe(function(i){var s=Kn(i);return s=typeof s=="function"?s:t,th(Kr(i,At),t,s)}),NC=qe(vh);function RC(i,s){return Wg(i||[],s||[],ps)}function zC(i,s){return Wg(i||[],s||[],_s)}var DC=qe(function(i){var s=i.length,l=s>1?i[s-1]:t;return l=typeof l=="function"?(i.pop(),l):t,Am(i,l)});function Im(i){var s=w(i);return s.__chain__=!0,s}function LC(i,s){return s(i),i}function wu(i,s){return s(i)}var BC=Tr(function(i){var s=i.length,l=s?i[0]:0,d=this.__wrapped__,v=function(M){return Zc(M,i)};return s>1||this.__actions__.length||!(d instanceof je)||!Sr(l)?this.thru(v):(d=d.slice(l,+l+(s?1:0)),d.__actions__.push({func:wu,args:[v],thisArg:t}),new Wn(d,this.__chain__).thru(function(M){return s&&!M.length&&M.push(t),M}))});function FC(){return Im(this)}function UC(){return new Wn(this.value(),this.__chain__)}function ZC(){this.__values__===t&&(this.__values__=qm(this.value()));var i=this.__index__>=this.__values__.length,s=i?t:this.__values__[this.__index__++];return{done:i,value:s}}function qC(){return this}function GC(i){for(var s,l=this;l instanceof su;){var d=xm(l);d.__index__=0,d.__values__=t,s?v.__wrapped__=d:s=d;var v=d;l=l.__wrapped__}return v.__wrapped__=i,s}function HC(){var i=this.__wrapped__;if(i instanceof je){var s=i;return this.__actions__.length&&(s=new je(this)),s=s.reverse(),s.__actions__.push({func:wu,args:[mh],thisArg:t}),new Wn(s,this.__chain__)}return this.thru(mh)}function WC(){return Hg(this.__wrapped__,this.__actions__)}var jC=du(function(i,s,l){rt.call(i,l)?++i[l]:wr(i,l,1)});function VC(i,s,l){var d=Oe(i)?ig:LM;return l&&on(i,s,l)&&(s=t),d(i,Ce(s,3))}function KC(i,s){var l=Oe(i)?Kr:Ag;return l(i,Ce(s,3))}var JC=nm(Tm),YC=nm(Sm);function QC(i,s){return Ht(xu(i,s),1)}function XC(i,s){return Ht(xu(i,s),ne)}function e3(i,s,l){return l=l===t?1:De(l),Ht(xu(i,s),l)}function Pm(i,s){var l=Oe(i)?Gn:Xr;return l(i,Ce(s,3))}function km(i,s){var l=Oe(i)?yS:Cg;return l(i,Ce(s,3))}var t3=du(function(i,s,l){rt.call(i,l)?i[l].push(s):wr(i,l,[s])});function n3(i,s,l,d){i=mn(i)?i:_o(i),l=l&&!d?De(l):0;var v=i.length;return l<0&&(l=Nt(v+l,0)),Cu(i)?l<=v&&i.indexOf(s,l)>-1:!!v&&oo(i,s,l)>-1}var r3=qe(function(i,s,l){var d=-1,v=typeof s=="function",M=mn(i)?G(i.length):[];return Xr(i,function(P){M[++d]=v?An(s,P,l):ms(P,s,l)}),M}),i3=du(function(i,s,l){wr(i,l,s)});function xu(i,s){var l=Oe(i)?_t:Ng;return l(i,Ce(s,3))}function o3(i,s,l,d){return i==null?[]:(Oe(s)||(s=s==null?[]:[s]),l=d?t:l,Oe(l)||(l=l==null?[]:[l]),Lg(i,s,l))}var s3=du(function(i,s,l){i[l?0:1].push(s)},function(){return[[],[]]});function a3(i,s,l){var d=Oe(i)?Ic:ug,v=arguments.length<3;return d(i,Ce(s,4),l,v,Xr)}function u3(i,s,l){var d=Oe(i)?bS:ug,v=arguments.length<3;return d(i,Ce(s,4),l,v,Cg)}function l3(i,s){var l=Oe(i)?Kr:Ag;return l(i,Mu(Ce(s,3)))}function c3(i){var s=Oe(i)?Tg:nE;return s(i)}function h3(i,s,l){(l?on(i,s,l):s===t)?s=1:s=De(s);var d=Oe(i)?OM:rE;return d(i,s)}function f3(i){var s=Oe(i)?NM:oE;return s(i)}function d3(i){if(i==null)return 0;if(mn(i))return Cu(i)?ao(i):i.length;var s=Kt(i);return s==ze||s==tt?i.size:Vc(i).length}function p3(i,s,l){var d=Oe(i)?Pc:sE;return l&&on(i,s,l)&&(s=t),d(i,Ce(s,3))}var g3=qe(function(i,s){if(i==null)return[];var l=s.length;return l>1&&on(i,s[0],s[1])?s=[]:l>2&&on(s[0],s[1],s[2])&&(s=[s[0]]),Lg(i,Ht(s,1),[])}),Tu=KS||function(){return Gt.Date.now()};function m3(i,s){if(typeof s!="function")throw new Hn(u);return i=De(i),function(){if(--i<1)return s.apply(this,arguments)}}function $m(i,s,l){return s=l?t:s,s=i&&s==null?i.length:s,xr(i,L,t,t,t,t,s)}function Om(i,s){var l;if(typeof s!="function")throw new Hn(u);return i=De(i),function(){return--i>0&&(l=s.apply(this,arguments)),i<=1&&(s=t),l}}var _h=qe(function(i,s,l){var d=C;if(l.length){var v=Yr(l,mo(_h));d|=N}return xr(i,d,s,l,v)}),Nm=qe(function(i,s,l){var d=C|S;if(l.length){var v=Yr(l,mo(Nm));d|=N}return xr(s,d,i,l,v)});function Rm(i,s,l){s=l?t:s;var d=xr(i,T,t,t,t,t,t,s);return d.placeholder=Rm.placeholder,d}function zm(i,s,l){s=l?t:s;var d=xr(i,A,t,t,t,t,t,s);return d.placeholder=zm.placeholder,d}function Dm(i,s,l){var d,v,M,P,R,F,Q=0,ee=!1,re=!1,le=!0;if(typeof i!="function")throw new Hn(u);s=Jn(s)||0,xt(l)&&(ee=!!l.leading,re="maxWait"in l,M=re?Nt(Jn(l.maxWait)||0,s):M,le="trailing"in l?!!l.trailing:le);function ye(It){var nr=d,Cr=v;return d=v=t,Q=It,P=i.apply(Cr,nr),P}function Ae(It){return Q=It,R=ws(We,s),ee?ye(It):P}function Fe(It){var nr=It-F,Cr=It-Q,nv=s-nr;return re?Vt(nv,M-Cr):nv}function Ie(It){var nr=It-F,Cr=It-Q;return F===t||nr>=s||nr<0||re&&Cr>=M}function We(){var It=Tu();if(Ie(It))return Ke(It);R=ws(We,Fe(It))}function Ke(It){return R=t,le&&d?ye(It):(d=v=t,P)}function $n(){R!==t&&jg(R),Q=0,d=F=v=R=t}function sn(){return R===t?P:Ke(Tu())}function On(){var It=Tu(),nr=Ie(It);if(d=arguments,v=this,F=It,nr){if(R===t)return Ae(F);if(re)return jg(R),R=ws(We,s),ye(F)}return R===t&&(R=ws(We,s)),P}return On.cancel=$n,On.flush=sn,On}var v3=qe(function(i,s){return Eg(i,1,s)}),_3=qe(function(i,s,l){return Eg(i,Jn(s)||0,l)});function y3(i){return xr(i,se)}function Su(i,s){if(typeof i!="function"||s!=null&&typeof s!="function")throw new Hn(u);var l=function(){var d=arguments,v=s?s.apply(this,d):d[0],M=l.cache;if(M.has(v))return M.get(v);var P=i.apply(this,d);return l.cache=M.set(v,P)||M,P};return l.cache=new(Su.Cache||br),l}Su.Cache=br;function Mu(i){if(typeof i!="function")throw new Hn(u);return function(){var s=arguments;switch(s.length){case 0:return!i.call(this);case 1:return!i.call(this,s[0]);case 2:return!i.call(this,s[0],s[1]);case 3:return!i.call(this,s[0],s[1],s[2])}return!i.apply(this,s)}}function b3(i){return Om(2,i)}var w3=aE(function(i,s){s=s.length==1&&Oe(s[0])?_t(s[0],In(Ce())):_t(Ht(s,1),In(Ce()));var l=s.length;return qe(function(d){for(var v=-1,M=Vt(d.length,l);++v<M;)d[v]=s[v].call(this,d[v]);return An(i,this,d)})}),yh=qe(function(i,s){var l=Yr(s,mo(yh));return xr(i,N,t,s,l)}),Lm=qe(function(i,s){var l=Yr(s,mo(Lm));return xr(i,D,t,s,l)}),x3=Tr(function(i,s){return xr(i,q,t,t,t,s)});function T3(i,s){if(typeof i!="function")throw new Hn(u);return s=s===t?s:De(s),qe(i,s)}function S3(i,s){if(typeof i!="function")throw new Hn(u);return s=s==null?0:Nt(De(s),0),qe(function(l){var d=l[s],v=ni(l,0,s);return d&&Jr(v,d),An(i,this,v)})}function M3(i,s,l){var d=!0,v=!0;if(typeof i!="function")throw new Hn(u);return xt(l)&&(d="leading"in l?!!l.leading:d,v="trailing"in l?!!l.trailing:v),Dm(i,s,{leading:d,maxWait:s,trailing:v})}function E3(i){return $m(i,1)}function C3(i,s){return yh(rh(s),i)}function A3(){if(!arguments.length)return[];var i=arguments[0];return Oe(i)?i:[i]}function I3(i){return jn(i,b)}function P3(i,s){return s=typeof s=="function"?s:t,jn(i,b,s)}function k3(i){return jn(i,g|b)}function $3(i,s){return s=typeof s=="function"?s:t,jn(i,g|b,s)}function O3(i,s){return s==null||Mg(i,s,Ft(s))}function tr(i,s){return i===s||i!==i&&s!==s}var N3=vu(Hc),R3=vu(function(i,s){return i>=s}),Ni=kg(function(){return arguments}())?kg:function(i){return Mt(i)&&rt.call(i,"callee")&&!vg.call(i,"callee")},Oe=G.isArray,z3=Q0?In(Q0):GM;function mn(i){return i!=null&&Eu(i.length)&&!Mr(i)}function At(i){return Mt(i)&&mn(i)}function D3(i){return i===!0||i===!1||Mt(i)&&rn(i)==j}var ri=YS||Ph,L3=X0?In(X0):HM;function B3(i){return Mt(i)&&i.nodeType===1&&!xs(i)}function F3(i){if(i==null)return!0;if(mn(i)&&(Oe(i)||typeof i=="string"||typeof i.splice=="function"||ri(i)||vo(i)||Ni(i)))return!i.length;var s=Kt(i);if(s==ze||s==tt)return!i.size;if(bs(i))return!Vc(i).length;for(var l in i)if(rt.call(i,l))return!1;return!0}function U3(i,s){return vs(i,s)}function Z3(i,s,l){l=typeof l=="function"?l:t;var d=l?l(i,s):t;return d===t?vs(i,s,t,l):!!d}function bh(i){if(!Mt(i))return!1;var s=rn(i);return s==xe||s==fe||typeof i.message=="string"&&typeof i.name=="string"&&!xs(i)}function q3(i){return typeof i=="number"&&yg(i)}function Mr(i){if(!xt(i))return!1;var s=rn(i);return s==He||s==Tt||s==U||s==Ee}function Bm(i){return typeof i=="number"&&i==De(i)}function Eu(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=ae}function xt(i){var s=typeof i;return i!=null&&(s=="object"||s=="function")}function Mt(i){return i!=null&&typeof i=="object"}var Fm=eg?In(eg):jM;function G3(i,s){return i===s||jc(i,s,ch(s))}function H3(i,s,l){return l=typeof l=="function"?l:t,jc(i,s,ch(s),l)}function W3(i){return Um(i)&&i!=+i}function j3(i){if(PE(i))throw new $e(a);return $g(i)}function V3(i){return i===null}function K3(i){return i==null}function Um(i){return typeof i=="number"||Mt(i)&&rn(i)==ot}function xs(i){if(!Mt(i)||rn(i)!=St)return!1;var s=Xa(i);if(s===null)return!0;var l=rt.call(s,"constructor")&&s.constructor;return typeof l=="function"&&l instanceof l&&Ka.call(l)==HS}var wh=tg?In(tg):VM;function J3(i){return Bm(i)&&i>=-ae&&i<=ae}var Zm=ng?In(ng):KM;function Cu(i){return typeof i=="string"||!Oe(i)&&Mt(i)&&rn(i)==En}function kn(i){return typeof i=="symbol"||Mt(i)&&rn(i)==Bn}var vo=rg?In(rg):JM;function Y3(i){return i===t}function Q3(i){return Mt(i)&&Kt(i)==pr}function X3(i){return Mt(i)&&rn(i)==x}var eA=vu(Kc),tA=vu(function(i,s){return i<=s});function qm(i){if(!i)return[];if(mn(i))return Cu(i)?Xn(i):gn(i);if(ls&&i[ls])return OS(i[ls]());var s=Kt(i),l=s==ze?zc:s==tt?Wa:_o;return l(i)}function Er(i){if(!i)return i===0?i:0;if(i=Jn(i),i===ne||i===-ne){var s=i<0?-1:1;return s*ie}return i===i?i:0}function De(i){var s=Er(i),l=s%1;return s===s?l?s-l:s:0}function Gm(i){return i?Pi(De(i),0,_e):0}function Jn(i){if(typeof i=="number")return i;if(kn(i))return he;if(xt(i)){var s=typeof i.valueOf=="function"?i.valueOf():i;i=xt(s)?s+"":s}if(typeof i!="string")return i===0?i:+i;i=lg(i);var l=mr.test(i);return l||Ti.test(i)?mS(i.slice(2),l?2:8):is.test(i)?he:+i}function Hm(i){return ar(i,vn(i))}function nA(i){return i?Pi(De(i),-ae,ae):i===0?i:0}function nt(i){return i==null?"":Pn(i)}var rA=po(function(i,s){if(bs(s)||mn(s)){ar(s,Ft(s),i);return}for(var l in s)rt.call(s,l)&&ps(i,l,s[l])}),Wm=po(function(i,s){ar(s,vn(s),i)}),Au=po(function(i,s,l,d){ar(s,vn(s),i,d)}),iA=po(function(i,s,l,d){ar(s,Ft(s),i,d)}),oA=Tr(Zc);function sA(i,s){var l=fo(i);return s==null?l:Sg(l,s)}var aA=qe(function(i,s){i=lt(i);var l=-1,d=s.length,v=d>2?s[2]:t;for(v&&on(s[0],s[1],v)&&(d=1);++l<d;)for(var M=s[l],P=vn(M),R=-1,F=P.length;++R<F;){var Q=P[R],ee=i[Q];(ee===t||tr(ee,lo[Q])&&!rt.call(i,Q))&&(i[Q]=M[Q])}return i}),uA=qe(function(i){return i.push(t,lm),An(jm,t,i)});function lA(i,s){return og(i,Ce(s,3),sr)}function cA(i,s){return og(i,Ce(s,3),Gc)}function hA(i,s){return i==null?i:qc(i,Ce(s,3),vn)}function fA(i,s){return i==null?i:Ig(i,Ce(s,3),vn)}function dA(i,s){return i&&sr(i,Ce(s,3))}function pA(i,s){return i&&Gc(i,Ce(s,3))}function gA(i){return i==null?[]:lu(i,Ft(i))}function mA(i){return i==null?[]:lu(i,vn(i))}function xh(i,s,l){var d=i==null?t:ki(i,s);return d===t?l:d}function vA(i,s){return i!=null&&fm(i,s,FM)}function Th(i,s){return i!=null&&fm(i,s,UM)}var _A=im(function(i,s,l){s!=null&&typeof s.toString!="function"&&(s=Ja.call(s)),i[s]=l},Mh(_n)),yA=im(function(i,s,l){s!=null&&typeof s.toString!="function"&&(s=Ja.call(s)),rt.call(i,s)?i[s].push(l):i[s]=[l]},Ce),bA=qe(ms);function Ft(i){return mn(i)?xg(i):Vc(i)}function vn(i){return mn(i)?xg(i,!0):YM(i)}function wA(i,s){var l={};return s=Ce(s,3),sr(i,function(d,v,M){wr(l,s(d,v,M),d)}),l}function xA(i,s){var l={};return s=Ce(s,3),sr(i,function(d,v,M){wr(l,v,s(d,v,M))}),l}var TA=po(function(i,s,l){cu(i,s,l)}),jm=po(function(i,s,l,d){cu(i,s,l,d)}),SA=Tr(function(i,s){var l={};if(i==null)return l;var d=!1;s=_t(s,function(M){return M=ti(M,i),d||(d=M.length>1),M}),ar(i,uh(i),l),d&&(l=jn(l,g|m|b,_E));for(var v=s.length;v--;)eh(l,s[v]);return l});function MA(i,s){return Vm(i,Mu(Ce(s)))}var EA=Tr(function(i,s){return i==null?{}:XM(i,s)});function Vm(i,s){if(i==null)return{};var l=_t(uh(i),function(d){return[d]});return s=Ce(s),Bg(i,l,function(d,v){return s(d,v[0])})}function CA(i,s,l){s=ti(s,i);var d=-1,v=s.length;for(v||(v=1,i=t);++d<v;){var M=i==null?t:i[ur(s[d])];M===t&&(d=v,M=l),i=Mr(M)?M.call(i):M}return i}function AA(i,s,l){return i==null?i:_s(i,s,l)}function IA(i,s,l,d){return d=typeof d=="function"?d:t,i==null?i:_s(i,s,l,d)}var Km=am(Ft),Jm=am(vn);function PA(i,s,l){var d=Oe(i),v=d||ri(i)||vo(i);if(s=Ce(s,4),l==null){var M=i&&i.constructor;v?l=d?new M:[]:xt(i)?l=Mr(M)?fo(Xa(i)):{}:l={}}return(v?Gn:sr)(i,function(P,R,F){return s(l,P,R,F)}),l}function kA(i,s){return i==null?!0:eh(i,s)}function $A(i,s,l){return i==null?i:Gg(i,s,rh(l))}function OA(i,s,l,d){return d=typeof d=="function"?d:t,i==null?i:Gg(i,s,rh(l),d)}function _o(i){return i==null?[]:Rc(i,Ft(i))}function NA(i){return i==null?[]:Rc(i,vn(i))}function RA(i,s,l){return l===t&&(l=s,s=t),l!==t&&(l=Jn(l),l=l===l?l:0),s!==t&&(s=Jn(s),s=s===s?s:0),Pi(Jn(i),s,l)}function zA(i,s,l){return s=Er(s),l===t?(l=s,s=0):l=Er(l),i=Jn(i),ZM(i,s,l)}function DA(i,s,l){if(l&&typeof l!="boolean"&&on(i,s,l)&&(s=l=t),l===t&&(typeof s=="boolean"?(l=s,s=t):typeof i=="boolean"&&(l=i,i=t)),i===t&&s===t?(i=0,s=1):(i=Er(i),s===t?(s=i,i=0):s=Er(s)),i>s){var d=i;i=s,s=d}if(l||i%1||s%1){var v=bg();return Vt(i+v*(s-i+gS("1e-"+((v+"").length-1))),s)}return Yc(i,s)}var LA=go(function(i,s,l){return s=s.toLowerCase(),i+(l?Ym(s):s)});function Ym(i){return Sh(nt(i).toLowerCase())}function Qm(i){return i=nt(i),i&&i.replace(os,AS).replace(oS,"")}function BA(i,s,l){i=nt(i),s=Pn(s);var d=i.length;l=l===t?d:Pi(De(l),0,d);var v=l;return l-=s.length,l>=0&&i.slice(l,v)==s}function FA(i){return i=nt(i),i&&nn.test(i)?i.replace(qr,IS):i}function UA(i){return i=nt(i),i&&Yi.test(i)?i.replace(Fn,"\\$&"):i}var ZA=go(function(i,s,l){return i+(l?"-":"")+s.toLowerCase()}),qA=go(function(i,s,l){return i+(l?" ":"")+s.toLowerCase()}),GA=tm("toLowerCase");function HA(i,s,l){i=nt(i),s=De(s);var d=s?ao(i):0;if(!s||d>=s)return i;var v=(s-d)/2;return mu(ru(v),l)+i+mu(nu(v),l)}function WA(i,s,l){i=nt(i),s=De(s);var d=s?ao(i):0;return s&&d<s?i+mu(s-d,l):i}function jA(i,s,l){i=nt(i),s=De(s);var d=s?ao(i):0;return s&&d<s?mu(s-d,l)+i:i}function VA(i,s,l){return l||s==null?s=0:s&&(s=+s),tM(nt(i).replace(Wr,""),s||0)}function KA(i,s,l){return(l?on(i,s,l):s===t)?s=1:s=De(s),Qc(nt(i),s)}function JA(){var i=arguments,s=nt(i[0]);return i.length<3?s:s.replace(i[1],i[2])}var YA=go(function(i,s,l){return i+(l?"_":"")+s.toLowerCase()});function QA(i,s,l){return l&&typeof l!="number"&&on(i,s,l)&&(s=l=t),l=l===t?_e:l>>>0,l?(i=nt(i),i&&(typeof s=="string"||s!=null&&!wh(s))&&(s=Pn(s),!s&&so(i))?ni(Xn(i),0,l):i.split(s,l)):[]}var XA=go(function(i,s,l){return i+(l?" ":"")+Sh(s)});function eI(i,s,l){return i=nt(i),l=l==null?0:Pi(De(l),0,i.length),s=Pn(s),i.slice(l,l+s.length)==s}function tI(i,s,l){var d=w.templateSettings;l&&on(i,s,l)&&(s=t),i=nt(i),s=Au({},s,d,um);var v=Au({},s.imports,d.imports,um),M=Ft(v),P=Rc(v,M),R,F,Q=0,ee=s.interpolate||Xi,re="__p += '",le=Dc((s.escape||Xi).source+"|"+ee.source+"|"+(ee===Gr?Fa:Xi).source+"|"+(s.evaluate||Xi).source+"|$","g"),ye="//# sourceURL="+(rt.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++cS+"]")+`
`;i.replace(le,function(Ie,We,Ke,$n,sn,On){return Ke||(Ke=$n),re+=i.slice(Q,On).replace(xc,PS),We&&(R=!0,re+=`' +
__e(`+We+`) +
'`),sn&&(F=!0,re+=`';
`+sn+`;
__p += '`),Ke&&(re+=`' +
((__t = (`+Ke+`)) == null ? '' : __t) +
'`),Q=On+Ie.length,Ie}),re+=`';
`;var Ae=rt.call(s,"variable")&&s.variable;if(!Ae)re=`with (obj) {
`+re+`
}
`;else if(La.test(Ae))throw new $e(h);re=(F?re.replace(jt,""):re).replace(ts,"$1").replace(_i,"$1;"),re="function("+(Ae||"obj")+`) {
`+(Ae?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(F?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+re+`return __p
}`;var Fe=ev(function(){return et(M,ye+"return "+re).apply(t,P)});if(Fe.source=re,bh(Fe))throw Fe;return Fe}function nI(i){return nt(i).toLowerCase()}function rI(i){return nt(i).toUpperCase()}function iI(i,s,l){if(i=nt(i),i&&(l||s===t))return lg(i);if(!i||!(s=Pn(s)))return i;var d=Xn(i),v=Xn(s),M=cg(d,v),P=hg(d,v)+1;return ni(d,M,P).join("")}function oI(i,s,l){if(i=nt(i),i&&(l||s===t))return i.slice(0,dg(i)+1);if(!i||!(s=Pn(s)))return i;var d=Xn(i),v=hg(d,Xn(s))+1;return ni(d,0,v).join("")}function sI(i,s,l){if(i=nt(i),i&&(l||s===t))return i.replace(Wr,"");if(!i||!(s=Pn(s)))return i;var d=Xn(i),v=cg(d,Xn(s));return ni(d,v).join("")}function aI(i,s){var l=we,d=me;if(xt(s)){var v="separator"in s?s.separator:v;l="length"in s?De(s.length):l,d="omission"in s?Pn(s.omission):d}i=nt(i);var M=i.length;if(so(i)){var P=Xn(i);M=P.length}if(l>=M)return i;var R=l-ao(d);if(R<1)return d;var F=P?ni(P,0,R).join(""):i.slice(0,R);if(v===t)return F+d;if(P&&(R+=F.length-R),wh(v)){if(i.slice(R).search(v)){var Q,ee=F;for(v.global||(v=Dc(v.source,nt(rs.exec(v))+"g")),v.lastIndex=0;Q=v.exec(ee);)var re=Q.index;F=F.slice(0,re===t?R:re)}}else if(i.indexOf(Pn(v),R)!=R){var le=F.lastIndexOf(v);le>-1&&(F=F.slice(0,le))}return F+d}function uI(i){return i=nt(i),i&&gr.test(i)?i.replace(Zr,DS):i}var lI=go(function(i,s,l){return i+(l?" ":"")+s.toUpperCase()}),Sh=tm("toUpperCase");function Xm(i,s,l){return i=nt(i),s=l?t:s,s===t?$S(i)?FS(i):TS(i):i.match(s)||[]}var ev=qe(function(i,s){try{return An(i,t,s)}catch(l){return bh(l)?l:new $e(l)}}),cI=Tr(function(i,s){return Gn(s,function(l){l=ur(l),wr(i,l,_h(i[l],i))}),i});function hI(i){var s=i==null?0:i.length,l=Ce();return i=s?_t(i,function(d){if(typeof d[1]!="function")throw new Hn(u);return[l(d[0]),d[1]]}):[],qe(function(d){for(var v=-1;++v<s;){var M=i[v];if(An(M[0],this,d))return An(M[1],this,d)}})}function fI(i){return DM(jn(i,g))}function Mh(i){return function(){return i}}function dI(i,s){return i==null||i!==i?s:i}var pI=rm(),gI=rm(!0);function _n(i){return i}function Eh(i){return Og(typeof i=="function"?i:jn(i,g))}function mI(i){return Rg(jn(i,g))}function vI(i,s){return zg(i,jn(s,g))}var _I=qe(function(i,s){return function(l){return ms(l,i,s)}}),yI=qe(function(i,s){return function(l){return ms(i,l,s)}});function Ch(i,s,l){var d=Ft(s),v=lu(s,d);l==null&&!(xt(s)&&(v.length||!d.length))&&(l=s,s=i,i=this,v=lu(s,Ft(s)));var M=!(xt(l)&&"chain"in l)||!!l.chain,P=Mr(i);return Gn(v,function(R){var F=s[R];i[R]=F,P&&(i.prototype[R]=function(){var Q=this.__chain__;if(M||Q){var ee=i(this.__wrapped__),re=ee.__actions__=gn(this.__actions__);return re.push({func:F,args:arguments,thisArg:i}),ee.__chain__=Q,ee}return F.apply(i,Jr([this.value()],arguments))})}),i}function bI(){return Gt._===this&&(Gt._=WS),this}function Ah(){}function wI(i){return i=De(i),qe(function(s){return Dg(s,i)})}var xI=oh(_t),TI=oh(ig),SI=oh(Pc);function tv(i){return fh(i)?kc(ur(i)):eE(i)}function MI(i){return function(s){return i==null?t:ki(i,s)}}var EI=om(),CI=om(!0);function Ih(){return[]}function Ph(){return!1}function AI(){return{}}function II(){return""}function PI(){return!0}function kI(i,s){if(i=De(i),i<1||i>ae)return[];var l=_e,d=Vt(i,_e);s=Ce(s),i-=_e;for(var v=Nc(d,s);++l<i;)s(l);return v}function $I(i){return Oe(i)?_t(i,ur):kn(i)?[i]:gn(wm(nt(i)))}function OI(i){var s=++GS;return nt(i)+s}var NI=gu(function(i,s){return i+s},0),RI=sh("ceil"),zI=gu(function(i,s){return i/s},1),DI=sh("floor");function LI(i){return i&&i.length?uu(i,_n,Hc):t}function BI(i,s){return i&&i.length?uu(i,Ce(s,2),Hc):t}function FI(i){return ag(i,_n)}function UI(i,s){return ag(i,Ce(s,2))}function ZI(i){return i&&i.length?uu(i,_n,Kc):t}function qI(i,s){return i&&i.length?uu(i,Ce(s,2),Kc):t}var GI=gu(function(i,s){return i*s},1),HI=sh("round"),WI=gu(function(i,s){return i-s},0);function jI(i){return i&&i.length?Oc(i,_n):0}function VI(i,s){return i&&i.length?Oc(i,Ce(s,2)):0}return w.after=m3,w.ary=$m,w.assign=rA,w.assignIn=Wm,w.assignInWith=Au,w.assignWith=iA,w.at=oA,w.before=Om,w.bind=_h,w.bindAll=cI,w.bindKey=Nm,w.castArray=A3,w.chain=Im,w.chunk=DE,w.compact=LE,w.concat=BE,w.cond=hI,w.conforms=fI,w.constant=Mh,w.countBy=jC,w.create=sA,w.curry=Rm,w.curryRight=zm,w.debounce=Dm,w.defaults=aA,w.defaultsDeep=uA,w.defer=v3,w.delay=_3,w.difference=FE,w.differenceBy=UE,w.differenceWith=ZE,w.drop=qE,w.dropRight=GE,w.dropRightWhile=HE,w.dropWhile=WE,w.fill=jE,w.filter=KC,w.flatMap=QC,w.flatMapDeep=XC,w.flatMapDepth=e3,w.flatten=Mm,w.flattenDeep=VE,w.flattenDepth=KE,w.flip=y3,w.flow=pI,w.flowRight=gI,w.fromPairs=JE,w.functions=gA,w.functionsIn=mA,w.groupBy=t3,w.initial=QE,w.intersection=XE,w.intersectionBy=eC,w.intersectionWith=tC,w.invert=_A,w.invertBy=yA,w.invokeMap=r3,w.iteratee=Eh,w.keyBy=i3,w.keys=Ft,w.keysIn=vn,w.map=xu,w.mapKeys=wA,w.mapValues=xA,w.matches=mI,w.matchesProperty=vI,w.memoize=Su,w.merge=TA,w.mergeWith=jm,w.method=_I,w.methodOf=yI,w.mixin=Ch,w.negate=Mu,w.nthArg=wI,w.omit=SA,w.omitBy=MA,w.once=b3,w.orderBy=o3,w.over=xI,w.overArgs=w3,w.overEvery=TI,w.overSome=SI,w.partial=yh,w.partialRight=Lm,w.partition=s3,w.pick=EA,w.pickBy=Vm,w.property=tv,w.propertyOf=MI,w.pull=oC,w.pullAll=Cm,w.pullAllBy=sC,w.pullAllWith=aC,w.pullAt=uC,w.range=EI,w.rangeRight=CI,w.rearg=x3,w.reject=l3,w.remove=lC,w.rest=T3,w.reverse=mh,w.sampleSize=h3,w.set=AA,w.setWith=IA,w.shuffle=f3,w.slice=cC,w.sortBy=g3,w.sortedUniq=vC,w.sortedUniqBy=_C,w.split=QA,w.spread=S3,w.tail=yC,w.take=bC,w.takeRight=wC,w.takeRightWhile=xC,w.takeWhile=TC,w.tap=LC,w.throttle=M3,w.thru=wu,w.toArray=qm,w.toPairs=Km,w.toPairsIn=Jm,w.toPath=$I,w.toPlainObject=Hm,w.transform=PA,w.unary=E3,w.union=SC,w.unionBy=MC,w.unionWith=EC,w.uniq=CC,w.uniqBy=AC,w.uniqWith=IC,w.unset=kA,w.unzip=vh,w.unzipWith=Am,w.update=$A,w.updateWith=OA,w.values=_o,w.valuesIn=NA,w.without=PC,w.words=Xm,w.wrap=C3,w.xor=kC,w.xorBy=$C,w.xorWith=OC,w.zip=NC,w.zipObject=RC,w.zipObjectDeep=zC,w.zipWith=DC,w.entries=Km,w.entriesIn=Jm,w.extend=Wm,w.extendWith=Au,Ch(w,w),w.add=NI,w.attempt=ev,w.camelCase=LA,w.capitalize=Ym,w.ceil=RI,w.clamp=RA,w.clone=I3,w.cloneDeep=k3,w.cloneDeepWith=$3,w.cloneWith=P3,w.conformsTo=O3,w.deburr=Qm,w.defaultTo=dI,w.divide=zI,w.endsWith=BA,w.eq=tr,w.escape=FA,w.escapeRegExp=UA,w.every=VC,w.find=JC,w.findIndex=Tm,w.findKey=lA,w.findLast=YC,w.findLastIndex=Sm,w.findLastKey=cA,w.floor=DI,w.forEach=Pm,w.forEachRight=km,w.forIn=hA,w.forInRight=fA,w.forOwn=dA,w.forOwnRight=pA,w.get=xh,w.gt=N3,w.gte=R3,w.has=vA,w.hasIn=Th,w.head=Em,w.identity=_n,w.includes=n3,w.indexOf=YE,w.inRange=zA,w.invoke=bA,w.isArguments=Ni,w.isArray=Oe,w.isArrayBuffer=z3,w.isArrayLike=mn,w.isArrayLikeObject=At,w.isBoolean=D3,w.isBuffer=ri,w.isDate=L3,w.isElement=B3,w.isEmpty=F3,w.isEqual=U3,w.isEqualWith=Z3,w.isError=bh,w.isFinite=q3,w.isFunction=Mr,w.isInteger=Bm,w.isLength=Eu,w.isMap=Fm,w.isMatch=G3,w.isMatchWith=H3,w.isNaN=W3,w.isNative=j3,w.isNil=K3,w.isNull=V3,w.isNumber=Um,w.isObject=xt,w.isObjectLike=Mt,w.isPlainObject=xs,w.isRegExp=wh,w.isSafeInteger=J3,w.isSet=Zm,w.isString=Cu,w.isSymbol=kn,w.isTypedArray=vo,w.isUndefined=Y3,w.isWeakMap=Q3,w.isWeakSet=X3,w.join=nC,w.kebabCase=ZA,w.last=Kn,w.lastIndexOf=rC,w.lowerCase=qA,w.lowerFirst=GA,w.lt=eA,w.lte=tA,w.max=LI,w.maxBy=BI,w.mean=FI,w.meanBy=UI,w.min=ZI,w.minBy=qI,w.stubArray=Ih,w.stubFalse=Ph,w.stubObject=AI,w.stubString=II,w.stubTrue=PI,w.multiply=GI,w.nth=iC,w.noConflict=bI,w.noop=Ah,w.now=Tu,w.pad=HA,w.padEnd=WA,w.padStart=jA,w.parseInt=VA,w.random=DA,w.reduce=a3,w.reduceRight=u3,w.repeat=KA,w.replace=JA,w.result=CA,w.round=HI,w.runInContext=B,w.sample=c3,w.size=d3,w.snakeCase=YA,w.some=p3,w.sortedIndex=hC,w.sortedIndexBy=fC,w.sortedIndexOf=dC,w.sortedLastIndex=pC,w.sortedLastIndexBy=gC,w.sortedLastIndexOf=mC,w.startCase=XA,w.startsWith=eI,w.subtract=WI,w.sum=jI,w.sumBy=VI,w.template=tI,w.times=kI,w.toFinite=Er,w.toInteger=De,w.toLength=Gm,w.toLower=nI,w.toNumber=Jn,w.toSafeInteger=nA,w.toString=nt,w.toUpper=rI,w.trim=iI,w.trimEnd=oI,w.trimStart=sI,w.truncate=aI,w.unescape=uI,w.uniqueId=OI,w.upperCase=lI,w.upperFirst=Sh,w.each=Pm,w.eachRight=km,w.first=Em,Ch(w,function(){var i={};return sr(w,function(s,l){rt.call(w.prototype,l)||(i[l]=s)}),i}(),{chain:!1}),w.VERSION=r,Gn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){w[i].placeholder=w}),Gn(["drop","take"],function(i,s){je.prototype[i]=function(l){l=l===t?1:Nt(De(l),0);var d=this.__filtered__&&!s?new je(this):this.clone();return d.__filtered__?d.__takeCount__=Vt(l,d.__takeCount__):d.__views__.push({size:Vt(l,_e),type:i+(d.__dir__<0?"Right":"")}),d},je.prototype[i+"Right"]=function(l){return this.reverse()[i](l).reverse()}}),Gn(["filter","map","takeWhile"],function(i,s){var l=s+1,d=l==Ue||l==Ve;je.prototype[i]=function(v){var M=this.clone();return M.__iteratees__.push({iteratee:Ce(v,3),type:l}),M.__filtered__=M.__filtered__||d,M}}),Gn(["head","last"],function(i,s){var l="take"+(s?"Right":"");je.prototype[i]=function(){return this[l](1).value()[0]}}),Gn(["initial","tail"],function(i,s){var l="drop"+(s?"":"Right");je.prototype[i]=function(){return this.__filtered__?new je(this):this[l](1)}}),je.prototype.compact=function(){return this.filter(_n)},je.prototype.find=function(i){return this.filter(i).head()},je.prototype.findLast=function(i){return this.reverse().find(i)},je.prototype.invokeMap=qe(function(i,s){return typeof i=="function"?new je(this):this.map(function(l){return ms(l,i,s)})}),je.prototype.reject=function(i){return this.filter(Mu(Ce(i)))},je.prototype.slice=function(i,s){i=De(i);var l=this;return l.__filtered__&&(i>0||s<0)?new je(l):(i<0?l=l.takeRight(-i):i&&(l=l.drop(i)),s!==t&&(s=De(s),l=s<0?l.dropRight(-s):l.take(s-i)),l)},je.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},je.prototype.toArray=function(){return this.take(_e)},sr(je.prototype,function(i,s){var l=/^(?:filter|find|map|reject)|While$/.test(s),d=/^(?:head|last)$/.test(s),v=w[d?"take"+(s=="last"?"Right":""):s],M=d||/^find/.test(s);v&&(w.prototype[s]=function(){var P=this.__wrapped__,R=d?[1]:arguments,F=P instanceof je,Q=R[0],ee=F||Oe(P),re=function(We){var Ke=v.apply(w,Jr([We],R));return d&&le?Ke[0]:Ke};ee&&l&&typeof Q=="function"&&Q.length!=1&&(F=ee=!1);var le=this.__chain__,ye=!!this.__actions__.length,Ae=M&&!le,Fe=F&&!ye;if(!M&&ee){P=Fe?P:new je(this);var Ie=i.apply(P,R);return Ie.__actions__.push({func:wu,args:[re],thisArg:t}),new Wn(Ie,le)}return Ae&&Fe?i.apply(this,R):(Ie=this.thru(re),Ae?d?Ie.value()[0]:Ie.value():Ie)})}),Gn(["pop","push","shift","sort","splice","unshift"],function(i){var s=ja[i],l=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",d=/^(?:pop|shift)$/.test(i);w.prototype[i]=function(){var v=arguments;if(d&&!this.__chain__){var M=this.value();return s.apply(Oe(M)?M:[],v)}return this[l](function(P){return s.apply(Oe(P)?P:[],v)})}}),sr(je.prototype,function(i,s){var l=w[s];if(l){var d=l.name+"";rt.call(ho,d)||(ho[d]=[]),ho[d].push({name:s,func:l})}}),ho[pu(t,S).name]=[{name:"wrapper",func:t}],je.prototype.clone=uM,je.prototype.reverse=lM,je.prototype.value=cM,w.prototype.at=BC,w.prototype.chain=FC,w.prototype.commit=UC,w.prototype.next=ZC,w.prototype.plant=GC,w.prototype.reverse=HC,w.prototype.toJSON=w.prototype.valueOf=w.prototype.value=WC,w.prototype.first=w.prototype.head,ls&&(w.prototype[ls]=qC),w},uo=US();Ei?((Ei.exports=uo)._=uo,Ec._=uo):Gt._=uo}).call(Lw)}(Ro,Ro.exports)),Ro.exports}var Nn=Bw();const Fw=No(Nn);class Uw{constructor(e,t,r){if(this.inputs=e,this.output=t,typeof r=="function"){const o=r.toString(),a=/[^{]+(\{[\s\S]*\})/.exec(o);if(!(a!=null&&a[1]))throw new Error("couldn't get function body from expression");r=a[1]}this.expr=r,this.exprFn=Function(r)}run(e,t){const r=this.inputs.map(a=>Nn.get(e,a));let o=this.exprFn(...r);t&&(o=t.parse(o)),Nn.set(e,this.output,o)}}const vi=class vi{constructor(e){Iu(this,Qo);Iu(this,Xo);this.config=e,this.layers=e.layers,Nh(this,Qo,Ks.parse({})),Nh(this,Xo,_l.parse({})),this.config.graph.addDefaultStyle&&this.layers.unshift({node:{selector:"",style:Ks.parse(yw)},edge:{selector:"",style:_l.parse(vw)}})}static fromJson(e){const t=JSON.parse(e);return this.fromObject(t)}static fromObject(e){const t=gp.parse(e);return new vi(t)}static async fromUrl(e){const t=await fetch(e);if(!t.body)throw new Error("JSON response had no body");const r=await t.json();return vi.fromObject(r)}static default(){return vi.fromObject({graphtyTemplate:!0,majorVersion:"1"})}addLayer(e){this.layers.push(e)}insertLayer(e,t){this.layers.splice(e,0,t)}getStyleForNode(e){const t=[];for(const o of this.layers){const{node:a}=o;Tp(a,e)&&(a!=null&&a.style)&&t.unshift(a.style)}const r=Nn.defaultsDeep({},...t,Oh(this,Qo));return t.length===0&&(r.enabled=!1),vi.getNodeIdForStyle(r)}getCalculatedStylesForNode(e){const t=[];for(const r of this.layers){const{node:o}=r;if(Tp(o,e)&&(o!=null&&o.calculatedStyle)){const{inputs:u,output:h,expr:c}=o.calculatedStyle,f=new Uw(u,h,c);t.unshift(f)}}return t}getStyleForEdge(e){const t=[];for(const o of this.layers){const{edge:a}=o;let u=(a==null?void 0:a.selector)!==void 0&&a.selector.length===0;if(!u){const h=zr.search(e,`[${a==null?void 0:a.selector}]`);Array.isArray(h)&&typeof h[0]=="boolean"&&(u=h[0])}u&&(a!=null&&a.style)&&t.unshift(a.style)}const r=Nn.defaultsDeep({},...t,Oh(this,Xo));return t.length===0&&(r.enabled=!1),vi.getEdgeIdForStyle(r)}static getStyleForNodeStyleId(e){const t=bp.get(e);if(!t)throw new TypeError(`couldn't find NodeStyleId: ${e}`);return t}static getStyleForEdgeStyleId(e){const t=wp.get(e);if(!t)throw new TypeError(`couldn't find NodeStyleId: ${e}`);return t}static getNodeIdForStyle(e){return xp(bp,e)}static getEdgeIdForStyle(e){return xp(wp,e)}};Qo=new WeakMap,Xo=new WeakMap;let xn=vi;const bp=new Map,wp=new Map;function xp(n,e){let t;for(const[r,o]of n.entries())if(Nn.isEqual(o,e)){t=r;break}return t===void 0&&(t=n.size,n.set(t,e)),t}function Tp(n,e){if(!n)return!1;let t=n.selector.length===0;if(!t){const r=zr.search(e,`[${n.selector}]`);Array.isArray(r)&&typeof r[0]=="boolean"&&(t=r[0])}return t}class Rn{constructor(e,t,r,o,a,u={}){var p;this.arrowMesh=null,this.label=null,this.parentGraph=e,this.srcId=t,this.dstId=r,this.id=`${t}:${r}`,this.data=a,this.opts=u;const h=e.nodeCache.get(t);if(!h)throw new Error(`Attempting to create edge '${t}->${r}', Node '${t}' hasn't been created yet.`);const c=e.nodeCache.get(r);if(!c)throw new Error(`Attempting to create edge '${t}->${r}', Node '${r}' hasn't been created yet.`);this.srcNode=h,this.dstNode=c,this.ray=new W.Ray(this.srcNode.mesh.position,this.dstNode.mesh.position),this.styleId=o,this.parentGraph.layoutEngine.addEdge(this),this.mesh=Rn.defaultEdgeMeshFactory(this,this.parentGraph,this.styleId);const f=xn.getStyleForEdgeStyleId(this.styleId);(p=f.label)!=null&&p.enabled&&(this.label=Rn.createLabel(this,f))}update(){const e=this.parentGraph.layoutEngine.getEdgePosition(this),{srcPoint:t,dstPoint:r}=this.transformArrowCap();if(t&&r?this.transformEdgeMesh(t,r):this.transformEdgeMesh(new W.Vector3(e.src.x,e.src.y,e.src.z),new W.Vector3(e.dst.x,e.dst.y,e.dst.z)),this.label){const o=new W.Vector3((e.src.x+e.dst.x)/2,(e.src.y+e.dst.y)/2,((e.src.z??0)+(e.dst.z??0))/2);this.label.attachTo(o,"center",0)}}updateStyle(e){var r;if(e===this.styleId)return;this.styleId=e,this.mesh.dispose(),this.mesh=Rn.defaultEdgeMeshFactory(this,this.parentGraph,e);const t=xn.getStyleForEdgeStyleId(e);(r=t.label)!=null&&r.enabled?(this.label&&this.label.dispose(),this.label=Rn.createLabel(this,t)):this.label&&(this.label.dispose(),this.label=null)}static updateRays(e){var t;if(e.needRays){for(const r of e.layoutEngine.edges){const o=r.srcNode.mesh,a=r.dstNode.mesh,u=xn.getStyleForEdgeStyleId(r.styleId);((t=u.arrowHead)==null?void 0:t.type)===void 0||u.arrowHead.type==="none"||(r.ray.position=a.position,r.ray.direction=a.position.subtract(o.position))}e.scene.render()}}static defaultEdgeMeshFactory(e,t,r){const o=xn.getStyleForEdgeStyleId(r);o.arrowHead&&o.arrowHead.type!=="none"&&(e.arrowMesh=t.meshCache.get(`edge-arrowhead-style-${r}`,()=>{var f,p,g;const u=Zw(((f=o.line)==null?void 0:f.width)??.25),h=Sp(((p=o.line)==null?void 0:p.width)??.25),c=W.GreasedLineTools.GetArrowCap(new W.Vector3(0,0,-h),new W.Vector3(0,0,1),h,u,u);return W.CreateGreasedLine("lines",{points:c.points,widths:c.widths,widthDistribution:W.GreasedLineMeshWidthDistribution.WIDTH_DISTRIBUTION_START},{color:W.Color3.FromHexString(((g=o.line)==null?void 0:g.color)??"#FFFFFF")})}));const a=t.meshCache.get(`edge-style-${r}`,()=>{var u;return(u=o.line)!=null&&u.animationSpeed?Rn.createMovingLine(e,t,o):Rn.createPlainLine(e,t,o)});return a.isPickable=!1,a.metadata={},a.metadata.parentEdge=this,a}static createPlainLine(e,t,r){var o,a;return W.CreateGreasedLine("edge-plain",{points:Rn.unitVectorPoints},{color:W.Color3.FromHexString(((o=r.line)==null?void 0:o.color)??"#FFFFFF"),width:((a=r.line)==null?void 0:a.width)??.25})}static createMovingLine(e,t,r){var C,S;const o=W.Color3.FromHexString("#D3D3D3"),a=W.Color3.FromHexString(((C=r.line)==null?void 0:C.color)??"#FF0000"),u=Math.floor(o.r*255),h=Math.floor(o.g*255),c=Math.floor(o.b*255),f=Math.floor(a.r*255),p=Math.floor(a.g*255),g=Math.floor(a.b*255),m=new Uint8Array([u,h,c,f,p,g]),b=new W.RawTexture(m,m.length/3,1,W.Engine.TEXTUREFORMAT_RGB,t.scene,!1,!0,W.Engine.TEXTURE_NEAREST_NEAREST);b.wrapU=W.RawTexture.WRAP_ADDRESSMODE,b.name="moving-texture";const _=W.CreateGreasedLine("edge-moving",{points:Rn.unitVectorPoints},{width:((S=r.line)==null?void 0:S.width)??.25,colorMode:W.GreasedLineMeshColorMode.COLOR_MODE_MULTIPLY}),$=_.material;return $.emissiveTexture=b,$.disableLighting=!0,b.uScale=5,t.scene.onBeforeRenderObservable.add(()=>{b.uOffset-=.04*t.scene.getAnimationRatio()}),_}transformEdgeMesh(e,t){const r=t.subtract(e),o=new W.Vector3(e.x+r.x/2,e.y+r.y/2,e.z+r.z/2),a=r.length();this.mesh.position=o,this.mesh.lookAt(t),this.mesh.scaling.z=a}transformArrowCap(){if(this.arrowMesh){this.parentGraph.stats.arrowCapUpdate.beginMonitoring();const{srcPoint:e,dstPoint:t,newEndPoint:r}=this.getInterceptPoints();if(!e||!t||!r)throw new Error("Internal Error: mesh intercept points not found");return this.arrowMesh.position=t,this.arrowMesh.lookAt(this.dstNode.mesh.position),this.parentGraph.stats.arrowCapUpdate.endMonitoring(),{srcPoint:e,dstPoint:r}}return{srcPoint:null,dstPoint:null}}getInterceptPoints(){var c;const e=this.srcNode.mesh,t=this.dstNode.mesh;this.parentGraph.stats.intersectCalc.beginMonitoring();const r=this.ray.intersectsMeshes([t]),o=this.ray.intersectsMeshes([e]);this.parentGraph.stats.intersectCalc.endMonitoring();let a=null,u=null,h=null;if(r.length&&o.length){const f=xn.getStyleForEdgeStyleId(this.styleId),p=Sp(((c=f.line)==null?void 0:c.width)??.25);if(u=r[0].pickedPoint,a=o[0].pickedPoint,!a||!u)throw new TypeError("error picking points");const g=a.subtract(u).length(),m=g-p,{x:b,y:_,z:$}=a,{x:C,y:S,z:I}=u,T=b+m/g*(C-b),A=_+m/g*(S-_),N=$+m/g*(I-$);h=new W.Vector3(T,A,N)}return{srcPoint:a,dstPoint:u,newEndPoint:h}}static get unitVectorPoints(){return[0,0,-.5,0,0,.5]}static createLabel(e,t){var h,c,f,p,g,m,b,_,$,C,S,I,T,A,N,D,L,q,se,we,me,ge,Xe,Ue,ut,Ve,ne,ae,ie,he,_e,Te,Le,Qe,ue,te,U,j,Y,fe,xe,He,Tt,ze,ot,Lt,St,Ln,Ee,qt,tt,En;let r=e.id;const o=t.label;if(o.text!==void 0&&o.text!==null)(typeof o.text=="string"||typeof o.text=="number"||typeof o.text=="boolean")&&(r=String(o.text));else if(o.textPath&&typeof o.textPath=="string")try{const Bn=_p.search(e.data,o.textPath);Bn!=null&&(r=String(Bn))}catch{}const a={text:r};return((h=t.label)==null?void 0:h.font)!==void 0&&(a.font=t.label.font),((c=t.label)==null?void 0:c.fontSize)!==void 0&&(a.fontSize=t.label.fontSize),((f=t.label)==null?void 0:f.fontWeight)!==void 0&&(a.fontWeight=t.label.fontWeight),((p=t.label)==null?void 0:p.lineHeight)!==void 0&&(a.lineHeight=t.label.lineHeight),((g=t.label)==null?void 0:g.textColor)!==void 0&&(a.textColor=t.label.textColor),((m=t.label)==null?void 0:m.backgroundColor)!==void 0&&(a.backgroundColor=t.label.backgroundColor),((b=t.label)==null?void 0:b.borderWidth)!==void 0&&(a.borderWidth=t.label.borderWidth),((_=t.label)==null?void 0:_.borderColor)!==void 0&&(a.borderColor=t.label.borderColor),(($=t.label)==null?void 0:$.borders)!==void 0&&(a.borders=t.label.borders),((C=t.label)==null?void 0:C.marginTop)!==void 0&&(a.marginTop=t.label.marginTop),((S=t.label)==null?void 0:S.marginBottom)!==void 0&&(a.marginBottom=t.label.marginBottom),((I=t.label)==null?void 0:I.marginLeft)!==void 0&&(a.marginLeft=t.label.marginLeft),((T=t.label)==null?void 0:T.marginRight)!==void 0&&(a.marginRight=t.label.marginRight),((A=t.label)==null?void 0:A.textAlign)!==void 0&&(a.textAlign=t.label.textAlign),((N=t.label)==null?void 0:N.cornerRadius)!==void 0&&(a.cornerRadius=t.label.cornerRadius),((D=t.label)==null?void 0:D.autoSize)!==void 0&&(a.autoSize=t.label.autoSize),((L=t.label)==null?void 0:L.resolution)!==void 0&&(a.resolution=t.label.resolution),((q=t.label)==null?void 0:q.billboardMode)!==void 0&&(a.billboardMode=t.label.billboardMode),((se=t.label)==null?void 0:se.depthFadeEnabled)!==void 0&&(a.depthFadeEnabled=t.label.depthFadeEnabled),((we=t.label)==null?void 0:we.depthFadeNear)!==void 0&&(a.depthFadeNear=t.label.depthFadeNear),((me=t.label)==null?void 0:me.depthFadeFar)!==void 0&&(a.depthFadeFar=t.label.depthFadeFar),((ge=t.label)==null?void 0:ge.textOutline)!==void 0&&(a.textOutline=t.label.textOutline),((Xe=t.label)==null?void 0:Xe.textOutlineWidth)!==void 0&&(a.textOutlineWidth=t.label.textOutlineWidth),((Ue=t.label)==null?void 0:Ue.textOutlineColor)!==void 0&&(a.textOutlineColor=t.label.textOutlineColor),((ut=t.label)==null?void 0:ut.textOutlineJoin)!==void 0&&(a.textOutlineJoin=t.label.textOutlineJoin),((Ve=t.label)==null?void 0:Ve.textShadow)!==void 0&&(a.textShadow=t.label.textShadow),((ne=t.label)==null?void 0:ne.textShadowColor)!==void 0&&(a.textShadowColor=t.label.textShadowColor),((ae=t.label)==null?void 0:ae.textShadowBlur)!==void 0&&(a.textShadowBlur=t.label.textShadowBlur),((ie=t.label)==null?void 0:ie.textShadowOffsetX)!==void 0&&(a.textShadowOffsetX=t.label.textShadowOffsetX),((he=t.label)==null?void 0:he.textShadowOffsetY)!==void 0&&(a.textShadowOffsetY=t.label.textShadowOffsetY),((_e=t.label)==null?void 0:_e.backgroundPadding)!==void 0&&(a.backgroundPadding=t.label.backgroundPadding),((Te=t.label)==null?void 0:Te.backgroundGradient)!==void 0&&(a.backgroundGradient=t.label.backgroundGradient),((Le=t.label)==null?void 0:Le.backgroundGradientType)!==void 0&&(a.backgroundGradientType=t.label.backgroundGradientType),((Qe=t.label)==null?void 0:Qe.backgroundGradientColors)!==void 0&&(a.backgroundGradientColors=t.label.backgroundGradientColors),((ue=t.label)==null?void 0:ue.backgroundGradientDirection)!==void 0&&(a.backgroundGradientDirection=t.label.backgroundGradientDirection),((te=t.label)==null?void 0:te.pointer)!==void 0&&(a.pointer=t.label.pointer),((U=t.label)==null?void 0:U.pointerDirection)!==void 0&&(a.pointerDirection=t.label.pointerDirection),((j=t.label)==null?void 0:j.pointerWidth)!==void 0&&(a.pointerWidth=t.label.pointerWidth),((Y=t.label)==null?void 0:Y.pointerHeight)!==void 0&&(a.pointerHeight=t.label.pointerHeight),((fe=t.label)==null?void 0:fe.pointerOffset)!==void 0&&(a.pointerOffset=t.label.pointerOffset),((xe=t.label)==null?void 0:xe.pointerCurve)!==void 0&&(a.pointerCurve=t.label.pointerCurve),((He=t.label)==null?void 0:He.animation)!==void 0&&(a.animation=t.label.animation),((Tt=t.label)==null?void 0:Tt.animationSpeed)!==void 0&&(a.animationSpeed=t.label.animationSpeed),((ze=t.label)==null?void 0:ze.badge)!==void 0&&(a.badge=t.label.badge),((ot=t.label)==null?void 0:ot.icon)!==void 0&&(a.icon=t.label.icon),((Lt=t.label)==null?void 0:Lt.iconPosition)!==void 0&&(a.iconPosition=t.label.iconPosition),((St=t.label)==null?void 0:St.progress)!==void 0&&(a.progress=t.label.progress),((Ln=t.label)==null?void 0:Ln.smartOverflow)!==void 0&&(a.smartOverflow=t.label.smartOverflow),((Ee=t.label)==null?void 0:Ee.maxNumber)!==void 0&&(a.maxNumber=t.label.maxNumber),((qt=t.label)==null?void 0:qt.overflowSuffix)!==void 0&&(a.overflowSuffix=t.label.overflowSuffix),a.attachPosition=((tt=t.label)==null?void 0:tt.location)??"center",a.attachOffset=((En=t.label)==null?void 0:En.attachOffset)??0,new Qs(e.parentGraph.scene,a)}}function Zw(n){return Math.max(20*n,4)}function Sp(n){return Math.max(n,.5)}class qw{constructor(){this.map=new Map}has(e,t){const r=this.map.get(e);return r?r.has(t):!1}set(e,t,r){let o=this.map.get(e);if(o||(o=new Map,this.map.set(e,o)),o.has(t))throw new Error("Attempting to create duplicate Edge");o.set(t,r)}get(e,t){const r=this.map.get(e);if(r)return r.get(t)}get size(){let e=0;for(const t of this.map.values())e+=t.size;return e}}const Gw=ke({path:Ge().default("nodes"),schema:hp().or(Ye()).default(null)}).prefault({}),Hw=ke({path:Ge().default("edges"),schema:hp().or(Ye()).default(null)}).prefault({}),Ww=ui({data:Ge(),node:Gw,edge:Hw}),yc=class yc extends Js{constructor(e){super();const t=Ww.parse(e);this.opts=t,t.node.schema&&(this.nodeSchema=t.node.schema),t.edge.schema&&(this.edgeSchema=t.edge.schema),this.url=t.data}async*sourceFetchData(){const e=await fetch(this.url);if(!e.body)throw new Error("JSON response had no body");const t=await e.json(),r=zr.search(t,this.opts.node.path);if(!Array.isArray(r))throw new TypeError(`JsonDataProvider expected 'nodes' to be an array of objects, got ${r}`);const o=zr.search(t,this.opts.edge.path);if(!Array.isArray(o))throw new TypeError(`JsonDataProvider expected 'edges' to be an array of objects, got ${o}`);yield{nodes:r,edges:o}}};yc.type="json";let wl=yc;Js.register(wl);const Xs={zeros:function(n){return typeof n=="number"?Array(n).fill(0):n.length===1?Array(n[0]).fill(0):Array(n[0]).fill(0).map(()=>this.zeros(n.slice(1)))},ones:function(n){return typeof n=="number"?Array(n).fill(1):n.length===1?Array(n[0]).fill(1):Array(n[0]).fill(1).map(()=>this.ones(n.slice(1)))},linspace:function(n,e,t){const r=(e-n)/(t-1);return Array.from({length:t},(o,a)=>n+a*r)},array:function(n){return Array.isArray(n)?[...n]:[n]},repeat:function(n,e){const t=[];for(let r=0;r<e;r++)t.push(...Xs.array(n));return t},mean:function(n,e=null){if(e===null){const t=Array.isArray(n[0])?n.flat(1/0):n;return t.reduce((o,a)=>o+a,0)/t.length}if(e===0){const t=[],r=n;for(let o=0;o<r[0].length;o++){let a=0;for(let u=0;u<r.length;u++)a+=r[u][o];t.push(a/r.length)}return t}return n.map(t=>Xs.mean(t))},add:function(n,e){return!Array.isArray(n)&&!Array.isArray(e)?n+e:Array.isArray(n)?Array.isArray(e)?n.map((t,r)=>t+e[r]):n.map(t=>t+e):e.map(t=>n+t)},subtract:function(n,e){return!Array.isArray(n)&&!Array.isArray(e)?n-e:Array.isArray(n)?Array.isArray(e)?n.map((t,r)=>t-e[r]):n.map(t=>t-e):e.map(t=>n-t)},max:function(n){return Array.isArray(n)?Math.max(...n.flat(1/0)):n},min:function(n){return Array.isArray(n)?Math.min(...n.flat(1/0)):n},norm:function(n){return Math.sqrt(n.reduce((e,t)=>e+t*t,0))}};class zo{constructor(e){this.seed=e||Math.floor(Math.random()*1e6),this.m=2**35-31,this.a=185852,this.c=1,this._state=this.seed%this.m}_next(){return this._state=(this.a*this._state+this.c)%this.m,this._state/this.m}rand(e=null){if(e===null)return this._next();if(typeof e=="number"){const r=[];for(let o=0;o<e;o++)r.push(this._next());return r}if(e.length===1){const r=[];for(let o=0;o<e[0];o++)r.push(this._next());return r}const t=[];for(let r=0;r<e[0];r++)t.push(this.rand(e.slice(1)));return t}}function Tn(n){return n.nodes?n.nodes():n}function ea(n){return n.edges?n.edges():[]}function zn(n,e,t){if(e||(e=Array(t).fill(0)),e.length!==t)throw new Error("length of center coordinates must match dimension of layout");return{G:n,center:e}}function xl(n,e=null,t=2,r=null){const o=zn(n,e,t),a=Tn(o.G);e=o.center;const u=new zo(r??void 0),h={};return a.forEach(c=>{h[c]=u.rand(t).map((f,p)=>f+e[p])}),h}function Mp(n,e=1,t=null,r=2){if(r<2)throw new Error("cannot handle dimensions < 2");const o=zn(n,t,r),a=Tn(o.G);t=o.center;const u={};if(a.length===0)return u;if(a.length===1)return u[a[0]]=t,u;const h=Xs.linspace(0,2*Math.PI,a.length+1).slice(0,-1);return a.forEach((c,f)=>{const p=Math.cos(h[f])*e+t[0],g=Math.sin(h[f])*e+t[1];u[c]=Array(r).fill(0).map((m,b)=>b===0?p:b===1?g:0)}),u}function jw(n,e=null,t=1,r=null,o=2){if(o!==2)throw new Error("can only handle 2 dimensions");const a=zn(n,r,o),u=Tn(a.G);r=a.center;const h={};if(u.length===0)return h;if(u.length===1)return h[u[0]]=r,h;e||(e=[u]);const c=t/e.length;let f;e[0].length===1?(f=0,h[e[0][0]]=[...r],f+=c):f=c;for(let p=0;p<e.length;p++){const g=e[p];if(g.length===0||g.length===1&&p===0)continue;const m=Xs.linspace(0,2*Math.PI,g.length+1).slice(0,-1);g.forEach((b,_)=>{const $=Math.cos(m[_])*f+r[0],C=Math.sin(m[_])*f+r[1];h[b]=[$,C]}),f+=c}return h}function Vw(n,e=null,t=null,r=null,o=50,a=1,u=null,h=2,c=null){return Kw(n,e,t,r,o,a,u,h,c)}function Kw(n,e=null,t=null,r=null,o=50,a=1,u=null,h=2,c=null){const f=zn(n,u,h);let p=f.G;u=f.center;const g=Tn(p),m=ea(p);if(g.length===0)return{};if(g.length===1){const S={};return S[g[0]]=u,S}let b={};if(t)for(const S of g)if(t[S])b[S]=[...t[S]];else{const I=new zo(c??void 0);b[S]=I.rand(h)}else{const S=new zo(c??void 0);for(const I of g)b[I]=S.rand(h)}const _=new Set(r||[]);e||(e=1/Math.sqrt(g.length));let $=.1;const C=$/(o+1);for(let S=0;S<o;S++){const I={};for(const T of g)I[T]=Array(h).fill(0);for(let T=0;T<g.length;T++){const A=g[T];for(let N=T+1;N<g.length;N++){const D=g[N],L=b[A].map((we,me)=>we-b[D][me]),q=Math.sqrt(L.reduce((we,me)=>we+me*me,0))||.1,se=e*e/q;for(let we=0;we<h;we++){const me=L[we]/q;I[A][we]+=me*se,I[D][we]-=me*se}}}for(const[T,A]of m){const N=b[T].map((q,se)=>q-b[A][se]),D=Math.sqrt(N.reduce((q,se)=>q+se*se,0))||.1,L=D*D/e;for(let q=0;q<h;q++){const se=N[q]/D;I[T][q]-=se*L,I[A][q]+=se*L}}for(const T of g){if(_.has(T))continue;const A=Math.sqrt(I[T].reduce((D,L)=>D+L*L,0)),N=Math.min(A,$);for(let D=0;D<h;D++){const L=A===0?0:I[T][D]/A;b[T][D]+=L*N}}$-=C}return r||(b=Dr(b,a,u)),b}function Jw(n,e=1,t=null,r=2){const o=zn(n,t,r),a=o.G;t=o.center;const u=Tn(a);if(u.length<=2)return u.length===0?{}:u.length===1?{[u[0]]:t}:{[u[0]]:t.map(C=>C-e),[u[1]]:t.map(C=>C+e)};const h=u.length,c={};u.forEach((C,S)=>{c[C]=S});const f=Array(h).fill(0).map(()=>Array(h).fill(0)),p=ea(a);for(const[C,S]of p){const I=c[C],T=c[S];f[I][T]=1,f[T][I]=1}const g=Array(h).fill(0).map(()=>Array(h).fill(0));for(let C=0;C<h;C++){g[C][C]=f[C].reduce((S,I)=>S+I,0);for(let S=0;S<h;S++)g[C][S]-=f[C][S]}const m=[];for(let C=0;C<r;C++){let S=Array(h).fill(0).map(()=>Math.random()-.5);for(const T of m){const A=S.reduce((N,D,L)=>N+D*T[L],0);S=S.map((N,D)=>N-A*T[D])}const I=Math.sqrt(S.reduce((T,A)=>T+A*A,0));S=S.map(T=>T/I);for(let T=0;T<100;T++){const A=Array(h).fill(0);for(let L=0;L<h;L++)for(let q=0;q<h;q++)A[L]+=g[L][q]*S[q];const N=A.reduce((L,q)=>L+q,0)/h;A.forEach((L,q,se)=>{se[q]=L-N});const D=Math.sqrt(A.reduce((L,q)=>L+q*q,0));D<1e-10||(S=A.map(L=>L/D))}m.push(S)}const b=Array(h).fill(0).map(()=>Array(r).fill(0));for(let C=0;C<h;C++)for(let S=0;S<r;S++)b[C][S]=m[S][C];const _=Dr(b,e),$={};return u.forEach((C,S)=>{$[C]=_[S].map((I,T)=>I+t[T])}),$}function Yw(n,e=1,t=null,r=2,o=.35,a=!1){if(r!==2)throw new Error("can only handle 2 dimensions");const u=zn(n,t||[0,0],r),h=Tn(u.G);t=u.center;const c={};if(h.length===0)return c;if(h.length===1)return c[h[0]]=[...t],c;let f=[];if(a){let _=o;_+=1/(.5*_);for(let $=0;$<h.length;$++){const C=.5*_;_+=1/C,f.push([Math.cos(_)*C,Math.sin(_)*C])}}else{const m=Array.from({length:h.length},(_,$)=>parseFloat(String($))),b=m.map(_=>o*_);f=m.map((_,$)=>[Math.cos(b[$])*_,Math.sin(b[$])*_])}const p=[];for(let m=0;m<f.length;m++)p.push(f[m]);const g=Dr(p,e);for(let m=0;m<g.length;m++)g[m][0]+=t[0],g[m][1]+=t[1];for(let m=0;m<h.length;m++)c[h[m]]=g[m];return c}function Dr(n,e=1,t=[0,0]){if(Array.isArray(n)){if(n.length===0)return[]}else if(Object.keys(n).length===0)return{};const r=Array.isArray(n)?n:Object.values(n),o=r[0].length,a=Array(o).fill(0);for(const p of r)for(let g=0;g<o;g++)a[g]+=p[g]/r.length;let u={};if(Array.isArray(n))u=n.map(p=>p.map((g,m)=>g-a[m]));else for(const[p,g]of Object.entries(n))u[p]=g.map((m,b)=>m-a[b]);let h=0;const c=Array.isArray(u)?u:Object.values(u);for(const p of c){const g=Math.sqrt(p.reduce((m,b)=>m+b*b,0));h=Math.max(h,g)}let f=Array.isArray(n)?[]:{};if(h>0){const p=e/h;if(Array.isArray(n))f=u.map(g=>g.map((m,b)=>m*p+t[b]));else for(const[g,m]of Object.entries(u))f[g]=m.map((b,_)=>b*p+t[_])}else if(Array.isArray(n))f=Array(n.length).fill(0).map(()=>[...t]);else for(const p of Object.keys(n))f[p]=[...t];return f}function Qw(n,e=null,t="vertical",r=1,o=null,a=4/3){if(t!=="vertical"&&t!=="horizontal")throw new Error("align must be either vertical or horizontal");const u=zn(n,o||[0,0],2),h=u.G;o=u.center;const c=Tn(h);if(c.length===0)return{};e||(e=c.filter((I,T)=>T%2===0));const f=new Set(e),p=new Set(c.filter(I=>!f.has(I))),g=1,m=a*g,b=[m/2,g/2],_={},$=[...f];$.forEach((I,T)=>{const N=T*g/($.length||1);_[I]=[0,N]});const C=[...p];C.forEach((I,T)=>{const A=m,N=T*g/(C.length||1);_[I]=[A,N]});for(const I in _)_[I][0]-=b[0],_[I][1]-=b[1];const S=Dr(_,r,o);if(t==="horizontal")for(const I in S){const T=S[I][0];S[I][0]=S[I][1],S[I][1]=T}return S}function Ep(n,e="subset",t="vertical",r=1,o=null){if(t!=="vertical"&&t!=="horizontal")throw new Error("align must be either vertical or horizontal");const a=zn(n,o||[0,0],2),u=a.G;o=a.center;const h=Tn(u);if(h.length===0)return{};let c={};if(typeof e=="string")console.warn("Using string subsetKey requires node attributes, using default partitioning"),c={0:h};else for(const[g,m]of Object.entries(e))Array.isArray(m)?c[g]=m:c[g]=[m];const f=Object.keys(c).length;let p={};if(Object.entries(c).forEach(([g,m],b)=>{const _=Array.isArray(m)?m:[m],$=_.length;_.forEach((C,S)=>{const I=b-(f-1)/2,T=S-($-1)/2;p[C]=[I,T]})}),p=Dr(p,r,o),t==="horizontal")for(const g in p){const m=p[g][0];p[g][0]=p[g][1],p[g][1]=m}return p}function Xw(n,e,t="vertical",r=1,o=null){const a=zn(n,o||[0,0],2),u=a.G;o=a.center;const h=Tn(u);if(h.length===0)return{};const c={},f=new Set;let p=0;for(c[p]=[e],f.add(e);Object.values(c).flat().length<h.length;){const m=[],b=c[p];for(const _ of b){const $=g(u,_);for(const C of $)f.has(C)||(m.push(C),f.add(C))}if(m.length===0){if(h.filter($=>!f.has($)).length>0)throw new Error("bfs_layout didn't include all nodes. Graph may be disconnected.");break}p++,c[p]=m}return Ep(u,c,t,r,o);function g(m,b){return m.edges?m.edges().filter(_=>_[0]===b||_[1]===b).map(_=>_[0]===b?_[1]:_[0]):[]}}function e5(n,e=1,t=null,r=2){if(r!==2)throw new Error("can only handle 2 dimensions");const o=zn(n,t||[0,0],r),a=o.G;t=o.center;const u=Tn(a),h=ea(a);if(u.length===0)return{};const{isPlanar:c,embedding:f}=t5(a,u,h);if(!c)throw new Error("G is not planar.");if(!f)throw new Error("Failed to generate planar embedding.");let p=a5(f,u);return p=Dr(p,e,t),p}function t5(n,e,t){return e.length<=4?{isPlanar:!0,embedding:Tl(e,t)}:n5(e,t)||r5(e,t)?{isPlanar:!1,embedding:null}:o5(e,t)}function n5(n,e){if(n.length!==5||e.length!==10)return!1;for(let t=0;t<n.length;t++)for(let r=t+1;r<n.length;r++)if(!e.some(a=>a[0]===n[t]&&a[1]===n[r]||a[0]===n[r]&&a[1]===n[t]))return!1;return!0}function r5(n,e){if(n.length!==6||e.length!==9)return!1;const t=i5(n,e);if(!t)return!1;const[r,o]=t;if(r.length!==3||o.length!==3)return!1;for(const a of r)for(const u of o)if(!e.some(c=>c[0]===a&&c[1]===u||c[0]===u&&c[1]===a))return!1;return!0}function i5(n,e){const t={},r={};for(const h of n)r[h]=[];for(const[h,c]of e)r[h].push(c),r[c].push(h);const o=[n[0]];for(t[n[0]]=0;o.length>0;){const h=o.shift(),c=t[h];for(const f of r[h])if(t[f]===void 0)t[f]=1-c,o.push(f);else if(t[f]===c)return null}const a=[],u=[];for(const h of n)t[h]===0?a.push(h):u.push(h);return[a,u]}function o5(n,e){const t={};for(const h of n)t[h]=[];for(const[h,c]of e)t[h].push(c),t[c].push(h);const r=new Set,o=[];function a(h){r.add(h),o.push(h);for(const c of t[h])r.has(c)||a(c)}return a(n[0]),o.length<n.length?{isPlanar:!0,embedding:Tl(n,e)}:e.length>3*n.length-6?{isPlanar:!1,embedding:null}:{isPlanar:!0,embedding:Tl(n,e)}}function Tl(n,e){const t={nodeOrder:[...n],faceList:[],nodePositions:{}},r={};for(const h of n)r[h]=new Set;for(const[h,c]of e)r[h].add(c),r[c].add(h);const o=s5(n,e,r)||n;t.faceList.push(o);const a=o.length;for(let h=0;h<a;h++){const c=2*Math.PI*h/a;t.nodePositions[o[h]]=[Math.cos(c),Math.sin(c)]}const u=n.filter(h=>!t.nodePositions[h]);for(const h of u){const c=Array.from(r[h]);if(c.length===0)t.nodePositions[h]=[0,0];else{let f=0,p=0,g=0;for(const m of c)t.nodePositions[m]&&(f+=t.nodePositions[m][0],p+=t.nodePositions[m][1],g++);if(g>0){const m=.1*Math.random();t.nodePositions[h]=[f/g+m*(Math.random()-.5),p/g+m*(Math.random()-.5)]}else{const m=.5*Math.random(),b=2*Math.PI*Math.random();t.nodePositions[h]=[m*Math.cos(b),m*Math.sin(b)]}}}return t}function s5(n,e,t){if(n.length===0)return null;if(n.length<=2)return n;if(n.length<=8){let c=function(g){if(p.push(g),f.add(g),p.length===n.length)return t[g].has(p[0])?!0:(f.delete(g),p.pop(),!1);for(const m of t[g])if(!f.has(m)&&c(m))return!0;return f.delete(g),p.pop(),!1};const f=new Set,p=[];if(c(n[0]))return p}const r=new Set,o={};let a=null;function u(c,f){r.add(c);for(const p of t[c])if(p!==f){if(r.has(p))return a=h(c,p,o),!0;if(o[p]=c,u(p,c))return!0}return!1}function h(c,f,p){const g=[f,c];let m=c;for(;p[m]!==void 0&&p[m]!==f;)m=p[m],g.push(m);return g}for(const c of n)if(!r.has(c)&&(o[c]=null,u(c,null)))break;return a||n}function a5(n,e){const t={};for(const r of e)n.nodePositions[r]?t[r]=n.nodePositions[r]:t[r]=[0,0];return t}function u5(n,e=null,t=null,r="weight",o=1,a=null,u=2){const h=zn(n,a,u),c=h.G;a=h.center;const f=Tn(c);if(f.length===0)return{};if(f.length===1)return{[f[0]]:a};e||(e=l5(c,r));const p=Array.from(f),g=p.length,m=Array(g).fill(0).map(()=>Array(g).fill(1e6));for(let C=0;C<g;C++){const S=p[C];if(m[C][C]=0,!!e[S])for(let I=0;I<g;I++){const T=p[I];e[S][T]!==void 0&&(m[C][I]=e[S][T])}}if(!t)if(u>=3)t=xl(n,null,u);else if(u===2)t=Mp(n,1,[0,0],u);else{const C={};p.forEach((S,I)=>{C[S]=[I/(g-1||1)]}),t=C}const b=new Array(g);for(let C=0;C<g;C++){const S=p[C];for(b[C]=t[S]?[...t[S]]:Array(u).fill(0);b[C].length<u;)b[C].push(0)}const _=c5(m,b,u),$={};for(let C=0;C<g;C++)$[p[C]]=_[C];return Dr($,o,a)}function l5(n,e){const t={},r=n.nodes?n.nodes():n,o=n.edges?n.edges():[];for(const a of r){t[a]={},t[a][a]=0;for(const u of r)a!==u&&(t[a][u]=1/0)}for(const[a,u]of o){let h=1;n.getEdgeData&&(h=n.getEdgeData(a,u,e)||1),t[a][u]=h,t[u][a]=h}for(const a of r)for(const u of r)for(const h of r)t[u][a]+t[a][h]<t[u][h]&&(t[u][h]=t[u][a]+t[a][h]);return t}function c5(n,e,t){const r=e.length,o=.001,a=n.map(_=>_.map($=>$===0?0:1/($+.001)));let u=e.flat();const h=500,c=1e-5,f=10;let p=1;const g=[],m=[];for(let _=0;_<h;_++){const[$,C]=Sl(u,a,o,t),S=h5(C,g,m);p=f5(u,S,$,C,N=>Sl(N,a,o,t)[0],p);const I=[...u];for(let N=0;N<u.length;N++)u[N]+=p*S[N];const[,T]=Sl(u,a,o,t);if(g.push(u.map((N,D)=>N-I[D])),m.push(T.map((N,D)=>N-C[D])),g.length>f&&(g.shift(),m.shift()),Math.sqrt(T.reduce((N,D)=>N+D*D,0))<c)break}const b=[];for(let _=0;_<r;_++)b.push(u.slice(_*t,(_+1)*t));return b}function Sl(n,e,t,r){const o=e.length,a=[];for(let f=0;f<o;f++)a.push(n.slice(f*r,(f+1)*r));let u=0;const h=Array(r).fill(0);for(let f=0;f<o;f++)for(let p=0;p<r;p++)h[p]+=a[f][p];u+=.5*t*h.reduce((f,p)=>f+p*p,0);for(let f=0;f<o;f++)for(let p=f+1;p<o;p++){const g=a[f].map(($,C)=>$-a[p][C]),m=Math.sqrt(g.reduce(($,C)=>$+C*C,0)),b=e[f][p],_=m*b-1;u+=.5*_*_}const c=new Array(n.length).fill(0);for(let f=0;f<o;f++)for(let p=0;p<r;p++)c[f*r+p]+=t*h[p];for(let f=0;f<o;f++)for(let p=f+1;p<o;p++){const g=a[f].map((C,S)=>C-a[p][S]),m=Math.sqrt(g.reduce((C,S)=>C+S*S,0))||1e-10,b=g.map(C=>C/m),_=e[f][p],$=m*_-1;for(let C=0;C<r;C++){const S=_*$*b[C];c[f*r+C]+=S,c[p*r+C]-=S}}return[u,c]}function h5(n,e,t,r){if(e.length===0)return n.map(f=>-f);const o=n.slice(),a=Array(e.length).fill(0),u=[];for(let f=0;f<e.length;f++){const p=e[f],g=t[f];u.push(1/g.reduce((m,b,_)=>m+b*p[_],0))}for(let f=e.length-1;f>=0;f--){const p=e[f];a[f]=u[f]*p.reduce((g,m,b)=>g+m*o[b],0);for(let g=0;g<o.length;g++)o[g]-=a[f]*t[f][g]}let h=1;if(e.length>0&&t.length>0){const f=t[t.length-1];h=e[e.length-1].reduce((g,m,b)=>g+m*f[b],0)/f.reduce((g,m)=>g+m*m,0)}const c=o.map(f=>-h*f);for(let f=0;f<e.length;f++){const p=e[f],g=t[f],m=u[f]*g.reduce((b,_,$)=>b+_*c[$],0);for(let b=0;b<c.length;b++)c[b]+=p[b]*(a[f]-m)}return c}function f5(n,e,t,r,o,a){const c=r.reduce((g,m,b)=>g+m*e[b],0);if(c>=0)return 1e-8;let f=a;const p=20;for(let g=0;g<p;g++){const m=n.map((_,$)=>_+f*e[$]);if(o(m)<=t+1e-4*f*c)return f;f*=.9}return f}function d5(n,e=null,t=100,r=1,o=2,a=1,u=!1,h=!1,c=null,f=null,p=null,g=!1,m=!1,b=null,_=2){const C=zn(n,null,_).G,S=Tn(C);if(S.length===0)return{};const I=new zo(b??void 0);let T;if(e===null){e={},T=new Array(S.length);for(let ie=0;ie<S.length;ie++)T[ie]=Array(_).fill(0).map(()=>I.rand()*2-1),e[S[ie]]=T[ie]}else if(Object.keys(e).length===S.length){T=new Array(S.length);for(let ie=0;ie<S.length;ie++)T[ie]=[...e[S[ie]]]}else{let ie=Array(_).fill(Number.POSITIVE_INFINITY),he=Array(_).fill(Number.NEGATIVE_INFINITY);for(const _e in e)for(let Te=0;Te<_;Te++)ie[Te]=Math.min(ie[Te],e[_e][Te]),he[Te]=Math.max(he[Te],e[_e][Te]);T=new Array(S.length);for(let _e=0;_e<S.length;_e++){const Te=S[_e];e[Te]?T[_e]=[...e[Te]]:(T[_e]=Array(_).fill(0).map((Le,Qe)=>ie[Qe]+I.rand()*(he[Qe]-ie[Qe])),e[Te]=T[_e])}}const A=new Array(S.length).fill(0),N=new Array(S.length).fill(0),D=f!==null;for(let ie=0;ie<S.length;ie++){const he=S[ie];A[ie]=c&&c[he]?c[he]:C.edges?ae(C,he)+1:1,N[ie]=f&&f[he]?f[he]:1}const L=S.length,q=Array(L).fill(0).map(()=>Array(L).fill(0)),se=C.edges?C.edges():[],we={};S.forEach((ie,he)=>{we[ie]=he});for(const[ie,he]of se){const _e=we[ie],Te=we[he];let Le=1;p&&C.getEdgeData&&(Le=C.getEdgeData(ie,he,p)||1),q[_e][Te]=Le,q[Te][_e]=Le}const me=Array(L).fill(0).map(()=>Array(_).fill(0)),ge=Array(L).fill(0).map(()=>Array(_).fill(0)),Xe=Array(L).fill(0).map(()=>Array(_).fill(0));let Ue=1,ut=1;function Ve(ie,he,_e,Te,Le,Qe){const ue=.05*Math.sqrt(ie),te=Math.sqrt(ue),U=10,j=.05,Y=Math.min(U,ue*_e/(ie*ie));let fe=Qe*Math.max(te,Y);he/_e>2&&(Le>j&&(Le*=.5),fe=Math.max(fe,Qe));let xe=he===0?Number.POSITIVE_INFINITY:fe*Le*_e/he;return he>fe*_e?Le>j&&(Le*=.7):Te<1e3&&(Le*=1.3),Te=Te+Math.min(xe-Te,.5*Te),[Te,Le]}for(let ie=0;ie<t;ie++){for(let U=0;U<L;U++)for(let j=0;j<_;j++)ge[U][j]=0,Xe[U][j]=0,me[U][j]=0;const he=Array(L).fill(0).map(()=>Array(L).fill(0).map(()=>Array(_).fill(0))),_e=Array(L).fill(0).map(()=>Array(L).fill(0));for(let U=0;U<L;U++)for(let j=0;j<L;j++)if(U!==j){for(let Y=0;Y<_;Y++)he[U][j][Y]=T[U][Y]-T[j][Y];_e[U][j]=Math.sqrt(he[U][j].reduce((Y,fe)=>Y+fe*fe,0)),_e[U][j]<.01&&(_e[U][j]=.01)}if(m)for(let U=0;U<L;U++)for(let j=0;j<L;j++){if(U===j||q[U][j]===0)continue;const Y=_e[U][j],fe=-Math.log(1+Y)/Y*q[U][j];for(let xe=0;xe<_;xe++){const He=fe*he[U][j][xe];ge[U][xe]+=He}}else for(let U=0;U<L;U++)for(let j=0;j<L;j++)if(!(U===j||q[U][j]===0))for(let Y=0;Y<_;Y++){const fe=-he[U][j][Y]*q[U][j];ge[U][Y]+=fe}if(u)for(let U=0;U<L;U++)for(let j=0;j<_;j++)ge[U][j]/=A[U];for(let U=0;U<L;U++)for(let j=0;j<L;j++){if(U===j)continue;let Y=_e[U][j];D&&(Y-=N[U]-N[j],Y=Math.max(Y,.01));const fe=Y*Y,He=A[U]*A[j]/fe*o;for(let Tt=0;Tt<_;Tt++){const ze=he[U][j][Tt]/Y;Xe[U][Tt]+=ze*He}}const Te=Array(_).fill(0);for(let U=0;U<L;U++)for(let j=0;j<_;j++)Te[j]+=T[U][j]/L;for(let U=0;U<L;U++){const j=Array(_);for(let Y=0;Y<_;Y++)j[Y]=T[U][Y]-Te[Y];if(h)for(let Y=0;Y<_;Y++)me[U][Y]=-a*A[U]*j[Y];else{const Y=Math.sqrt(j.reduce((fe,xe)=>fe+xe*xe,0));if(Y>.01)for(let fe=0;fe<_;fe++){const xe=j[fe]/Y;me[U][fe]=-a*A[U]*xe}}}const Le=Array(L).fill(0).map(()=>Array(_).fill(0));let Qe=0,ue=0;for(let U=0;U<L;U++){for(let ze=0;ze<_;ze++)Le[U][ze]=ge[U][ze]+Xe[U][ze]+me[U][ze];const j=[...T[U]],Y=j.map((ze,ot)=>ze+Le[U][ot]),fe=j.map((ze,ot)=>ze-Y[ot]),xe=j.map((ze,ot)=>ze+Y[ot]),He=Math.sqrt(fe.reduce((ze,ot)=>ze+ot*ot,0)),Tt=Math.sqrt(xe.reduce((ze,ot)=>ze+ot*ot,0));Qe+=A[U]*He,ue+=.5*A[U]*Tt}[Ue,ut]=Ve(L,Qe,ue,Ue,ut,r);let te=0;for(let U=0;U<L;U++){let j;if(D){const Y=Math.sqrt(Le[U].reduce((xe,He)=>xe+He*He,0)),fe=A[U]*Y;j=.1*Ue/(1+Math.sqrt(Ue*fe)),j=Math.min(j*Y,10)/Y}else{const Y=A[U]*Math.sqrt(Le[U].reduce((fe,xe)=>fe+xe*xe,0));j=Ue/(1+Math.sqrt(Ue*Y))}for(let Y=0;Y<_;Y++){const fe=Le[U][Y]*j;T[U][Y]+=fe,te+=Math.abs(fe)}}if(te<1e-10)break}const ne={};for(let ie=0;ie<L;ie++)ne[S[ie]]=T[ie];return Dr(ne);function ae(ie,he){return ie.edges?ie.edges().filter(_e=>_e[0]===he||_e[1]===he).length:0}}function p5(n,e=null,t=1,r=1.1,o=1e3,a=null){if(r<=1)throw new Error("The parameter a should be larger than 1");const u=Tn(n),h=ea(n);if(u.length===0)return{};if(!e)e=xl(n,null,2,a);else{const I=new zo(a??void 0),T={};u.forEach(A=>{e[A]||(T[A]=[I.rand(),I.rand()])}),e={...e,...T}}const c={};u.forEach((I,T)=>{c[I]=T});const f=u.map(I=>[...e[I]]),p=u.length,g=Array(p).fill(0).map(()=>Array(p).fill(1));for(let I=0;I<p;I++)g[I][I]=0;for(const[I,T]of h){if(I===T)continue;const A=c[I],N=c[T];g[A][N]=r,g[N][A]=r}const m=t*Math.sqrt(p),b=.001,_=1e-6;let $=_+1,C=0;for(;$>_&&C<o;){const I=Array(p).fill(0).map(()=>[0,0]);for(let T=0;T<p;T++)for(let A=0;A<p;A++){if(T===A)continue;const N=f[T].map((L,q)=>L-f[A][q]),D=Math.sqrt(N.reduce((L,q)=>L+q*q,0))||.01;for(let L=0;L<N.length;L++)I[T][L]+=g[T][A]*N[L]-m/D*N[L]}for(let T=0;T<p;T++)for(let A=0;A<f[T].length;A++)f[T][A]+=I[T][A]*b;$=I.reduce((T,A)=>T+Math.sqrt(A.reduce((N,D)=>N+D*D,0)),0),C++}const S={};return u.forEach((I,T)=>{S[I]=f[T]}),S}const Ml=new Map;class vt{addNodes(e){for(const t of e)this.addNode(t)}addEdges(e){for(const t of e)this.addEdge(t)}get type(){return this.constructor.type}static register(e){const t=e.type;return Ml.set(t,e),e}static get(e,t={}){const r=Ml.get(e);return r?new r(t):null}static getOptionsForDimension(e){return e>this.maxDimensions?null:{}}static getOptionsForDimensionByType(e,t){const r=Ml.get(e);return r?r.getOptionsForDimension(t):null}}const ln=Pb({scalingFactor:K().default(100)});class Sn extends vt{constructor(e={}){super(),this._nodes=[],this._edges=[],this.stale=!0,this.positions={},this.scalingFactor=100,this.isSettled=!0;const t=ln.parse(e);this.scalingFactor=t.scalingFactor}static getOptionsForDimension(e){return e>this.maxDimensions?null:{dim:e}}async init(){}addNode(e){this._nodes.push(e),this.stale=!0}addEdge(e){this._edges.push(e),this.stale=!0}getNodePosition(e){return this.stale&&this.doLayout(),El(this.positions[e.id],this.scalingFactor)}setNodePosition(){}getEdgePosition(e){return this.stale&&this.doLayout(),{src:El(this.positions[e.srcId],this.scalingFactor),dst:El(this.positions[e.dstId],this.scalingFactor)}}step(){}pin(){}unpin(){}get nodes(){return this._nodes}get edges(){return this._edges}}function El(n,e){const t=n[0]*e,r=n[1]*e,o=(n[2]??0)*e;return{x:t,y:r,z:o}}const g5=ke({...ln.shape,pos:cr(K(),it(K())).or(Ye()).default(null),scaling:K().positive().default(1),a:K().positive().default(1.1),maxIter:K().positive().default(1e3),seed:K().positive().or(Ye()).default(null)}),ya=class ya extends Sn{constructor(e){super(e),this.scalingFactor=100,this.config=g5.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=p5({nodes:e,edges:t},this.config.pos,this.config.scaling,this.config.a,this.config.maxIter,this.config.seed)}};ya.type="arf",ya.maxDimensions=2;let Cl=ya;const m5=ke({...ln.shape,start:K().or(Ge()),align:Rt(["vertical","horizontal"]).default("vertical"),scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null)}),ba=class ba extends Sn{constructor(e){super(e),this.scalingFactor=20,this.config=m5.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=Xw({nodes:e,edges:t},this.config.start,this.config.align,this.config.scale,this.config.center)}};ba.type="bfs",ba.maxDimensions=2;let Al=ba;const v5=ke({...ln.shape,nodes:it(K().or(Ge())),align:Rt(["vertical","horizontal"]).default("vertical"),scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null),aspectRatio:K().positive().default(4/3)}),wa=class wa extends Sn{constructor(e){super(e),this.scalingFactor=40,this.config=v5.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=Qw({nodes:e,edges:t},this.config.nodes,this.config.align,this.config.scale,this.config.center,this.config.aspectRatio)}};wa.type="bipartite",wa.maxDimensions=2;let Il=wa;const _5=ke({...ln.shape,scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null),dim:K().default(2)}),xa=class xa extends Sn{constructor(e){super(e),this.scalingFactor=80,this.config=_5.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=Mp({nodes:e,edges:t},this.config.scale,this.config.center,this.config.dim)}};xa.type="circular",xa.maxDimensions=2;let Pl=xa;function y5(n,e,t){var r,o=1;n==null&&(n=0),e==null&&(e=0),t==null&&(t=0);function a(){var u,h=r.length,c,f=0,p=0,g=0;for(u=0;u<h;++u)c=r[u],f+=c.x||0,p+=c.y||0,g+=c.z||0;for(f=(f/h-n)*o,p=(p/h-e)*o,g=(g/h-t)*o,u=0;u<h;++u)c=r[u],f&&(c.x-=f),p&&(c.y-=p),g&&(c.z-=g)}return a.initialize=function(u){r=u},a.x=function(u){return arguments.length?(n=+u,a):n},a.y=function(u){return arguments.length?(e=+u,a):e},a.z=function(u){return arguments.length?(t=+u,a):t},a.strength=function(u){return arguments.length?(o=+u,a):o},a}function b5(n){const e=+this._x.call(null,n);return Cp(this.cover(e),e,n)}function Cp(n,e,t){if(isNaN(e))return n;var r,o=n._root,a={data:t},u=n._x0,h=n._x1,c,f,p,g,m;if(!o)return n._root=a,n;for(;o.length;)if((p=e>=(c=(u+h)/2))?u=c:h=c,r=o,!(o=o[g=+p]))return r[g]=a,n;if(f=+n._x.call(null,o.data),e===f)return a.next=o,r?r[g]=a:n._root=a,n;do r=r?r[g]=new Array(2):n._root=new Array(2),(p=e>=(c=(u+h)/2))?u=c:h=c;while((g=+p)==(m=+(f>=c)));return r[m]=o,r[g]=a,n}function w5(n){Array.isArray(n)||(n=Array.from(n));const e=n.length,t=new Float64Array(e);let r=1/0,o=-1/0;for(let a=0,u;a<e;++a)isNaN(u=+this._x.call(null,n[a]))||(t[a]=u,u<r&&(r=u),u>o&&(o=u));if(r>o)return this;this.cover(r).cover(o);for(let a=0;a<e;++a)Cp(this,t[a],n[a]);return this}function x5(n){if(isNaN(n=+n))return this;var e=this._x0,t=this._x1;if(isNaN(e))t=(e=Math.floor(n))+1;else{for(var r=t-e||1,o=this._root,a,u;e>n||n>=t;)switch(u=+(n<e),a=new Array(2),a[u]=o,o=a,r*=2,u){case 0:t=e+r;break;case 1:e=t-r;break}this._root&&this._root.length&&(this._root=o)}return this._x0=e,this._x1=t,this}function T5(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function S5(n){return arguments.length?this.cover(+n[0][0]).cover(+n[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function hr(n,e,t){this.node=n,this.x0=e,this.x1=t}function M5(n,e){var t,r=this._x0,o,a,u=this._x1,h=[],c=this._root,f,p;for(c&&h.push(new hr(c,r,u)),e==null?e=1/0:(r=n-e,u=n+e);f=h.pop();)if(!(!(c=f.node)||(o=f.x0)>u||(a=f.x1)<r))if(c.length){var g=(o+a)/2;h.push(new hr(c[1],g,a),new hr(c[0],o,g)),(p=+(n>=g))&&(f=h[h.length-1],h[h.length-1]=h[h.length-1-p],h[h.length-1-p]=f)}else{var m=Math.abs(n-+this._x.call(null,c.data));m<e&&(e=m,r=n-m,u=n+m,t=c.data)}return t}function E5(n){if(isNaN(c=+this._x.call(null,n)))return this;var e,t=this._root,r,o,a,u=this._x0,h=this._x1,c,f,p,g,m;if(!t)return this;if(t.length)for(;;){if((p=c>=(f=(u+h)/2))?u=f:h=f,e=t,!(t=t[g=+p]))return this;if(!t.length)break;e[g+1&1]&&(r=e,m=g)}for(;t.data!==n;)if(o=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,o?(a?o.next=a:delete o.next,this):e?(a?e[g]=a:delete e[g],(t=e[0]||e[1])&&t===(e[1]||e[0])&&!t.length&&(r?r[m]=t:this._root=t),this):(this._root=a,this)}function C5(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function A5(){return this._root}function I5(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function P5(n){var e=[],t,r=this._root,o,a,u;for(r&&e.push(new hr(r,this._x0,this._x1));t=e.pop();)if(!n(r=t.node,a=t.x0,u=t.x1)&&r.length){var h=(a+u)/2;(o=r[1])&&e.push(new hr(o,h,u)),(o=r[0])&&e.push(new hr(o,a,h))}return this}function k5(n){var e=[],t=[],r;for(this._root&&e.push(new hr(this._root,this._x0,this._x1));r=e.pop();){var o=r.node;if(o.length){var a,u=r.x0,h=r.x1,c=(u+h)/2;(a=o[0])&&e.push(new hr(a,u,c)),(a=o[1])&&e.push(new hr(a,c,h))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.x1);return this}function $5(n){return n[0]}function O5(n){return arguments.length?(this._x=n,this):this._x}function Ap(n,e){var t=new kl(e??$5,NaN,NaN);return n==null?t:t.addAll(n)}function kl(n,e,t){this._x=n,this._x0=e,this._x1=t,this._root=void 0}function Ip(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var cn=Ap.prototype=kl.prototype;cn.copy=function(){var n=new kl(this._x,this._x0,this._x1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=Ip(e),n;for(t=[{source:e,target:n._root=new Array(2)}];e=t.pop();)for(var o=0;o<2;++o)(r=e.source[o])&&(r.length?t.push({source:r,target:e.target[o]=new Array(2)}):e.target[o]=Ip(r));return n},cn.add=b5,cn.addAll=w5,cn.cover=x5,cn.data=T5,cn.extent=S5,cn.find=M5,cn.remove=E5,cn.removeAll=C5,cn.root=A5,cn.size=I5,cn.visit=P5,cn.visitAfter=k5,cn.x=O5;function N5(n){const e=+this._x.call(null,n),t=+this._y.call(null,n);return Pp(this.cover(e,t),e,t,n)}function Pp(n,e,t,r){if(isNaN(e)||isNaN(t))return n;var o,a=n._root,u={data:r},h=n._x0,c=n._y0,f=n._x1,p=n._y1,g,m,b,_,$,C,S,I;if(!a)return n._root=u,n;for(;a.length;)if(($=e>=(g=(h+f)/2))?h=g:f=g,(C=t>=(m=(c+p)/2))?c=m:p=m,o=a,!(a=a[S=C<<1|$]))return o[S]=u,n;if(b=+n._x.call(null,a.data),_=+n._y.call(null,a.data),e===b&&t===_)return u.next=a,o?o[S]=u:n._root=u,n;do o=o?o[S]=new Array(4):n._root=new Array(4),($=e>=(g=(h+f)/2))?h=g:f=g,(C=t>=(m=(c+p)/2))?c=m:p=m;while((S=C<<1|$)===(I=(_>=m)<<1|b>=g));return o[I]=a,o[S]=u,n}function R5(n){var e,t,r=n.length,o,a,u=new Array(r),h=new Array(r),c=1/0,f=1/0,p=-1/0,g=-1/0;for(t=0;t<r;++t)isNaN(o=+this._x.call(null,e=n[t]))||isNaN(a=+this._y.call(null,e))||(u[t]=o,h[t]=a,o<c&&(c=o),o>p&&(p=o),a<f&&(f=a),a>g&&(g=a));if(c>p||f>g)return this;for(this.cover(c,f).cover(p,g),t=0;t<r;++t)Pp(this,u[t],h[t],n[t]);return this}function z5(n,e){if(isNaN(n=+n)||isNaN(e=+e))return this;var t=this._x0,r=this._y0,o=this._x1,a=this._y1;if(isNaN(t))o=(t=Math.floor(n))+1,a=(r=Math.floor(e))+1;else{for(var u=o-t||1,h=this._root,c,f;t>n||n>=o||r>e||e>=a;)switch(f=(e<r)<<1|n<t,c=new Array(4),c[f]=h,h=c,u*=2,f){case 0:o=t+u,a=r+u;break;case 1:t=o-u,a=r+u;break;case 2:o=t+u,r=a-u;break;case 3:t=o-u,r=a-u;break}this._root&&this._root.length&&(this._root=h)}return this._x0=t,this._y0=r,this._x1=o,this._y1=a,this}function D5(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function L5(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Yt(n,e,t,r,o){this.node=n,this.x0=e,this.y0=t,this.x1=r,this.y1=o}function B5(n,e,t){var r,o=this._x0,a=this._y0,u,h,c,f,p=this._x1,g=this._y1,m=[],b=this._root,_,$;for(b&&m.push(new Yt(b,o,a,p,g)),t==null?t=1/0:(o=n-t,a=e-t,p=n+t,g=e+t,t*=t);_=m.pop();)if(!(!(b=_.node)||(u=_.x0)>p||(h=_.y0)>g||(c=_.x1)<o||(f=_.y1)<a))if(b.length){var C=(u+c)/2,S=(h+f)/2;m.push(new Yt(b[3],C,S,c,f),new Yt(b[2],u,S,C,f),new Yt(b[1],C,h,c,S),new Yt(b[0],u,h,C,S)),($=(e>=S)<<1|n>=C)&&(_=m[m.length-1],m[m.length-1]=m[m.length-1-$],m[m.length-1-$]=_)}else{var I=n-+this._x.call(null,b.data),T=e-+this._y.call(null,b.data),A=I*I+T*T;if(A<t){var N=Math.sqrt(t=A);o=n-N,a=e-N,p=n+N,g=e+N,r=b.data}}return r}function F5(n){if(isNaN(p=+this._x.call(null,n))||isNaN(g=+this._y.call(null,n)))return this;var e,t=this._root,r,o,a,u=this._x0,h=this._y0,c=this._x1,f=this._y1,p,g,m,b,_,$,C,S;if(!t)return this;if(t.length)for(;;){if((_=p>=(m=(u+c)/2))?u=m:c=m,($=g>=(b=(h+f)/2))?h=b:f=b,e=t,!(t=t[C=$<<1|_]))return this;if(!t.length)break;(e[C+1&3]||e[C+2&3]||e[C+3&3])&&(r=e,S=C)}for(;t.data!==n;)if(o=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,o?(a?o.next=a:delete o.next,this):e?(a?e[C]=a:delete e[C],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[S]=t:this._root=t),this):(this._root=a,this)}function U5(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function Z5(){return this._root}function q5(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function G5(n){var e=[],t,r=this._root,o,a,u,h,c;for(r&&e.push(new Yt(r,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!n(r=t.node,a=t.x0,u=t.y0,h=t.x1,c=t.y1)&&r.length){var f=(a+h)/2,p=(u+c)/2;(o=r[3])&&e.push(new Yt(o,f,p,h,c)),(o=r[2])&&e.push(new Yt(o,a,p,f,c)),(o=r[1])&&e.push(new Yt(o,f,u,h,p)),(o=r[0])&&e.push(new Yt(o,a,u,f,p))}return this}function H5(n){var e=[],t=[],r;for(this._root&&e.push(new Yt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var o=r.node;if(o.length){var a,u=r.x0,h=r.y0,c=r.x1,f=r.y1,p=(u+c)/2,g=(h+f)/2;(a=o[0])&&e.push(new Yt(a,u,h,p,g)),(a=o[1])&&e.push(new Yt(a,p,h,c,g)),(a=o[2])&&e.push(new Yt(a,u,g,p,f)),(a=o[3])&&e.push(new Yt(a,p,g,c,f))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.x1,r.y1);return this}function W5(n){return n[0]}function j5(n){return arguments.length?(this._x=n,this):this._x}function V5(n){return n[1]}function K5(n){return arguments.length?(this._y=n,this):this._y}function kp(n,e,t){var r=new $l(e??W5,t??V5,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function $l(n,e,t,r,o,a){this._x=n,this._y=e,this._x0=t,this._y0=r,this._x1=o,this._y1=a,this._root=void 0}function $p(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var Qt=kp.prototype=$l.prototype;Qt.copy=function(){var n=new $l(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=$p(e),n;for(t=[{source:e,target:n._root=new Array(4)}];e=t.pop();)for(var o=0;o<4;++o)(r=e.source[o])&&(r.length?t.push({source:r,target:e.target[o]=new Array(4)}):e.target[o]=$p(r));return n},Qt.add=N5,Qt.addAll=R5,Qt.cover=z5,Qt.data=D5,Qt.extent=L5,Qt.find=B5,Qt.remove=F5,Qt.removeAll=U5,Qt.root=Z5,Qt.size=q5,Qt.visit=G5,Qt.visitAfter=H5,Qt.x=j5,Qt.y=K5;function J5(n){const e=+this._x.call(null,n),t=+this._y.call(null,n),r=+this._z.call(null,n);return Op(this.cover(e,t,r),e,t,r,n)}function Op(n,e,t,r,o){if(isNaN(e)||isNaN(t)||isNaN(r))return n;var a,u=n._root,h={data:o},c=n._x0,f=n._y0,p=n._z0,g=n._x1,m=n._y1,b=n._z1,_,$,C,S,I,T,A,N,D,L,q;if(!u)return n._root=h,n;for(;u.length;)if((A=e>=(_=(c+g)/2))?c=_:g=_,(N=t>=($=(f+m)/2))?f=$:m=$,(D=r>=(C=(p+b)/2))?p=C:b=C,a=u,!(u=u[L=D<<2|N<<1|A]))return a[L]=h,n;if(S=+n._x.call(null,u.data),I=+n._y.call(null,u.data),T=+n._z.call(null,u.data),e===S&&t===I&&r===T)return h.next=u,a?a[L]=h:n._root=h,n;do a=a?a[L]=new Array(8):n._root=new Array(8),(A=e>=(_=(c+g)/2))?c=_:g=_,(N=t>=($=(f+m)/2))?f=$:m=$,(D=r>=(C=(p+b)/2))?p=C:b=C;while((L=D<<2|N<<1|A)===(q=(T>=C)<<2|(I>=$)<<1|S>=_));return a[q]=u,a[L]=h,n}function Y5(n){Array.isArray(n)||(n=Array.from(n));const e=n.length,t=new Float64Array(e),r=new Float64Array(e),o=new Float64Array(e);let a=1/0,u=1/0,h=1/0,c=-1/0,f=-1/0,p=-1/0;for(let g=0,m,b,_,$;g<e;++g)isNaN(b=+this._x.call(null,m=n[g]))||isNaN(_=+this._y.call(null,m))||isNaN($=+this._z.call(null,m))||(t[g]=b,r[g]=_,o[g]=$,b<a&&(a=b),b>c&&(c=b),_<u&&(u=_),_>f&&(f=_),$<h&&(h=$),$>p&&(p=$));if(a>c||u>f||h>p)return this;this.cover(a,u,h).cover(c,f,p);for(let g=0;g<e;++g)Op(this,t[g],r[g],o[g],n[g]);return this}function Q5(n,e,t){if(isNaN(n=+n)||isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,o=this._y0,a=this._z0,u=this._x1,h=this._y1,c=this._z1;if(isNaN(r))u=(r=Math.floor(n))+1,h=(o=Math.floor(e))+1,c=(a=Math.floor(t))+1;else{for(var f=u-r||1,p=this._root,g,m;r>n||n>=u||o>e||e>=h||a>t||t>=c;)switch(m=(t<a)<<2|(e<o)<<1|n<r,g=new Array(8),g[m]=p,p=g,f*=2,m){case 0:u=r+f,h=o+f,c=a+f;break;case 1:r=u-f,h=o+f,c=a+f;break;case 2:u=r+f,o=h-f,c=a+f;break;case 3:r=u-f,o=h-f,c=a+f;break;case 4:u=r+f,h=o+f,a=c-f;break;case 5:r=u-f,h=o+f,a=c-f;break;case 6:u=r+f,o=h-f,a=c-f;break;case 7:r=u-f,o=h-f,a=c-f;break}this._root&&this._root.length&&(this._root=p)}return this._x0=r,this._y0=o,this._z0=a,this._x1=u,this._y1=h,this._z1=c,this}function X5(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function ex(n){return arguments.length?this.cover(+n[0][0],+n[0][1],+n[0][2]).cover(+n[1][0],+n[1][1],+n[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function at(n,e,t,r,o,a,u){this.node=n,this.x0=e,this.y0=t,this.z0=r,this.x1=o,this.y1=a,this.z1=u}function tx(n,e,t,r){var o,a=this._x0,u=this._y0,h=this._z0,c,f,p,g,m,b,_=this._x1,$=this._y1,C=this._z1,S=[],I=this._root,T,A;for(I&&S.push(new at(I,a,u,h,_,$,C)),r==null?r=1/0:(a=n-r,u=e-r,h=t-r,_=n+r,$=e+r,C=t+r,r*=r);T=S.pop();)if(!(!(I=T.node)||(c=T.x0)>_||(f=T.y0)>$||(p=T.z0)>C||(g=T.x1)<a||(m=T.y1)<u||(b=T.z1)<h))if(I.length){var N=(c+g)/2,D=(f+m)/2,L=(p+b)/2;S.push(new at(I[7],N,D,L,g,m,b),new at(I[6],c,D,L,N,m,b),new at(I[5],N,f,L,g,D,b),new at(I[4],c,f,L,N,D,b),new at(I[3],N,D,p,g,m,L),new at(I[2],c,D,p,N,m,L),new at(I[1],N,f,p,g,D,L),new at(I[0],c,f,p,N,D,L)),(A=(t>=L)<<2|(e>=D)<<1|n>=N)&&(T=S[S.length-1],S[S.length-1]=S[S.length-1-A],S[S.length-1-A]=T)}else{var q=n-+this._x.call(null,I.data),se=e-+this._y.call(null,I.data),we=t-+this._z.call(null,I.data),me=q*q+se*se+we*we;if(me<r){var ge=Math.sqrt(r=me);a=n-ge,u=e-ge,h=t-ge,_=n+ge,$=e+ge,C=t+ge,o=I.data}}return o}const nx=(n,e,t,r,o,a)=>Math.sqrt((n-r)**2+(e-o)**2+(t-a)**2);function rx(n,e,t,r){const o=[],a=n-r,u=e-r,h=t-r,c=n+r,f=e+r,p=t+r;return this.visit((g,m,b,_,$,C,S)=>{if(!g.length)do{const I=g.data;nx(n,e,t,this._x(I),this._y(I),this._z(I))<=r&&o.push(I)}while(g=g.next);return m>c||b>f||_>p||$<a||C<u||S<h}),o}function ix(n){if(isNaN(m=+this._x.call(null,n))||isNaN(b=+this._y.call(null,n))||isNaN(_=+this._z.call(null,n)))return this;var e,t=this._root,r,o,a,u=this._x0,h=this._y0,c=this._z0,f=this._x1,p=this._y1,g=this._z1,m,b,_,$,C,S,I,T,A,N,D;if(!t)return this;if(t.length)for(;;){if((I=m>=($=(u+f)/2))?u=$:f=$,(T=b>=(C=(h+p)/2))?h=C:p=C,(A=_>=(S=(c+g)/2))?c=S:g=S,e=t,!(t=t[N=A<<2|T<<1|I]))return this;if(!t.length)break;(e[N+1&7]||e[N+2&7]||e[N+3&7]||e[N+4&7]||e[N+5&7]||e[N+6&7]||e[N+7&7])&&(r=e,D=N)}for(;t.data!==n;)if(o=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,o?(a?o.next=a:delete o.next,this):e?(a?e[N]=a:delete e[N],(t=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&t===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[D]=t:this._root=t),this):(this._root=a,this)}function ox(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function sx(){return this._root}function ax(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function ux(n){var e=[],t,r=this._root,o,a,u,h,c,f,p;for(r&&e.push(new at(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=e.pop();)if(!n(r=t.node,a=t.x0,u=t.y0,h=t.z0,c=t.x1,f=t.y1,p=t.z1)&&r.length){var g=(a+c)/2,m=(u+f)/2,b=(h+p)/2;(o=r[7])&&e.push(new at(o,g,m,b,c,f,p)),(o=r[6])&&e.push(new at(o,a,m,b,g,f,p)),(o=r[5])&&e.push(new at(o,g,u,b,c,m,p)),(o=r[4])&&e.push(new at(o,a,u,b,g,m,p)),(o=r[3])&&e.push(new at(o,g,m,h,c,f,b)),(o=r[2])&&e.push(new at(o,a,m,h,g,f,b)),(o=r[1])&&e.push(new at(o,g,u,h,c,m,b)),(o=r[0])&&e.push(new at(o,a,u,h,g,m,b))}return this}function lx(n){var e=[],t=[],r;for(this._root&&e.push(new at(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=e.pop();){var o=r.node;if(o.length){var a,u=r.x0,h=r.y0,c=r.z0,f=r.x1,p=r.y1,g=r.z1,m=(u+f)/2,b=(h+p)/2,_=(c+g)/2;(a=o[0])&&e.push(new at(a,u,h,c,m,b,_)),(a=o[1])&&e.push(new at(a,m,h,c,f,b,_)),(a=o[2])&&e.push(new at(a,u,b,c,m,p,_)),(a=o[3])&&e.push(new at(a,m,b,c,f,p,_)),(a=o[4])&&e.push(new at(a,u,h,_,m,b,g)),(a=o[5])&&e.push(new at(a,m,h,_,f,b,g)),(a=o[6])&&e.push(new at(a,u,b,_,m,p,g)),(a=o[7])&&e.push(new at(a,m,b,_,f,p,g))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function cx(n){return n[0]}function hx(n){return arguments.length?(this._x=n,this):this._x}function fx(n){return n[1]}function dx(n){return arguments.length?(this._y=n,this):this._y}function px(n){return n[2]}function gx(n){return arguments.length?(this._z=n,this):this._z}function Np(n,e,t,r){var o=new Ol(e??cx,t??fx,r??px,NaN,NaN,NaN,NaN,NaN,NaN);return n==null?o:o.addAll(n)}function Ol(n,e,t,r,o,a,u,h,c){this._x=n,this._y=e,this._z=t,this._x0=r,this._y0=o,this._z0=a,this._x1=u,this._y1=h,this._z1=c,this._root=void 0}function Rp(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var Zt=Np.prototype=Ol.prototype;Zt.copy=function(){var n=new Ol(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=Rp(e),n;for(t=[{source:e,target:n._root=new Array(8)}];e=t.pop();)for(var o=0;o<8;++o)(r=e.source[o])&&(r.length?t.push({source:r,target:e.target[o]=new Array(8)}):e.target[o]=Rp(r));return n},Zt.add=J5,Zt.addAll=Y5,Zt.cover=Q5,Zt.data=X5,Zt.extent=ex,Zt.find=tx,Zt.findAllWithinRadius=rx,Zt.remove=ix,Zt.removeAll=ox,Zt.root=sx,Zt.size=ax,Zt.visit=ux,Zt.visitAfter=lx,Zt.x=hx,Zt.y=dx,Zt.z=gx;function Do(n){return function(){return n}}function fr(n){return(n()-.5)*1e-6}function mx(n){return n.index}function zp(n,e){var t=n.get(e);if(!t)throw new Error("node not found: "+e);return t}function vx(n){var e=mx,t=m,r,o=Do(30),a,u,h,c,f,p,g=1;n==null&&(n=[]);function m(S){return 1/Math.min(c[S.source.index],c[S.target.index])}function b(S){for(var I=0,T=n.length;I<g;++I)for(var A=0,N,D,L,q=0,se=0,we=0,me,ge;A<T;++A)N=n[A],D=N.source,L=N.target,q=L.x+L.vx-D.x-D.vx||fr(p),h>1&&(se=L.y+L.vy-D.y-D.vy||fr(p)),h>2&&(we=L.z+L.vz-D.z-D.vz||fr(p)),me=Math.sqrt(q*q+se*se+we*we),me=(me-a[A])/me*S*r[A],q*=me,se*=me,we*=me,L.vx-=q*(ge=f[A]),h>1&&(L.vy-=se*ge),h>2&&(L.vz-=we*ge),D.vx+=q*(ge=1-ge),h>1&&(D.vy+=se*ge),h>2&&(D.vz+=we*ge)}function _(){if(u){var S,I=u.length,T=n.length,A=new Map(u.map((D,L)=>[e(D,L,u),D])),N;for(S=0,c=new Array(I);S<T;++S)N=n[S],N.index=S,typeof N.source!="object"&&(N.source=zp(A,N.source)),typeof N.target!="object"&&(N.target=zp(A,N.target)),c[N.source.index]=(c[N.source.index]||0)+1,c[N.target.index]=(c[N.target.index]||0)+1;for(S=0,f=new Array(T);S<T;++S)N=n[S],f[S]=c[N.source.index]/(c[N.source.index]+c[N.target.index]);r=new Array(T),$(),a=new Array(T),C()}}function $(){if(u)for(var S=0,I=n.length;S<I;++S)r[S]=+t(n[S],S,n)}function C(){if(u)for(var S=0,I=n.length;S<I;++S)a[S]=+o(n[S],S,n)}return b.initialize=function(S,...I){u=S,p=I.find(T=>typeof T=="function")||Math.random,h=I.find(T=>[1,2,3].includes(T))||2,_()},b.links=function(S){return arguments.length?(n=S,_(),b):n},b.id=function(S){return arguments.length?(e=S,b):e},b.iterations=function(S){return arguments.length?(g=+S,b):g},b.strength=function(S){return arguments.length?(t=typeof S=="function"?S:Do(+S),$(),b):t},b.distance=function(S){return arguments.length?(o=typeof S=="function"?S:Do(+S),C(),b):o},b}var _x={value:()=>{}};function Dp(){for(var n=0,e=arguments.length,t={},r;n<e;++n){if(!(r=arguments[n]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new ta(t)}function ta(n){this._=n}function yx(n,e){return n.trim().split(/^|\s+/).map(function(t){var r="",o=t.indexOf(".");if(o>=0&&(r=t.slice(o+1),t=t.slice(0,o)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}ta.prototype=Dp.prototype={constructor:ta,on:function(n,e){var t=this._,r=yx(n+"",t),o,a=-1,u=r.length;if(arguments.length<2){for(;++a<u;)if((o=(n=r[a]).type)&&(o=bx(t[o],n.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<u;)if(o=(n=r[a]).type)t[o]=Lp(t[o],n.name,e);else if(e==null)for(o in t)t[o]=Lp(t[o],n.name,null);return this},copy:function(){var n={},e=this._;for(var t in e)n[t]=e[t].slice();return new ta(n)},call:function(n,e){if((o=arguments.length-2)>0)for(var t=new Array(o),r=0,o,a;r<o;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(a=this._[n],r=0,o=a.length;r<o;++r)a[r].value.apply(e,t)},apply:function(n,e,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],o=0,a=r.length;o<a;++o)r[o].value.apply(e,t)}};function bx(n,e){for(var t=0,r=n.length,o;t<r;++t)if((o=n[t]).name===e)return o.value}function Lp(n,e,t){for(var r=0,o=n.length;r<o;++r)if(n[r].name===e){n[r]=_x,n=n.slice(0,r).concat(n.slice(r+1));break}return t!=null&&n.push({name:e,value:t}),n}var qi=0,Lo=0,Bo=0,Bp=1e3,na,Fo,ra=0,ci=0,ia=0,Uo=typeof performance=="object"&&performance.now?performance:Date,Fp=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Up(){return ci||(Fp(wx),ci=Uo.now()+ia)}function wx(){ci=0}function Nl(){this._call=this._time=this._next=null}Nl.prototype=Zp.prototype={constructor:Nl,restart:function(n,e,t){if(typeof n!="function")throw new TypeError("callback is not a function");t=(t==null?Up():+t)+(e==null?0:+e),!this._next&&Fo!==this&&(Fo?Fo._next=this:na=this,Fo=this),this._call=n,this._time=t,Rl()},stop:function(){this._call&&(this._call=null,this._time=1/0,Rl())}};function Zp(n,e,t){var r=new Nl;return r.restart(n,e,t),r}function xx(){Up(),++qi;for(var n=na,e;n;)(e=ci-n._time)>=0&&n._call.call(void 0,e),n=n._next;--qi}function qp(){ci=(ra=Uo.now())+ia,qi=Lo=0;try{xx()}finally{qi=0,Sx(),ci=0}}function Tx(){var n=Uo.now(),e=n-ra;e>Bp&&(ia-=e,ra=n)}function Sx(){for(var n,e=na,t,r=1/0;e;)e._call?(r>e._time&&(r=e._time),n=e,e=e._next):(t=e._next,e._next=null,e=n?n._next=t:na=t);Fo=n,Rl(r)}function Rl(n){if(!qi){Lo&&(Lo=clearTimeout(Lo));var e=n-ci;e>24?(n<1/0&&(Lo=setTimeout(qp,n-Uo.now()-ia)),Bo&&(Bo=clearInterval(Bo))):(Bo||(ra=Uo.now(),Bo=setInterval(Tx,Bp)),qi=1,Fp(qp))}}const Mx=1664525,Ex=1013904223,Gp=4294967296;function Cx(){let n=1;return()=>(n=(Mx*n+Ex)%Gp)/Gp}var Hp=3;function zl(n){return n.x}function Wp(n){return n.y}function Ax(n){return n.z}var Ix=10,Px=Math.PI*(3-Math.sqrt(5)),kx=Math.PI*20/(9+Math.sqrt(221));function $x(n,e){e=e||2;var t=Math.min(Hp,Math.max(1,Math.round(e))),r,o=1,a=.001,u=1-Math.pow(a,1/300),h=0,c=.6,f=new Map,p=Zp(b),g=Dp("tick","end"),m=Cx();n==null&&(n=[]);function b(){_(),g.call("tick",r),o<a&&(p.stop(),g.call("end",r))}function _(S){var I,T=n.length,A;S===void 0&&(S=1);for(var N=0;N<S;++N)for(o+=(h-o)*u,f.forEach(function(D){D(o)}),I=0;I<T;++I)A=n[I],A.fx==null?A.x+=A.vx*=c:(A.x=A.fx,A.vx=0),t>1&&(A.fy==null?A.y+=A.vy*=c:(A.y=A.fy,A.vy=0)),t>2&&(A.fz==null?A.z+=A.vz*=c:(A.z=A.fz,A.vz=0));return r}function $(){for(var S=0,I=n.length,T;S<I;++S){if(T=n[S],T.index=S,T.fx!=null&&(T.x=T.fx),T.fy!=null&&(T.y=T.fy),T.fz!=null&&(T.z=T.fz),isNaN(T.x)||t>1&&isNaN(T.y)||t>2&&isNaN(T.z)){var A=Ix*(t>2?Math.cbrt(.5+S):t>1?Math.sqrt(.5+S):S),N=S*Px,D=S*kx;t===1?T.x=A:t===2?(T.x=A*Math.cos(N),T.y=A*Math.sin(N)):(T.x=A*Math.sin(N)*Math.cos(D),T.y=A*Math.cos(N),T.z=A*Math.sin(N)*Math.sin(D))}(isNaN(T.vx)||t>1&&isNaN(T.vy)||t>2&&isNaN(T.vz))&&(T.vx=0,t>1&&(T.vy=0),t>2&&(T.vz=0))}}function C(S){return S.initialize&&S.initialize(n,m,t),S}return $(),r={tick:_,restart:function(){return p.restart(b),r},stop:function(){return p.stop(),r},numDimensions:function(S){return arguments.length?(t=Math.min(Hp,Math.max(1,Math.round(S))),f.forEach(C),r):t},nodes:function(S){return arguments.length?(n=S,$(),f.forEach(C),r):n},alpha:function(S){return arguments.length?(o=+S,r):o},alphaMin:function(S){return arguments.length?(a=+S,r):a},alphaDecay:function(S){return arguments.length?(u=+S,r):+u},alphaTarget:function(S){return arguments.length?(h=+S,r):h},velocityDecay:function(S){return arguments.length?(c=1-S,r):1-c},randomSource:function(S){return arguments.length?(m=S,f.forEach(C),r):m},force:function(S,I){return arguments.length>1?(I==null?f.delete(S):f.set(S,C(I)),r):f.get(S)},find:function(){var S=Array.prototype.slice.call(arguments),I=S.shift()||0,T=(t>1?S.shift():null)||0,A=(t>2?S.shift():null)||0,N=S.shift()||1/0,D=0,L=n.length,q,se,we,me,ge,Xe;for(N*=N,D=0;D<L;++D)ge=n[D],q=I-ge.x,se=T-(ge.y||0),we=A-(ge.z||0),me=q*q+se*se+we*we,me<N&&(Xe=ge,N=me);return Xe},on:function(S,I){return arguments.length>1?(g.on(S,I),r):g.on(S)}}}function Ox(){var n,e,t,r,o,a=Do(-30),u,h=1,c=1/0,f=.81;function p(_){var $,C=n.length,S=(e===1?Ap(n,zl):e===2?kp(n,zl,Wp):e===3?Np(n,zl,Wp,Ax):null).visitAfter(m);for(o=_,$=0;$<C;++$)t=n[$],S.visit(b)}function g(){if(n){var _,$=n.length,C;for(u=new Array($),_=0;_<$;++_)C=n[_],u[C.index]=+a(C,_,n)}}function m(_){var $=0,C,S,I=0,T,A,N,D,L=_.length;if(L){for(T=A=N=D=0;D<L;++D)(C=_[D])&&(S=Math.abs(C.value))&&($+=C.value,I+=S,T+=S*(C.x||0),A+=S*(C.y||0),N+=S*(C.z||0));$*=Math.sqrt(4/L),_.x=T/I,e>1&&(_.y=A/I),e>2&&(_.z=N/I)}else{C=_,C.x=C.data.x,e>1&&(C.y=C.data.y),e>2&&(C.z=C.data.z);do $+=u[C.data.index];while(C=C.next)}_.value=$}function b(_,$,C,S,I){if(!_.value)return!0;var T=[C,S,I][e-1],A=_.x-t.x,N=e>1?_.y-t.y:0,D=e>2?_.z-t.z:0,L=T-$,q=A*A+N*N+D*D;if(L*L/f<q)return q<c&&(A===0&&(A=fr(r),q+=A*A),e>1&&N===0&&(N=fr(r),q+=N*N),e>2&&D===0&&(D=fr(r),q+=D*D),q<h&&(q=Math.sqrt(h*q)),t.vx+=A*_.value*o/q,e>1&&(t.vy+=N*_.value*o/q),e>2&&(t.vz+=D*_.value*o/q)),!0;if(_.length||q>=c)return;(_.data!==t||_.next)&&(A===0&&(A=fr(r),q+=A*A),e>1&&N===0&&(N=fr(r),q+=N*N),e>2&&D===0&&(D=fr(r),q+=D*D),q<h&&(q=Math.sqrt(h*q)));do _.data!==t&&(L=u[_.data.index]*o/q,t.vx+=A*L,e>1&&(t.vy+=N*L),e>2&&(t.vz+=D*L));while(_=_.next)}return p.initialize=function(_,...$){n=_,r=$.find(C=>typeof C=="function")||Math.random,e=$.find(C=>[1,2,3].includes(C))||2,g()},p.strength=function(_){return arguments.length?(a=typeof _=="function"?_:Do(+_),g(),p):a},p.distanceMin=function(_){return arguments.length?(h=_*_,p):Math.sqrt(h)},p.distanceMax=function(_){return arguments.length?(c=_*_,p):Math.sqrt(c)},p.theta=function(_){return arguments.length?(f=_*_,p):Math.sqrt(f)},p}function Dl(n){return typeof n=="object"&&n!==null&&"index"in n&&typeof n.index=="number"&&"x"in n&&typeof n.x=="number"&&"y"in n&&typeof n.y=="number"&&"z"in n&&typeof n.z=="number"&&"vx"in n&&typeof n.vx=="number"&&"vy"in n&&typeof n.vy=="number"&&"vz"in n&&typeof n.vz=="number"}const Nx=ke({alphaMin:K().positive().default(.1),alphaTarget:K().min(0).default(0),alphaDecay:K().positive().default(.0228),velocityDecay:K().positive().default(.4)});function Rx(n){return!!(typeof n=="object"&&n!==null&&Object.hasOwn(n,"index")&&"index"in n&&typeof n.index=="number"&&"source"in n&&Dl(n.source)&&"target"in n&&Dl(n.target))}const Ta=class Ta extends vt{constructor(e={}){super(),this.nodeMapping=new Map,this.edgeMapping=new Map,this.newNodeMap=new Map,this.newEdgeMap=new Map,this.reheat=!1;const t=Nx.parse(e);this.d3AlphaMin=t.alphaMin,this.d3AlphaTarget=t.alphaTarget,this.d3AlphaDecay=t.alphaDecay,this.d3VelocityDecay=t.velocityDecay;const r=vx();r.strength(.9),this.d3ForceLayout=$x().numDimensions(3).alpha(1).force("link",r).force("charge",Ox()).force("center",y5()).force("dagRadial",null).stop(),this.d3ForceLayout.force("link").id(o=>o.id)}get graphNeedsRefresh(){return!!this.newNodeMap.size||!!this.newEdgeMap.size}async init(){}refresh(){if(this.graphNeedsRefresh||this.reheat){let e=[...this.nodeMapping.values()];e=e.concat([...this.newNodeMap.values()]),this.d3ForceLayout.alpha(1).nodes(e).stop();for(const r of this.newNodeMap.entries()){const o=r[0],a=r[1];if(!Dl(a))throw new Error("Internal error: Node is not settled as a complete D3 Node");this.nodeMapping.set(o,a)}this.newNodeMap.clear();let t=[...this.edgeMapping.values()];t=t.concat([...this.newEdgeMap.values()]),this.d3ForceLayout.force("link").links(t);for(const r of this.newEdgeMap.entries()){const o=r[0],a=r[1];if(!Rx(a))throw new Error("Internal error: Edge is not settled as a complete D3 Edge");this.edgeMapping.set(o,a)}this.newEdgeMap.clear()}}step(){this.refresh(),this.d3ForceLayout.tick()}get isSettled(){return this.d3ForceLayout.alpha()<this.d3AlphaMin}addNode(e){this.newNodeMap.set(e,{id:e.id})}addEdge(e){this.newEdgeMap.set(e,{source:e.srcId,target:e.dstId})}get nodes(){return this.nodeMapping.keys()}get edges(){return this.edgeMapping.keys()}getNodePosition(e){const t=this._getMappedNode(e);return{x:t.x,y:t.y,z:t.z}}setNodePosition(e,t){const r=this._getMappedNode(e);r.x=t.x,r.y=t.y,r.z=t.z??0,this.reheat=!0}getEdgePosition(e){const t=this._getMappedEdge(e);return{src:{x:t.source.x,y:t.source.y,z:t.source.z},dst:{x:t.target.x,y:t.target.y,z:t.target.z}}}pin(e){const t=this._getMappedNode(e);t.fx=t.x,t.fy=t.y,t.fz=t.z,this.reheat=!0}unpin(e){const t=this._getMappedNode(e);t.fx=void 0,t.fy=void 0,t.fz=void 0,this.reheat=!0}_getMappedNode(e){this.refresh();const t=this.nodeMapping.get(e);if(!t)throw new Error("Internal error: Node not found in D3GraphEngine");return t}_getMappedEdge(e){this.refresh();const t=this.edgeMapping.get(e);if(!t)throw new Error("Internal error: Edge not found in D3GraphEngine");return t}};Ta.type="d3",Ta.maxDimensions=3;let Ll=Ta;const zx=ke({...ln.shape,pos:cr(K(),it(K()).min(2).max(3)).or(Ye()).default(null),maxIter:K().positive().default(100),jitterTolerance:K().positive().default(1),scalingRatio:K().positive().default(2),gravity:K().positive().default(1),distributedAction:wt().default(!1),strongGravity:wt().default(!1),nodeMass:cr(K(),K()).or(Ye()).default(null),nodeSize:cr(K(),K()).or(Ye()).default(null),weightPath:Ge().or(Ye()).default(null),dissuadeHubs:wt().default(!1),linlog:wt().default(!1),seed:K().or(Ye()).default(null),dim:K().default(2)}),Sa=class Sa extends Sn{constructor(e){super(e),this.scalingFactor=100,this.config=zx.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=d5({nodes:e,edges:t},this.config.pos,this.config.maxIter,this.config.jitterTolerance,this.config.scalingRatio,this.config.gravity,this.config.distributedAction,this.config.strongGravity,this.config.nodeMass,this.config.nodeSize,this.config.weightPath,this.config.dissuadeHubs,this.config.linlog,this.config.seed,this.config.dim)}};Sa.type="forceatlas2",Sa.maxDimensions=3;let Bl=Sa;const Dx=ke({...ln.shape,dist:cr(K(),cr(K(),K())).or(Ye()).default(null),pos:cr(K(),it(K()).min(1).max(3)).or(Ye()).default(null),weightProperty:Ge().optional(),scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null),dim:K().default(3)}),Ma=class Ma extends Sn{constructor(e){super(e),this.scalingFactor=50,this.config=Dx.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=u5({nodes:e,edges:t},this.config.dist,this.config.pos,this.config.weightProperty,this.config.scale,this.config.center,this.config.dim)}};Ma.type="kamada-kawai",Ma.maxDimensions=3;let Fl=Ma;const Lx=ke({...ln.shape,subsetKey:cr(Ge(),it(Ge().or(K()))),align:Rt(["vertical","horizontal"]).default("vertical"),scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null)}),Ea=class Ea extends Sn{constructor(e){super(e),this.scalingFactor=40,this.config=Lx.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=Ep({nodes:e,edges:t},this.config.subsetKey,this.config.align,this.config.scale,this.config.center)}};Ea.type="multipartite",Ea.maxDimensions=2;let Ul=Ea;var oa={exports:{}},Gi={exports:{}},Zl,jp;function Vp(){return jp||(jp=1,Zl=function(e){return e===0?"x":e===1?"y":e===2?"z":"c"+(e+1)}),Zl}var ql,Kp;function Hi(){if(Kp)return ql;Kp=1;const n=Vp();return ql=function(t){return r;function r(o,a){let u=a&&a.indent||0,h=a&&a.join!==void 0?a.join:`
`,c=Array(u+1).join(" "),f=[];for(let p=0;p<t;++p){let g=n(p),m=p===0?"":c;f.push(m+o.replace(/{var}/g,g))}return f.join(h)}},ql}var Jp;function Bx(){if(Jp)return Gi.exports;Jp=1;const n=Hi();Gi.exports=e,Gi.exports.generateCreateBodyFunctionBody=t,Gi.exports.getVectorCode=o,Gi.exports.getBodyCode=r;function e(a,u){let h=t(a,u),{Body:c}=new Function(h)();return c}function t(a,u){return`
${o(a,u)}
${r(a)}
return {Body: Body, Vector: Vector};
`}function r(a){let u=n(a),h=u("{var}",{join:", "});return`
function Body(${h}) {
  this.isPinned = false;
  this.pos = new Vector(${h});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${h}) {
  ${u("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function o(a,u){let h=n(a),c="";return u&&(c=`${h(`
	   var v{var};
	Object.defineProperty(this, '{var}', {
	  set: function(v) { 
	    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
	    v{var} = v; 
	  },
	  get: function() { return v{var}; }
	});`)}`),`function Vector(${h("{var}",{join:", "})}) {
  ${c}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${h('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${h("this.{var} = v.{var};",{indent:4})}
    } else {
      ${h('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${h("this.{var} = ",{join:""})}0;
  };`}return Gi.exports}var dr={exports:{}},Yp;function Fx(){if(Yp)return dr.exports;Yp=1;const n=Hi(),e=Vp();dr.exports=t,dr.exports.generateQuadTreeFunctionBody=r,dr.exports.getInsertStackCode=c,dr.exports.getQuadNodeCode=h,dr.exports.isSamePosition=o,dr.exports.getChildBodyCode=u,dr.exports.setChildBodyCode=a;function t(f){let p=r(f);return new Function(p)()}function r(f){let p=n(f),g=Math.pow(2,f);return`
${c()}
${h(f)}
${o(f)}
${u(f)}
${a(f)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${$("      node.")}
      node.body = null;
      node.mass = ${p("node.mass_{var} = ",{join:""})}0;
      ${p("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${p("var d{var};",{indent:4})}
    var r; 
    ${p("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${p("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${p("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${p("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${p("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${p("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${p("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${p("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${p("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${p("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < θ, treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${e(0)} - node.min_${e(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${p("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${_()}
        }
      }
    }

    ${p("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${p("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${p("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${p("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${p("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${p("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${p("root.min_{var} = {var}min;",{indent:4})}
    ${p("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${p("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${p("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${p("var min_{var} = node.min_{var};",{indent:8})}
        ${p("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${b(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${p("child.min_{var} = min_{var};",{indent:10})}
          ${p("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${p("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${p("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function b(C){let S=[],I=Array(C+1).join(" ");for(let T=0;T<f;++T)S.push(I+`if (${e(T)} > max_${e(T)}) {`),S.push(I+`  quadIdx = quadIdx + ${Math.pow(2,T)};`),S.push(I+`  min_${e(T)} = max_${e(T)};`),S.push(I+`  max_${e(T)} = node.max_${e(T)};`),S.push(I+"}");return S.join(`
`)}function _(){let C=Array(11).join(" "),S=[];for(let I=0;I<g;++I)S.push(C+`if (node.quad${I}) {`),S.push(C+`  queue[pushIdx] = node.quad${I};`),S.push(C+"  queueLength += 1;"),S.push(C+"  pushIdx += 1;"),S.push(C+"}");return S.join(`
`)}function $(C){let S=[];for(let I=0;I<g;++I)S.push(`${C}quad${I} = null;`);return S.join(`
`)}}function o(f){let p=n(f);return`
  function isSamePosition(point1, point2) {
    ${p("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${p("d{var} < 1e-8",{join:" && "})};
  }  
`}function a(f){var p=Math.pow(2,f);return`
function setChild(node, idx, child) {
  ${g()}
}`;function g(){let m=[];for(let b=0;b<p;++b){let _=b===0?"  ":"  else ";m.push(`${_}if (idx === ${b}) node.quad${b} = child;`)}return m.join(`
`)}}function u(f){return`function getChild(node, idx) {
${p()}
  return null;
}`;function p(){let g=[],m=Math.pow(2,f);for(let b=0;b<m;++b)g.push(`  if (idx === ${b}) return node.quad${b};`);return g.join(`
`)}}function h(f){let p=n(f),g=Math.pow(2,f);var m=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${b("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${p("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${p("this.min_{var} = 0;",{indent:2})}
  ${p("this.max_{var} = 0;",{indent:2})}
}
`;return m;function b(_){let $=[];for(let C=0;C<g;++C)$.push(`${_}quad${C} = null;`);return $.join(`
`)}}function c(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}return dr.exports}var sa={exports:{}},Qp;function Ux(){if(Qp)return sa.exports;Qp=1,sa.exports=e,sa.exports.generateFunctionBody=t;const n=Hi();function e(r){let o=t(r);return new Function("bodies","settings","random",o)}function t(r){let o=n(r);return`
  var boundingBox = {
    ${o("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${o("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${o("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${o("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${o("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${o("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${o("var max_{var} = -Infinity;",{indent:4})}
    ${o("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${o("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${o("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${o("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${o("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${o("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}return sa.exports}var aa={exports:{}},Xp;function Zx(){if(Xp)return aa.exports;Xp=1;const n=Hi();aa.exports=e,aa.exports.generateCreateDragForceFunctionBody=t;function e(r){let o=t(r);return new Function("options",o)}function t(r){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${n(r)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}return aa.exports}var ua={exports:{}},e0;function qx(){if(e0)return ua.exports;e0=1;const n=Hi();ua.exports=e,ua.exports.generateCreateSpringForceFunctionBody=t;function e(r){let o=t(r);return new Function("options","random",o)}function t(r){let o=n(r);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${o("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${o("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${o("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${o("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${o("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${o("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}return ua.exports}var la={exports:{}},t0;function Gx(){if(t0)return la.exports;t0=1;const n=Hi();la.exports=e,la.exports.generateIntegratorFunctionBody=t;function e(r){let o=t(r);return new Function("bodies","timeStep","adaptiveTimeStepWeight",o)}function t(r){let o=n(r);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${o("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${o("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${o("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${o("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${o("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${o("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${o("body.pos.{var} += d{var};",{indent:4})}

    ${o("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${o("t{var} * t{var}",{join:" + "})})/length;
`}return la.exports}var Gl,n0;function Hx(){if(n0)return Gl;n0=1,Gl=n;function n(e,t,r,o){this.from=e,this.to=t,this.length=r,this.coefficient=o}return Gl}var Hl,r0;function Wx(){if(r0)return Hl;r0=1,Hl=n;function n(e,t){var r;if(e||(e={}),t){for(r in t)if(t.hasOwnProperty(r)){var o=e.hasOwnProperty(r),a=typeof t[r],u=!o||typeof e[r]!==a;u?e[r]=t[r]:a==="object"&&(e[r]=n(e[r],t[r]))}}return e}return Hl}var Wl,i0;function jl(){if(i0)return Wl;i0=1,Wl=function(r){e(r);var o=n(r);return r.on=o.on,r.off=o.off,r.fire=o.fire,r};function n(t){var r=Object.create(null);return{on:function(o,a,u){if(typeof a!="function")throw new Error("callback is expected to be a function");var h=r[o];return h||(h=r[o]=[]),h.push({callback:a,ctx:u}),t},off:function(o,a){var u=typeof o>"u";if(u)return r=Object.create(null),t;if(r[o]){var h=typeof a!="function";if(h)delete r[o];else for(var c=r[o],f=0;f<c.length;++f)c[f].callback===a&&c.splice(f,1)}return t},fire:function(o){var a=r[o];if(!a)return t;var u;arguments.length>1&&(u=Array.prototype.splice.call(arguments,1));for(var h=0;h<a.length;++h){var c=a[h];c.callback.apply(c.ctx,u)}return t}}}function e(t){if(!t)throw new Error("Eventify cannot use falsy object as events subject");for(var r=["on","fire","off"],o=0;o<r.length;++o)if(t.hasOwnProperty(r[o]))throw new Error("Subject cannot be eventified, since it already has property '"+r[o]+"'")}return Wl}var Zo={exports:{}},o0;function jx(){if(o0)return Zo.exports;o0=1,Zo.exports=n,Zo.exports.random=n,Zo.exports.randomIterator=h;function n(c){var f=typeof c=="number"?c:+new Date;return new e(f)}function e(c){this.seed=c}e.prototype.next=u,e.prototype.nextDouble=a,e.prototype.uniform=a,e.prototype.gaussian=t,e.prototype.random=a;function t(){var c,f,p;do f=this.nextDouble()*2-1,p=this.nextDouble()*2-1,c=f*f+p*p;while(c>=1||c===0);return f*Math.sqrt(-2*Math.log(c)/c)}e.prototype.levy=r;function r(){var c=1.5,f=Math.pow(o(1+c)*Math.sin(Math.PI*c/2)/(o((1+c)/2)*c*Math.pow(2,(c-1)/2)),1/c);return this.gaussian()*f/Math.pow(Math.abs(this.gaussian()),1/c)}function o(c){return Math.sqrt(2*Math.PI/c)*Math.pow(1/Math.E*(c+1/(12*c-1/(10*c))),c)}function a(){var c=this.seed;return c=c+2127912214+(c<<12)&4294967295,c=(c^3345072700^c>>>19)&4294967295,c=c+374761393+(c<<5)&4294967295,c=(c+3550635116^c<<9)&4294967295,c=c+4251993797+(c<<3)&4294967295,c=(c^3042594569^c>>>16)&4294967295,this.seed=c,(c&268435455)/268435456}function u(c){return Math.floor(this.nextDouble()*c)}function h(c,f){var p=f||n();if(typeof p.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:m,shuffle:g};function g(){var b,_,$;for(b=c.length-1;b>0;--b)_=p.next(b+1),$=c[_],c[_]=c[b],c[b]=$;return c}function m(b){var _,$,C;for(_=c.length-1;_>0;--_)$=p.next(_+1),C=c[$],c[$]=c[_],c[_]=C,b(C);c.length&&b(c[0])}}return Zo.exports}var Vl,s0;function a0(){if(s0)return Vl;s0=1,Vl=h;var n=Bx(),e=Fx(),t=Ux(),r=Zx(),o=qx(),a=Gx(),u={};function h(p){var g=Hx(),m=Wx(),b=jl();if(p){if(p.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(p.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}p=m(p,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var _=u[p.dimensions];if(!_){var $=p.dimensions;_={Body:n($,p.debug),createQuadTree:e($),createBounds:t($),createDragForce:r($),createSpringForce:o($),integrate:a($)},u[$]=_}var C=_.Body,S=_.createQuadTree,I=_.createBounds,T=_.createDragForce,A=_.createSpringForce,N=_.integrate,D=ue=>new C(ue),L=jx().random(42),q=[],se=[],we=S(p,L),me=I(q,p,L),ge=A(p,L),Xe=T(p),Ue=0,ut=[],Ve=new Map,ne=0;he("nbody",Le),he("spring",Qe);var ae={bodies:q,quadTree:we,springs:se,settings:p,addForce:he,removeForce:_e,getForces:Te,step:function(){for(var ue=0;ue<ut.length;++ue)ut[ue](ne);var te=N(q,p.timeStep,p.adaptiveTimeStepWeight);return ne+=1,te},addBody:function(ue){if(!ue)throw new Error("Body is required");return q.push(ue),ue},addBodyAt:function(ue){if(!ue)throw new Error("Body position is required");var te=D(ue);return q.push(te),te},removeBody:function(ue){if(ue){var te=q.indexOf(ue);if(!(te<0))return q.splice(te,1),q.length===0&&me.reset(),!0}},addSpring:function(ue,te,U,j){if(!ue||!te)throw new Error("Cannot add null spring to force simulator");typeof U!="number"&&(U=-1);var Y=new g(ue,te,U,j>=0?j:-1);return se.push(Y),Y},getTotalMovement:function(){return Ue},removeSpring:function(ue){if(ue){var te=se.indexOf(ue);if(te>-1)return se.splice(te,1),!0}},getBestNewBodyPosition:function(ue){return me.getBestNewPosition(ue)},getBBox:ie,getBoundingBox:ie,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(ue){return ue!==void 0?(p.gravity=ue,we.options({gravity:ue}),this):p.gravity},theta:function(ue){return ue!==void 0?(p.theta=ue,we.options({theta:ue}),this):p.theta},random:L};return c(p,ae),b(ae),ae;function ie(){return me.update(),me.box}function he(ue,te){if(Ve.has(ue))throw new Error("Force "+ue+" is already added");Ve.set(ue,te),ut.push(te)}function _e(ue){var te=ut.indexOf(Ve.get(ue));te<0||(ut.splice(te,1),Ve.delete(ue))}function Te(){return Ve}function Le(){if(q.length!==0){we.insertBodies(q);for(var ue=q.length;ue--;){var te=q[ue];te.isPinned||(te.reset(),we.updateBodyForce(te),Xe.update(te))}}}function Qe(){for(var ue=se.length;ue--;)ge.update(se[ue])}}function c(p,g){for(var m in p)f(p,g,m)}function f(p,g,m){if(p.hasOwnProperty(m)&&typeof g[m]!="function"){var b=Number.isFinite(p[m]);b?g[m]=function(_){if(_!==void 0){if(!Number.isFinite(_))throw new Error("Value of "+m+" should be a valid number.");return p[m]=_,g}return p[m]}:g[m]=function(_){return _!==void 0?(p[m]=_,g):p[m]}}}return Vl}var u0;function Vx(){if(u0)return oa.exports;u0=1,oa.exports=e,oa.exports.simulator=a0();var n=jl();function e(r,o){if(!r)throw new Error("Graph structure cannot be undefined");var a=o&&o.createSimulator||a0(),u=a(o);if(Array.isArray(o))throw new Error("Physics settings is expected to be an object");var h=r.version>19?Ve:ut;o&&typeof o.nodeMass=="function"&&(h=o.nodeMass);var c=new Map,f={},p=0,g=u.settings.springTransform||t;D(),T();var m=!1,b={step:function(){if(p===0)return _(!0),!0;var ne=u.step();b.lastMove=ne,b.fire("step");var ae=ne/p,ie=ae<=.01;return _(ie),ie},getNodePosition:function(ne){return Ue(ne).pos},setNodePosition:function(ne){var ae=Ue(ne);ae.setPosition.apply(ae,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(ne){var ae=f[ne];if(ae)return{from:ae.from.pos,to:ae.to.pos}},getGraphRect:function(){return u.getBBox()},forEachBody:$,pinNode:function(ne,ae){var ie=Ue(ne.id);ie.isPinned=!!ae},isNodePinned:function(ne){return Ue(ne.id).isPinned},dispose:function(){r.off("changed",N),b.fire("disposed")},getBody:I,getSpring:S,getForceVectorLength:C,simulator:u,graph:r,lastMove:0};return n(b),b;function _(ne){m!==ne&&(m=ne,A(ne))}function $(ne){c.forEach(ne)}function C(){var ne=0,ae=0;return $(function(ie){ne+=Math.abs(ie.force.x),ae+=Math.abs(ie.force.y)}),Math.sqrt(ne*ne+ae*ae)}function S(ne,ae){var ie;if(ae===void 0)typeof ne!="object"?ie=ne:ie=ne.id;else{var he=r.hasLink(ne,ae);if(!he)return;ie=he.id}return f[ie]}function I(ne){return c.get(ne)}function T(){r.on("changed",N)}function A(ne){b.fire("stable",ne)}function N(ne){for(var ae=0;ae<ne.length;++ae){var ie=ne[ae];ie.changeType==="add"?(ie.node&&L(ie.node.id),ie.link&&se(ie.link)):ie.changeType==="remove"&&(ie.node&&q(ie.node),ie.link&&we(ie.link))}p=r.getNodesCount()}function D(){p=0,r.forEachNode(function(ne){L(ne.id),p+=1}),r.forEachLink(se)}function L(ne){var ae=c.get(ne);if(!ae){var ie=r.getNode(ne);if(!ie)throw new Error("initBody() was called with unknown node id");var he=ie.position;if(!he){var _e=me(ie);he=u.getBestNewBodyPosition(_e)}ae=u.addBodyAt(he),ae.id=ne,c.set(ne,ae),ge(ne),Xe(ie)&&(ae.isPinned=!0)}}function q(ne){var ae=ne.id,ie=c.get(ae);ie&&(c.delete(ae),u.removeBody(ie))}function se(ne){ge(ne.fromId),ge(ne.toId);var ae=c.get(ne.fromId),ie=c.get(ne.toId),he=u.addSpring(ae,ie,ne.length);g(ne,he),f[ne.id]=he}function we(ne){var ae=f[ne.id];if(ae){var ie=r.getNode(ne.fromId),he=r.getNode(ne.toId);ie&&ge(ie.id),he&&ge(he.id),delete f[ne.id],u.removeSpring(ae)}}function me(ne){var ae=[];if(!ne.links)return ae;for(var ie=Math.min(ne.links.length,2),he=0;he<ie;++he){var _e=ne.links[he],Te=_e.fromId!==ne.id?c.get(_e.fromId):c.get(_e.toId);Te&&Te.pos&&ae.push(Te)}return ae}function ge(ne){var ae=c.get(ne);if(ae.mass=h(ne),Number.isNaN(ae.mass))throw new Error("Node mass should be a number")}function Xe(ne){return ne&&(ne.isPinned||ne.data&&ne.data.isPinned)}function Ue(ne){var ae=c.get(ne);return ae||(L(ne),ae=c.get(ne)),ae}function ut(ne){var ae=r.getLinks(ne);return ae?1+ae.length/3:1}function Ve(ne){var ae=r.getLinks(ne);return ae?1+ae.size/3:1}}function t(){}return oa.exports}var Kx=Vx();const Jx=No(Kx);var Kl,l0;function Yx(){if(l0)return Kl;l0=1,Kl=e;var n=jl();function e(u){if(u=u||{},"uniqueLinkId"in u&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),u.multigraph=u.uniqueLinkId),u.multigraph===void 0&&(u.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var h=new Map,c=new Map,f={},p=0,g=u.multigraph?we:se,m=[],b=Te,_=Te,$=Te,C=Te,S={version:20,addNode:N,addLink:q,removeLink:Ue,removeNode:L,getNode:D,getNodeCount:me,getLinkCount:ge,getEdgeCount:ge,getLinksCount:ge,getNodesCount:me,getLinks:Xe,forEachNode:ue,forEachLinkedNode:ie,forEachLink:ae,beginUpdate:$,endUpdate:C,clear:ne,hasLink:Ve,hasNode:D,getLink:Ve};return n(S),I(),S;function I(){var te=S.on;S.on=U;function U(){return S.beginUpdate=$=Le,S.endUpdate=C=Qe,b=T,_=A,S.on=te,te.apply(S,arguments)}}function T(te,U){m.push({link:te,changeType:U})}function A(te,U){m.push({node:te,changeType:U})}function N(te,U){if(te===void 0)throw new Error("Invalid node identifier");$();var j=D(te);return j?(j.data=U,_(j,"update")):(j=new t(te,U),_(j,"add")),h.set(te,j),C(),j}function D(te){return h.get(te)}function L(te){var U=D(te);if(!U)return!1;$();var j=U.links;return j&&(j.forEach(ut),U.links=null),h.delete(te),_(U,"remove"),C(),!0}function q(te,U,j){$();var Y=D(te)||N(te),fe=D(U)||N(U),xe=g(te,U,j),He=c.has(xe.id);return c.set(xe.id,xe),r(Y,xe),te!==U&&r(fe,xe),b(xe,He?"update":"add"),C(),xe}function se(te,U,j){var Y=a(te,U),fe=c.get(Y);return fe?(fe.data=j,fe):new o(te,U,j,Y)}function we(te,U,j){var Y=a(te,U),fe=f.hasOwnProperty(Y);if(fe||Ve(te,U)){fe||(f[Y]=0);var xe="@"+ ++f[Y];Y=a(te+xe,U+xe)}return new o(te,U,j,Y)}function me(){return h.size}function ge(){return c.size}function Xe(te){var U=D(te);return U?U.links:null}function Ue(te,U){return U!==void 0&&(te=Ve(te,U)),ut(te)}function ut(te){if(!te||!c.get(te.id))return!1;$(),c.delete(te.id);var U=D(te.fromId),j=D(te.toId);return U&&U.links.delete(te),j&&j.links.delete(te),b(te,"remove"),C(),!0}function Ve(te,U){if(!(te===void 0||U===void 0))return c.get(a(te,U))}function ne(){$(),ue(function(te){L(te.id)}),C()}function ae(te){if(typeof te=="function")for(var U=c.values(),j=U.next();!j.done;){if(te(j.value))return!0;j=U.next()}}function ie(te,U,j){var Y=D(te);if(Y&&Y.links&&typeof U=="function")return j?_e(Y.links,te,U):he(Y.links,te,U)}function he(te,U,j){for(var Y,fe=te.values(),xe=fe.next();!xe.done;){var He=xe.value,Tt=He.fromId===U?He.toId:He.fromId;if(Y=j(h.get(Tt),He),Y)return!0;xe=fe.next()}}function _e(te,U,j){for(var Y,fe=te.values(),xe=fe.next();!xe.done;){var He=xe.value;if(He.fromId===U&&(Y=j(h.get(He.toId),He),Y))return!0;xe=fe.next()}}function Te(){}function Le(){p+=1}function Qe(){p-=1,p===0&&m.length>0&&(S.fire("changed",m),m.length=0)}function ue(te){if(typeof te!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+te);for(var U=h.values(),j=U.next();!j.done;){if(te(j.value))return!0;j=U.next()}}}function t(u,h){this.id=u,this.links=null,this.data=h}function r(u,h){u.links?u.links.add(h):u.links=new Set([h])}function o(u,h,c,f){this.fromId=u,this.toId=h,this.data=c,this.id=f}function a(u,h){return u.toString()+"👉 "+h.toString()}return Kl}var Qx=Yx();const Xx=No(Qx),Ca=class Ca extends vt{constructor(){super(),this.nodeMapping=new Map,this.edgeMapping=new Map,this._settled=!0,this.ngraph=Xx(),this.ngraphLayout=Jx(this.ngraph,{dimensions:3})}async init(){}step(){this._settled=this.ngraphLayout.step()}get isSettled(){return this._settled}addNode(e){const t=this.ngraph.addNode(e.id,{parentNode:e});this.nodeMapping.set(e,t),this._settled=!1}addEdge(e){const t=this.ngraph.addLink(e.srcId,e.dstId,{parentEdge:this});this.edgeMapping.set(e,t),this._settled=!1}getNodePosition(e){const t=this._getMappedNode(e);return this.ngraphLayout.getNodePosition(t.id)}setNodePosition(e,t){const r=this._getMappedNode(e),o=this.ngraphLayout.getNodePosition(r.id);o.x=t.x,o.y=t.y,o.z=t.z}getEdgePosition(e){const t=this._getMappedEdge(e),r=this.ngraphLayout.getLinkPosition(t.id);return{src:{x:r.from.x,y:r.from.y,z:r.from.z},dst:{x:r.to.x,y:r.to.y,z:r.to.z}}}get nodes(){return this.nodeMapping.keys()}get edges(){return this.edgeMapping.keys()}pin(e){const t=this._getMappedNode(e);this.ngraphLayout.pinNode(t,!0)}unpin(e){const t=this._getMappedNode(e);this.ngraphLayout.pinNode(t,!1)}_getMappedNode(e){const t=this.nodeMapping.get(e);if(!t)throw new Error("Internal error: Node not found in NGraphEngine");return t}_getMappedEdge(e){const t=this.edgeMapping.get(e);if(!t)throw new Error("Internal error: Edge not found in NGraphEngine");return t}};Ca.type="ngraph",Ca.maxDimensions=3;let Jl=Ca;const eT=ke({...ln.shape,scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null),dim:K().default(2)}),Aa=class Aa extends Sn{constructor(e){super(e),this.scalingFactor=70,this.config=eT.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=e5({nodes:e,edges:t},this.config.scale,this.config.center,this.config.dim)}};Aa.type="planar",Aa.maxDimensions=2;let Yl=Aa;const tT=ke({...ln.shape,center:it(K()).length(2).or(Ye()).default(null),dim:K().default(2),seed:K().positive().or(Ye()).default(null)}),Ia=class Ia extends Sn{constructor(e){super(e),this.scalingFactor=100,this.config=tT.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=xl({nodes:e,edges:t},this.config.center,this.config.dim,this.config.seed)}};Ia.type="random",Ia.maxDimensions=3;let Ql=Ia;const nT=ke({...ln.shape,nlist:it(it(K())).or(Ye()).default(null),dim:K().default(2),center:it(K()).length(2).or(Ye()).default(null),scale:K().positive().default(1)}),Pa=class Pa extends Sn{constructor(e){super(e),this.scalingFactor=100,this.config=nT.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=jw({nodes:e,edges:t},this.config.nlist,this.config.scale,this.config.center,this.config.dim)}};Pa.type="shell",Pa.maxDimensions=2;let Xl=Pa;const rT=ke({...ln.shape,scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null),dim:K().default(2)}),ka=class ka extends Sn{constructor(e){super(e),this.scalingFactor=100,this.config=rT.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=Jw({nodes:e,edges:t},this.config.scale,this.config.center,this.config.dim)}};ka.type="spectral",ka.maxDimensions=2;let ec=ka;const iT=ke({...ln.shape,scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null),dim:K().default(2),resolution:K().positive().default(.35),equidistant:wt().default(!1)}),$a=class $a extends Sn{constructor(e){super(e),this.scalingFactor=80,this.config=iT.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=Yw({nodes:e,edges:t},this.config.scale,this.config.center,this.config.dim,this.config.resolution,this.config.equidistant)}};$a.type="spiral",$a.maxDimensions=2;let tc=$a;const oT=ke({...ln.shape,k:K().or(Ye()).default(null),pos:cr(K(),it(K())).or(Ye()).default(null),fixed:it(K()).or(Ye()).default(null),iterations:K().positive().default(50),scale:K().positive().default(1),center:it(K()).length(2).or(Ye()).default(null),dim:K().default(3),seed:K().positive().or(Ye()).default(null)}),Oa=class Oa extends Sn{constructor(e){super(e),this.scalingFactor=100,this.config=oT.parse(e)}doLayout(){this.stale=!1;const e=()=>this._nodes.map(r=>r.id),t=()=>this._edges.map(r=>[r.srcId,r.dstId]);this.positions=Vw({nodes:e,edges:t},this.config.k,this.config.pos,this.config.fixed,this.config.iterations,this.config.scale,this.config.center,this.config.dim,this.config.seed)}};Oa.type="spring",Oa.maxDimensions=3;let nc=Oa;vt.register(Ll),vt.register(Jl),vt.register(tc),vt.register(Pl),vt.register(Xl),vt.register(Ql),vt.register(nc),vt.register(Yl),vt.register(Fl),vt.register(Bl),vt.register(Cl),vt.register(ec),vt.register(Al),vt.register(Il),vt.register(Ul);const c0=new Map;class rc{constructor(e){Iu(this,Na);this.graph=e}get type(){return this.constructor.type}get namespace(){return this.constructor.namespace}get results(){const e={};for(const t of this.graph.nodes.values())Nn.set(e,`node.${t.id}`,t.algorithmResults);return e}addNodeResult(e,t,r){const o=iv(this,Na,ov).call(this,t),a=this.graph.nodes.get(e);if(!a)throw new Error(`couldn't find nodeId '${e}' while trying to run algorithm '${this.type}'`);Nn.set(a,o,r)}addEdgeResult(e,t){console.log("adding edge result",e,t)}addGraphResult(e,t){console.log("adding graph result",e,t)}static register(e){const t=e.type,r=e.namespace;return c0.set(`${r}:${t}`,e),e}static get(e,t,r){const o=c0.get(`${t}:${r}`);return o?new o(e):null}}Na=new WeakSet,ov=function(e){const t=[];return t.push("algorithmResults"),t.push(this.namespace),t.push(this.type),t.push(e),t};const Ra=class Ra extends rc{async run(){const e=this.graph,t=new Map,r=new Map,o=new Map;function a(f,p){let g=f.get(p);g??(g=0),g++,f.set(p,g)}for(const f of e.edges.values())a(t,f.srcId),a(r,f.dstId),a(o,f.srcId),a(o,f.dstId);const u=Math.max(...t.values()),h=Math.max(...r.values()),c=Math.max(...o.values());for(const f of e.nodes.values()){const p=t.get(f.id)??0,g=r.get(f.id)??0,m=o.get(f.id)??0;this.addNodeResult(f.id,"inDegree",p),this.addNodeResult(f.id,"outDegree",g),this.addNodeResult(f.id,"degree",m),this.addNodeResult(f.id,"inDegreePct",p/u),this.addNodeResult(f.id,"outDegreePct",g/h),this.addNodeResult(f.id,"degreePct",m/c)}}};Ra.namespace="graphty",Ra.type="degree";let ic=Ra;rc.register(ic);class sT{constructor(e){this.activeCameraController=null,this.activeInputHandler=null,this.controllers=new Map,this.inputs=new Map,this.scene=e}registerCamera(e,t,r){this.controllers.set(e,t),this.inputs.set(e,r)}activateCamera(e){var o,a;const t=this.controllers.get(e),r=this.inputs.get(e);if(!t||!r){console.warn(`Camera or input for key '${e}' not registered.`);return}(o=this.activeInputHandler)==null||o.disable(),(a=this.activeCameraController)==null||a.camera.detachControl(),this.scene.activeCamera=t.camera,t.camera.attachControl(this.scene.getEngine().getRenderingCanvas(),!0),r.enable(),this.activeCameraController=t,this.activeInputHandler=r}zoomToBoundingBox(e,t){var r;(r=this.activeCameraController)==null||r.zoomToBoundingBox(e,t)}update(){var e;(e=this.activeInputHandler)==null||e.update()}}class aT{constructor(e,t,r){this.canvas=e,this.config=r,this.scene=t,this.scene.clearColor=new W.Color4(0,0,0,1),this.pivot=new W.TransformNode("pivot",this.scene),this.cameraDistance=10,this.camera=new W.UniversalCamera("camera",new W.Vector3(0,0,-this.cameraDistance),this.scene),this.camera.parent=this.pivot,this.camera.lockedTarget=this.pivot,this.camera.inputs.clear(),this.scene.activeCamera=this.camera,this.camera.attachControl(e,!0)}rotate(e,t){this.pivot.rotate(W.Axis.Y,-e*this.config.trackballRotationSpeed,W.Space.LOCAL),this.pivot.rotate(W.Axis.X,-t*this.config.trackballRotationSpeed,W.Space.LOCAL)}spin(e){this.pivot.rotate(W.Axis.Z,e,W.Space.LOCAL)}zoom(e){this.cameraDistance=W.Scalar.Clamp(this.cameraDistance+e,this.config.minZoomDistance,this.config.maxZoomDistance)}updateCameraPosition(){this.camera.position.copyFrom(W.Vector3.Forward().scale(-this.cameraDistance))}zoomToBoundingBox(e,t){const r=e.add(t).scale(.5),o=t.subtract(e);this.pivot.position.copyFrom(r);const a=o.length();this.cameraDistance=W.Scalar.Clamp(a*.7,this.config.minZoomDistance,this.config.maxZoomDistance),this.updateCameraPosition()}}var oc={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var h0;function uT(){return h0||(h0=1,function(n){(function(e,t,r,o){var a=["","webkit","Moz","MS","ms","o"],u=t.createElement("div"),h="function",c=Math.round,f=Math.abs,p=Date.now;function g(y,E,O){return setTimeout(T(y,O),E)}function m(y,E,O){return Array.isArray(y)?(b(y,O[E],O),!0):!1}function b(y,E,O){var Z;if(y)if(y.forEach)y.forEach(E,O);else if(y.length!==o)for(Z=0;Z<y.length;)E.call(O,y[Z],Z,y),Z++;else for(Z in y)y.hasOwnProperty(Z)&&E.call(O,y[Z],Z,y)}function _(y,E,O){var Z="DEPRECATED METHOD: "+E+`
`+O+` AT 
`;return function(){var oe=new Error("get-stack-trace"),de=oe&&oe.stack?oe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Be=e.console&&(e.console.warn||e.console.log);return Be&&Be.call(e.console,Z,de),y.apply(this,arguments)}}var $;typeof Object.assign!="function"?$=function(E){if(E===o||E===null)throw new TypeError("Cannot convert undefined or null to object");for(var O=Object(E),Z=1;Z<arguments.length;Z++){var oe=arguments[Z];if(oe!==o&&oe!==null)for(var de in oe)oe.hasOwnProperty(de)&&(O[de]=oe[de])}return O}:$=Object.assign;var C=_(function(E,O,Z){for(var oe=Object.keys(O),de=0;de<oe.length;)(!Z||Z&&E[oe[de]]===o)&&(E[oe[de]]=O[oe[de]]),de++;return E},"extend","Use `assign`."),S=_(function(E,O){return C(E,O,!0)},"merge","Use `assign`.");function I(y,E,O){var Z=E.prototype,oe;oe=y.prototype=Object.create(Z),oe.constructor=y,oe._super=Z,O&&$(oe,O)}function T(y,E){return function(){return y.apply(E,arguments)}}function A(y,E){return typeof y==h?y.apply(E&&E[0]||o,E):y}function N(y,E){return y===o?E:y}function D(y,E,O){b(we(E),function(Z){y.addEventListener(Z,O,!1)})}function L(y,E,O){b(we(E),function(Z){y.removeEventListener(Z,O,!1)})}function q(y,E){for(;y;){if(y==E)return!0;y=y.parentNode}return!1}function se(y,E){return y.indexOf(E)>-1}function we(y){return y.trim().split(/\s+/g)}function me(y,E,O){if(y.indexOf&&!O)return y.indexOf(E);for(var Z=0;Z<y.length;){if(O&&y[Z][O]==E||!O&&y[Z]===E)return Z;Z++}return-1}function ge(y){return Array.prototype.slice.call(y,0)}function Xe(y,E,O){for(var Z=[],oe=[],de=0;de<y.length;){var Be=y[de][E];me(oe,Be)<0&&Z.push(y[de]),oe[de]=Be,de++}return Z=Z.sort(function(kt,Bt){return kt[E]>Bt[E]}),Z}function Ue(y,E){for(var O,Z,oe=E[0].toUpperCase()+E.slice(1),de=0;de<a.length;){if(O=a[de],Z=O?O+oe:E,Z in y)return Z;de++}return o}var ut=1;function Ve(){return ut++}function ne(y){var E=y.ownerDocument||y;return E.defaultView||E.parentWindow||e}var ae=/mobile|tablet|ip(ad|hone|od)|android/i,ie="ontouchstart"in e,he=Ue(e,"PointerEvent")!==o,_e=ie&&ae.test(navigator.userAgent),Te="touch",Le="pen",Qe="mouse",ue="kinect",te=25,U=1,j=2,Y=4,fe=8,xe=1,He=2,Tt=4,ze=8,ot=16,Lt=He|Tt,St=ze|ot,Ln=Lt|St,Ee=["x","y"],qt=["clientX","clientY"];function tt(y,E){var O=this;this.manager=y,this.callback=E,this.element=y.element,this.target=y.options.inputTarget,this.domHandler=function(Z){A(y.options.enable,[y])&&O.handler(Z)},this.init()}tt.prototype={handler:function(){},init:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(ne(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(ne(this.element),this.evWin,this.domHandler)}};function En(y){var E,O=y.options.inputClass;return O?E=O:he?E=gr:_e?E=Fn:ie?E=ns:E=jt,new E(y,Bn)}function Bn(y,E,O){var Z=O.pointers.length,oe=O.changedPointers.length,de=E&U&&Z-oe===0,Be=E&(Y|fe)&&Z-oe===0;O.isFirst=!!de,O.isFinal=!!Be,de&&(y.session={}),O.eventType=E,es(y,O),y.emit("hammer.input",O),y.recognize(O),y.session.prevInput=O}function es(y,E){var O=y.session,Z=E.pointers,oe=Z.length;O.firstInput||(O.firstInput=k(E)),oe>1&&!O.firstMultiple?O.firstMultiple=k(E):oe===1&&(O.firstMultiple=!1);var de=O.firstInput,Be=O.firstMultiple,Ct=Be?Be.center:de.center,kt=E.center=z(Z);E.timeStamp=p(),E.deltaTime=E.timeStamp-de.timeStamp,E.angle=Pe(Ct,kt),E.distance=ce(Ct,kt),pr(O,E),E.offsetDirection=X(E.deltaX,E.deltaY);var Bt=H(E.deltaTime,E.deltaX,E.deltaY);E.overallVelocityX=Bt.x,E.overallVelocityY=Bt.y,E.overallVelocity=f(Bt.x)>f(Bt.y)?Bt.x:Bt.y,E.scale=Be?Et(Be.pointers,Z):1,E.rotation=Be?Ze(Be.pointers,Z):0,E.maxPointers=O.prevInput?E.pointers.length>O.prevInput.maxPointers?E.pointers.length:O.prevInput.maxPointers:E.pointers.length,x(O,E);var Zn=y.element;q(E.srcEvent.target,Zn)&&(Zn=E.srcEvent.target),E.target=Zn}function pr(y,E){var O=E.center,Z=y.offsetDelta||{},oe=y.prevDelta||{},de=y.prevInput||{};(E.eventType===U||de.eventType===Y)&&(oe=y.prevDelta={x:de.deltaX||0,y:de.deltaY||0},Z=y.offsetDelta={x:O.x,y:O.y}),E.deltaX=oe.x+(O.x-Z.x),E.deltaY=oe.y+(O.y-Z.y)}function x(y,E){var O=y.lastInterval||E,Z=E.timeStamp-O.timeStamp,oe,de,Be,Ct;if(E.eventType!=fe&&(Z>te||O.velocity===o)){var kt=E.deltaX-O.deltaX,Bt=E.deltaY-O.deltaY,Zn=H(Z,kt,Bt);de=Zn.x,Be=Zn.y,oe=f(Zn.x)>f(Zn.y)?Zn.x:Zn.y,Ct=X(kt,Bt),y.lastInterval=E}else oe=O.velocity,de=O.velocityX,Be=O.velocityY,Ct=O.direction;E.velocity=oe,E.velocityX=de,E.velocityY=Be,E.direction=Ct}function k(y){for(var E=[],O=0;O<y.pointers.length;)E[O]={clientX:c(y.pointers[O].clientX),clientY:c(y.pointers[O].clientY)},O++;return{timeStamp:p(),pointers:E,center:z(E),deltaX:y.deltaX,deltaY:y.deltaY}}function z(y){var E=y.length;if(E===1)return{x:c(y[0].clientX),y:c(y[0].clientY)};for(var O=0,Z=0,oe=0;oe<E;)O+=y[oe].clientX,Z+=y[oe].clientY,oe++;return{x:c(O/E),y:c(Z/E)}}function H(y,E,O){return{x:E/y||0,y:O/y||0}}function X(y,E){return y===E?xe:f(y)>=f(E)?y<0?He:Tt:E<0?ze:ot}function ce(y,E,O){O||(O=Ee);var Z=E[O[0]]-y[O[0]],oe=E[O[1]]-y[O[1]];return Math.sqrt(Z*Z+oe*oe)}function Pe(y,E,O){O||(O=Ee);var Z=E[O[0]]-y[O[0]],oe=E[O[1]]-y[O[1]];return Math.atan2(oe,Z)*180/Math.PI}function Ze(y,E){return Pe(E[1],E[0],qt)+Pe(y[1],y[0],qt)}function Et(y,E){return ce(E[0],E[1],qt)/ce(y[0],y[1],qt)}var tn={mousedown:U,mousemove:j,mouseup:Y},ft="mousedown",Se="mousemove mouseup";function jt(){this.evEl=ft,this.evWin=Se,this.pressed=!1,tt.apply(this,arguments)}I(jt,tt,{handler:function(E){var O=tn[E.type];O&U&&E.button===0&&(this.pressed=!0),O&j&&E.which!==1&&(O=Y),this.pressed&&(O&Y&&(this.pressed=!1),this.callback(this.manager,O,{pointers:[E],changedPointers:[E],pointerType:Qe,srcEvent:E}))}});var ts={pointerdown:U,pointermove:j,pointerup:Y,pointercancel:fe,pointerout:fe},_i={2:Te,3:Le,4:Qe,5:ue},Zr="pointerdown",qr="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Zr="MSPointerDown",qr="MSPointerMove MSPointerUp MSPointerCancel");function gr(){this.evEl=Zr,this.evWin=qr,tt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}I(gr,tt,{handler:function(E){var O=this.store,Z=!1,oe=E.type.toLowerCase().replace("ms",""),de=ts[oe],Be=_i[E.pointerType]||E.pointerType,Ct=Be==Te,kt=me(O,E.pointerId,"pointerId");de&U&&(E.button===0||Ct)?kt<0&&(O.push(E),kt=O.length-1):de&(Y|fe)&&(Z=!0),!(kt<0)&&(O[kt]=E,this.callback(this.manager,de,{pointers:O,changedPointers:[E],pointerType:Be,srcEvent:E}),Z&&O.splice(kt,1))}});var nn={touchstart:U,touchmove:j,touchend:Y,touchcancel:fe},Ji="touchstart",yi="touchstart touchmove touchend touchcancel";function Gr(){this.evTarget=Ji,this.evWin=yi,this.started=!1,tt.apply(this,arguments)}I(Gr,tt,{handler:function(E){var O=nn[E.type];if(O===U&&(this.started=!0),!!this.started){var Z=bi.call(this,E,O);O&(Y|fe)&&Z[0].length-Z[1].length===0&&(this.started=!1),this.callback(this.manager,O,{pointers:Z[0],changedPointers:Z[1],pointerType:Te,srcEvent:E})}}});function bi(y,E){var O=ge(y.touches),Z=ge(y.changedTouches);return E&(Y|fe)&&(O=Xe(O.concat(Z),"identifier")),[O,Z]}var wi={touchstart:U,touchmove:j,touchend:Y,touchcancel:fe},Hr="touchstart touchmove touchend touchcancel";function Fn(){this.evTarget=Hr,this.targetIds={},tt.apply(this,arguments)}I(Fn,tt,{handler:function(E){var O=wi[E.type],Z=Yi.call(this,E,O);Z&&this.callback(this.manager,O,{pointers:Z[0],changedPointers:Z[1],pointerType:Te,srcEvent:E})}});function Yi(y,E){var O=ge(y.touches),Z=this.targetIds;if(E&(U|j)&&O.length===1)return Z[O[0].identifier]=!0,[O,O];var oe,de,Be=ge(y.changedTouches),Ct=[],kt=this.target;if(de=O.filter(function(Bt){return q(Bt.target,kt)}),E===U)for(oe=0;oe<de.length;)Z[de[oe].identifier]=!0,oe++;for(oe=0;oe<Be.length;)Z[Be[oe].identifier]&&Ct.push(Be[oe]),E&(Y|fe)&&delete Z[Be[oe].identifier],oe++;if(Ct.length)return[Xe(de.concat(Ct),"identifier"),Ct]}var Wr=2500,za=25;function ns(){tt.apply(this,arguments);var y=T(this.handler,this);this.touch=new Fn(this.manager,y),this.mouse=new jt(this.manager,y),this.primaryTouch=null,this.lastTouches=[]}I(ns,tt,{handler:function(E,O,Z){var oe=Z.pointerType==Te,de=Z.pointerType==Qe;if(!(de&&Z.sourceCapabilities&&Z.sourceCapabilities.firesTouchEvents)){if(oe)bc.call(this,O,Z);else if(de&&wc.call(this,Z))return;this.callback(E,O,Z)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function bc(y,E){y&U?(this.primaryTouch=E.changedPointers[0].identifier,Da.call(this,E)):y&(Y|fe)&&Da.call(this,E)}function Da(y){var E=y.changedPointers[0];if(E.identifier===this.primaryTouch){var O={x:E.clientX,y:E.clientY};this.lastTouches.push(O);var Z=this.lastTouches,oe=function(){var de=Z.indexOf(O);de>-1&&Z.splice(de,1)};setTimeout(oe,Wr)}}function wc(y){for(var E=y.srcEvent.clientX,O=y.srcEvent.clientY,Z=0;Z<this.lastTouches.length;Z++){var oe=this.lastTouches[Z],de=Math.abs(E-oe.x),Be=Math.abs(O-oe.y);if(de<=za&&Be<=za)return!0}return!1}var La=Ue(u.style,"touchAction"),Ba=La!==o,Fa="compute",rs="auto",is="manipulation",mr="none",xi="pan-x",Ti="pan-y",Qi=xc();function os(y,E){this.manager=y,this.set(E)}os.prototype={set:function(y){y==Fa&&(y=this.compute()),Ba&&this.manager.element.style&&Qi[y]&&(this.manager.element.style[La]=y),this.actions=y.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var y=[];return b(this.manager.recognizers,function(E){A(E.options.enable,[E])&&(y=y.concat(E.getTouchAction()))}),Xi(y.join(" "))},preventDefaults:function(y){var E=y.srcEvent,O=y.offsetDirection;if(this.manager.session.prevented){E.preventDefault();return}var Z=this.actions,oe=se(Z,mr)&&!Qi[mr],de=se(Z,Ti)&&!Qi[Ti],Be=se(Z,xi)&&!Qi[xi];if(oe){var Ct=y.pointers.length===1,kt=y.distance<2,Bt=y.deltaTime<250;if(Ct&&kt&&Bt)return}if(!(Be&&de)&&(oe||de&&O&Lt||Be&&O&St))return this.preventSrc(E)},preventSrc:function(y){this.manager.session.prevented=!0,y.preventDefault()}};function Xi(y){if(se(y,mr))return mr;var E=se(y,xi),O=se(y,Ti);return E&&O?mr:E||O?E?xi:Ti:se(y,is)?is:rs}function xc(){if(!Ba)return!1;var y={},E=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(O){y[O]=E?e.CSS.supports("touch-action",O):!0}),y}var vr=1,dn=2,jr=4,or=8,Un=or,Vr=16,Cn=32;function Yn(y){this.options=$({},this.defaults,y||{}),this.id=Ve(),this.manager=null,this.options.enable=N(this.options.enable,!0),this.state=vr,this.simultaneous={},this.requireFail=[]}Yn.prototype={defaults:{},set:function(y){return $(this.options,y),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(y){if(m(y,"recognizeWith",this))return this;var E=this.simultaneous;return y=eo(y,this),E[y.id]||(E[y.id]=y,y.recognizeWith(this)),this},dropRecognizeWith:function(y){return m(y,"dropRecognizeWith",this)?this:(y=eo(y,this),delete this.simultaneous[y.id],this)},requireFailure:function(y){if(m(y,"requireFailure",this))return this;var E=this.requireFail;return y=eo(y,this),me(E,y)===-1&&(E.push(y),y.requireFailure(this)),this},dropRequireFailure:function(y){if(m(y,"dropRequireFailure",this))return this;y=eo(y,this);var E=me(this.requireFail,y);return E>-1&&this.requireFail.splice(E,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(y){return!!this.simultaneous[y.id]},emit:function(y){var E=this,O=this.state;function Z(oe){E.manager.emit(oe,y)}O<or&&Z(E.options.event+Ua(O)),Z(E.options.event),y.additionalEvent&&Z(y.additionalEvent),O>=or&&Z(E.options.event+Ua(O))},tryEmit:function(y){if(this.canEmit())return this.emit(y);this.state=Cn},canEmit:function(){for(var y=0;y<this.requireFail.length;){if(!(this.requireFail[y].state&(Cn|vr)))return!1;y++}return!0},recognize:function(y){var E=$({},y);if(!A(this.options.enable,[this,E])){this.reset(),this.state=Cn;return}this.state&(Un|Vr|Cn)&&(this.state=vr),this.state=this.process(E),this.state&(dn|jr|or|Vr)&&this.tryEmit(E)},process:function(y){},getTouchAction:function(){},reset:function(){}};function Ua(y){return y&Vr?"cancel":y&or?"end":y&jr?"move":y&dn?"start":""}function Za(y){return y==ot?"down":y==ze?"up":y==He?"left":y==Tt?"right":""}function eo(y,E){var O=E.manager;return O?O.get(y):y}function pn(){Yn.apply(this,arguments)}I(pn,Yn,{defaults:{pointers:1},attrTest:function(y){var E=this.options.pointers;return E===0||y.pointers.length===E},process:function(y){var E=this.state,O=y.eventType,Z=E&(dn|jr),oe=this.attrTest(y);return Z&&(O&fe||!oe)?E|Vr:Z||oe?O&Y?E|or:E&dn?E|jr:dn:Cn}});function Si(){pn.apply(this,arguments),this.pX=null,this.pY=null}I(Si,pn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ln},getTouchAction:function(){var y=this.options.direction,E=[];return y&Lt&&E.push(Ti),y&St&&E.push(xi),E},directionTest:function(y){var E=this.options,O=!0,Z=y.distance,oe=y.direction,de=y.deltaX,Be=y.deltaY;return oe&E.direction||(E.direction&Lt?(oe=de===0?xe:de<0?He:Tt,O=de!=this.pX,Z=Math.abs(y.deltaX)):(oe=Be===0?xe:Be<0?ze:ot,O=Be!=this.pY,Z=Math.abs(y.deltaY))),y.direction=oe,O&&Z>E.threshold&&oe&E.direction},attrTest:function(y){return pn.prototype.attrTest.call(this,y)&&(this.state&dn||!(this.state&dn)&&this.directionTest(y))},emit:function(y){this.pX=y.deltaX,this.pY=y.deltaY;var E=Za(y.direction);E&&(y.additionalEvent=this.options.event+E),this._super.emit.call(this,y)}});function to(){pn.apply(this,arguments)}I(to,pn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[mr]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.scale-1)>this.options.threshold||this.state&dn)},emit:function(y){if(y.scale!==1){var E=y.scale<1?"in":"out";y.additionalEvent=this.options.event+E}this._super.emit.call(this,y)}});function Mi(){Yn.apply(this,arguments),this._timer=null,this._input=null}I(Mi,Yn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[rs]},process:function(y){var E=this.options,O=y.pointers.length===E.pointers,Z=y.distance<E.threshold,oe=y.deltaTime>E.time;if(this._input=y,!Z||!O||y.eventType&(Y|fe)&&!oe)this.reset();else if(y.eventType&U)this.reset(),this._timer=g(function(){this.state=Un,this.tryEmit()},E.time,this);else if(y.eventType&Y)return Un;return Cn},reset:function(){clearTimeout(this._timer)},emit:function(y){this.state===Un&&(y&&y.eventType&Y?this.manager.emit(this.options.event+"up",y):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function ss(){pn.apply(this,arguments)}I(ss,pn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[mr]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.rotation)>this.options.threshold||this.state&dn)}});function no(){pn.apply(this,arguments)}I(no,pn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Lt|St,pointers:1},getTouchAction:function(){return Si.prototype.getTouchAction.call(this)},attrTest:function(y){var E=this.options.direction,O;return E&(Lt|St)?O=y.overallVelocity:E&Lt?O=y.overallVelocityX:E&St&&(O=y.overallVelocityY),this._super.attrTest.call(this,y)&&E&y.offsetDirection&&y.distance>this.options.threshold&&y.maxPointers==this.options.pointers&&f(O)>this.options.velocity&&y.eventType&Y},emit:function(y){var E=Za(y.offsetDirection);E&&this.manager.emit(this.options.event+E,y),this.manager.emit(this.options.event,y)}});function _r(){Yn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}I(_r,Yn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[is]},process:function(y){var E=this.options,O=y.pointers.length===E.pointers,Z=y.distance<E.threshold,oe=y.deltaTime<E.time;if(this.reset(),y.eventType&U&&this.count===0)return this.failTimeout();if(Z&&oe&&O){if(y.eventType!=Y)return this.failTimeout();var de=this.pTime?y.timeStamp-this.pTime<E.interval:!0,Be=!this.pCenter||ce(this.pCenter,y.center)<E.posThreshold;this.pTime=y.timeStamp,this.pCenter=y.center,!Be||!de?this.count=1:this.count+=1,this._input=y;var Ct=this.count%E.taps;if(Ct===0)return this.hasRequireFailures()?(this._timer=g(function(){this.state=Un,this.tryEmit()},E.interval,this),dn):Un}return Cn},failTimeout:function(){return this._timer=g(function(){this.state=Cn},this.options.interval,this),Cn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Un&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Qn(y,E){return E=E||{},E.recognizers=N(E.recognizers,Qn.defaults.preset),new ro(y,E)}Qn.VERSION="2.0.7",Qn.defaults={domEvents:!1,touchAction:Fa,enable:!0,inputTarget:null,inputClass:null,preset:[[ss,{enable:!1}],[to,{enable:!1},["rotate"]],[no,{direction:Lt}],[Si,{direction:Lt},["swipe"]],[_r],[_r,{event:"doubletap",taps:2},["tap"]],[Mi]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Tc=1,as=2;function ro(y,E){this.options=$({},Qn.defaults,E||{}),this.options.inputTarget=this.options.inputTarget||y,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=y,this.input=En(this),this.touchAction=new os(this,this.options.touchAction),io(this,!0),b(this.options.recognizers,function(O){var Z=this.add(new O[0](O[1]));O[2]&&Z.recognizeWith(O[2]),O[3]&&Z.requireFailure(O[3])},this)}ro.prototype={set:function(y){return $(this.options,y),y.touchAction&&this.touchAction.update(),y.inputTarget&&(this.input.destroy(),this.input.target=y.inputTarget,this.input.init()),this},stop:function(y){this.session.stopped=y?as:Tc},recognize:function(y){var E=this.session;if(!E.stopped){this.touchAction.preventDefaults(y);var O,Z=this.recognizers,oe=E.curRecognizer;(!oe||oe&&oe.state&Un)&&(oe=E.curRecognizer=null);for(var de=0;de<Z.length;)O=Z[de],E.stopped!==as&&(!oe||O==oe||O.canRecognizeWith(oe))?O.recognize(y):O.reset(),!oe&&O.state&(dn|jr|or)&&(oe=E.curRecognizer=O),de++}},get:function(y){if(y instanceof Yn)return y;for(var E=this.recognizers,O=0;O<E.length;O++)if(E[O].options.event==y)return E[O];return null},add:function(y){if(m(y,"add",this))return this;var E=this.get(y.options.event);return E&&this.remove(E),this.recognizers.push(y),y.manager=this,this.touchAction.update(),y},remove:function(y){if(m(y,"remove",this))return this;if(y=this.get(y),y){var E=this.recognizers,O=me(E,y);O!==-1&&(E.splice(O,1),this.touchAction.update())}return this},on:function(y,E){if(y!==o&&E!==o){var O=this.handlers;return b(we(y),function(Z){O[Z]=O[Z]||[],O[Z].push(E)}),this}},off:function(y,E){if(y!==o){var O=this.handlers;return b(we(y),function(Z){E?O[Z]&&O[Z].splice(me(O[Z],E),1):delete O[Z]}),this}},emit:function(y,E){this.options.domEvents&&Sc(y,E);var O=this.handlers[y]&&this.handlers[y].slice();if(!(!O||!O.length)){E.type=y,E.preventDefault=function(){E.srcEvent.preventDefault()};for(var Z=0;Z<O.length;)O[Z](E),Z++}},destroy:function(){this.element&&io(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function io(y,E){var O=y.element;if(O.style){var Z;b(y.options.cssProps,function(oe,de){Z=Ue(O.style,de),E?(y.oldCssProps[Z]=O.style[Z],O.style[Z]=oe):O.style[Z]=y.oldCssProps[Z]||""}),E||(y.oldCssProps={})}}function Sc(y,E){var O=t.createEvent("Event");O.initEvent(y,!0,!0),O.gesture=E,E.target.dispatchEvent(O)}$(Qn,{INPUT_START:U,INPUT_MOVE:j,INPUT_END:Y,INPUT_CANCEL:fe,STATE_POSSIBLE:vr,STATE_BEGAN:dn,STATE_CHANGED:jr,STATE_ENDED:or,STATE_RECOGNIZED:Un,STATE_CANCELLED:Vr,STATE_FAILED:Cn,DIRECTION_NONE:xe,DIRECTION_LEFT:He,DIRECTION_RIGHT:Tt,DIRECTION_UP:ze,DIRECTION_DOWN:ot,DIRECTION_HORIZONTAL:Lt,DIRECTION_VERTICAL:St,DIRECTION_ALL:Ln,Manager:ro,Input:tt,TouchAction:os,TouchInput:Fn,MouseInput:jt,PointerEventInput:gr,TouchMouseInput:ns,SingleTouchInput:Gr,Recognizer:Yn,AttrRecognizer:pn,Tap:_r,Pan:Si,Swipe:no,Pinch:to,Rotate:ss,Press:Mi,on:D,off:L,each:b,merge:S,extend:C,assign:$,inherit:I,bindFn:T,prefixed:Ue});var qa=typeof e<"u"?e:typeof self<"u"?self:{};qa.Hammer=Qn,n.exports?n.exports=Qn:e[r]=Qn})(window,document,"Hammer")}(oc)),oc.exports}var lT=uT();const hi=No(lT);class cT{constructor(e,t){this.isPointerDown=!1,this.lastX=0,this.lastY=0,this.isMultiTouch=!1,this.rotationVelocityX=0,this.rotationVelocityY=0,this.keysDown={},this.hammer=null,this.enabled=!1,this.pointerDownHandler=r=>{r.button===0&&!this.isMultiTouch&&(this.isPointerDown=!0,this.lastX=r.clientX,this.lastY=r.clientY,this.canvas.focus())},this.pointerUpHandler=()=>{this.isPointerDown=!1},this.pointerMoveHandler=r=>{if(!this.isPointerDown||this.isMultiTouch)return;const o=r.clientX-this.lastX,a=r.clientY-this.lastY;this.lastX=r.clientX,this.lastY=r.clientY,this.controller.rotate(o,a)},this.keyDownHandler=r=>{console.log("orbit keydown handler"),this.keysDown[r.key.toLowerCase()]=!0},this.keyUpHandler=r=>{this.keysDown[r.key.toLowerCase()]=!1},this.canvas=e,this.controller=t,this.config=t.config,this.canvas.setAttribute("tabindex","0"),this.attachMouseTouch()}attachMouseTouch(){this.hammer=new hi.Manager(this.canvas),this.hammer.add(new hi.Pinch),this.hammer.add(new hi.Rotate);let e=0,t=1;this.hammer.on("pinchstart rotatestart",()=>{this.isMultiTouch=!0,e=0,t=1}),this.hammer.on("pinchend rotateend",()=>{this.isMultiTouch=!1}),this.hammer.on("pinchmove rotatemove",r=>{const o=r.scale-t;this.controller.zoom(-o*this.config.pinchZoomSensitivity),t=r.scale;const a=(r.rotation-e)*(Math.PI/180)*this.config.twistYawSensitivity;this.controller.spin(a),e=r.rotation})}enable(){this.enabled||(this.enabled=!0,this.canvas.addEventListener("pointerdown",this.pointerDownHandler),this.canvas.addEventListener("pointerup",this.pointerUpHandler),this.canvas.addEventListener("pointermove",this.pointerMoveHandler),this.canvas.addEventListener("keydown",this.keyDownHandler),this.canvas.addEventListener("keyup",this.keyUpHandler),this.canvas.focus(),this.hammer||this.attachMouseTouch())}disable(){this.enabled&&(this.enabled=!1,this.canvas.removeEventListener("pointerdown",this.pointerDownHandler),this.canvas.removeEventListener("pointerup",this.pointerUpHandler),this.canvas.removeEventListener("pointermove",this.pointerMoveHandler),this.canvas.removeEventListener("keydown",this.keyDownHandler),this.canvas.removeEventListener("keyup",this.keyUpHandler),this.hammer&&(this.hammer.destroy(),this.hammer=null))}update(){if(!this.enabled)return;const e=this.keysDown,t=this.controller;e.arrowleft&&(this.rotationVelocityY+=this.config.keyboardRotationSpeed),e.arrowright&&(this.rotationVelocityY-=this.config.keyboardRotationSpeed),e.arrowup&&(this.rotationVelocityX+=this.config.keyboardRotationSpeed),e.arrowdown&&(this.rotationVelocityX-=this.config.keyboardRotationSpeed),e.w&&t.zoom(-this.config.keyboardZoomSpeed),e.s&&t.zoom(this.config.keyboardZoomSpeed),e.a&&t.spin(this.config.keyboardYawSpeed),e.d&&t.spin(-this.config.keyboardYawSpeed),Math.abs(this.rotationVelocityX)>1e-5&&(t.rotate(0,-this.rotationVelocityX/this.config.trackballRotationSpeed),this.rotationVelocityX*=this.config.inertiaDamping),Math.abs(this.rotationVelocityY)>1e-5&&(t.rotate(-this.rotationVelocityY/this.config.trackballRotationSpeed,0),this.rotationVelocityY*=this.config.inertiaDamping),t.updateCameraPosition()}}class hT{constructor(e,t,r,o){this.scene=e,this.engine=t,this.canvas=r,this.config=o,this.velocity={x:0,y:0,zoom:0,rotate:0},this.camera=new W.FreeCamera("orthoCamera",new W.Vector3(0,0,-10),e),this.camera.mode=W.Camera.ORTHOGRAPHIC_CAMERA,this.camera.inertia=0,this.camera.inputs.clear(),this.parent=new W.TransformNode("parent",e),this.updateOrtho(o.initialOrthoSize),this.camera.setTarget(W.Vector3.Zero())}updateOrtho(e){const t=this.engine.getRenderHeight()/this.engine.getRenderWidth();this.camera.orthoLeft=-e,this.camera.orthoRight=e,this.camera.orthoTop=e*t,this.camera.orthoBottom=-e*t}pan(e,t){this.camera.position.x+=e,this.camera.position.y+=t}zoom(e){this.camera.orthoLeft=e*(this.camera.orthoLeft??1),this.camera.orthoRight=e*(this.camera.orthoRight??1),this.camera.orthoTop=e*(this.camera.orthoTop??1),this.camera.orthoBottom=e*(this.camera.orthoBottom??1)}rotate(e){this.parent.rotation.z+=e}applyInertia(){const e=this.velocity,t=this.config;this.camera.position.x+=e.x,this.camera.position.y+=e.y;const r=Math.exp(e.zoom);this.camera.orthoLeft=r*(this.camera.orthoLeft??1),this.camera.orthoRight=r*(this.camera.orthoRight??1),this.camera.orthoTop=r*(this.camera.orthoTop??1),this.camera.orthoBottom=r*(this.camera.orthoBottom??1),this.parent.rotation.z+=e.rotate,e.x*=t.panDamping,e.y*=t.panDamping,e.zoom*=t.zoomDamping,e.rotate*=t.rotateDamping}zoomToBoundingBox(e,t){const r=(e.x+t.x)/2,o=(e.y+t.y)/2,a=t.x-e.x,u=t.y-e.y,h=Math.max(a,u);this.camera.position.x=r,this.camera.position.y=o,this.updateOrtho(h*.6)}}class fT{constructor(e,t,r){this.cam=e,this.canvas=t,this.config=r,this.keyState={},this.gestureSession=null,this.hammer=null,this.enabled=!1,this.pointerDownHandler=()=>{this.cam.canvas.focus()},this.keyDownHandler=o=>{this.keyState[o.key]=!0},this.keyUpHandler=o=>{this.keyState[o.key]=!1},this.canvas.setAttribute("tabindex","0"),this.setupMouse(),this.setupTouch()}setupMouse(){let e=!1,t=0,r=0;this.cam.scene.onPointerObservable.add(o=>{const a=o.event;switch(o.type){case W.PointerEventTypes.POINTERDOWN:e=!0,t=a.clientX,r=a.clientY,this.pointerDownHandler();break;case W.PointerEventTypes.POINTERUP:e=!1;break;case W.PointerEventTypes.POINTERMOVE:if(e&&a.buttons===1){const u=this.cam.camera.orthoRight??1,h=this.cam.camera.orthoLeft??1,c=this.cam.camera.orthoTop??1,f=this.cam.camera.orthoBottom??1,p=(u-h)/this.cam.engine.getRenderWidth(),g=(c-f)/this.cam.engine.getRenderHeight(),m=a.clientX-t,b=a.clientY-r;this.cam.pan(-m*p*this.config.mousePanScale,b*g*this.config.mousePanScale),t=a.clientX,r=a.clientY}break}}),this.cam.scene.onPrePointerObservable.add(o=>{const a=o.event;if(o.type===W.PointerEventTypes.POINTERWHEEL){const u=a.deltaY>0?this.config.mouseWheelZoomSpeed:1/this.config.mouseWheelZoomSpeed;this.cam.zoom(u),a.preventDefault()}},W.PointerEventTypes.POINTERWHEEL)}setupTouch(){this.hammer=new hi.Manager(this.canvas);const e=new hi.Pan({threshold:0,pointers:0}),t=new hi.Pinch,r=new hi.Rotate;this.hammer.add([e,t,r]),this.hammer.get("pinch").recognizeWith(this.hammer.get("rotate")),this.hammer.get("pan").requireFailure(this.hammer.get("pinch")),this.hammer.on("panstart pinchstart rotatestart",o=>{this.gestureSession={panX:o.center.x,panY:o.center.y,panStartX:this.cam.camera.position.x,panStartY:this.cam.camera.position.y,ortho:{left:this.cam.camera.orthoLeft??1,right:this.cam.camera.orthoRight??1,top:this.cam.camera.orthoTop??1,bottom:this.cam.camera.orthoBottom??1},scale:o.scale||1,rotation:this.cam.parent.rotation.z,startRotDeg:o.rotation||0}}),this.hammer.on("panmove pinchmove rotatemove",o=>{if(!this.gestureSession)return;const a=this.cam.camera.orthoRight??1,u=this.cam.camera.orthoLeft??1,h=this.cam.camera.orthoTop??1,c=this.cam.camera.orthoBottom??1,f=(a-u)/this.cam.engine.getRenderWidth(),p=(h-c)/this.cam.engine.getRenderHeight(),g=o.center.x-this.gestureSession.panX,m=o.center.y-this.gestureSession.panY;this.cam.camera.position.x=this.gestureSession.panStartX-g*f*this.config.touchPanScale,this.cam.camera.position.y=this.gestureSession.panStartY+m*p*this.config.touchPanScale;const b=(o.scale||1)/this.gestureSession.scale;this.cam.camera.orthoLeft=this.gestureSession.ortho.left/b,this.cam.camera.orthoRight=this.gestureSession.ortho.right/b,this.cam.camera.orthoTop=this.gestureSession.ortho.top/b,this.cam.camera.orthoBottom=this.gestureSession.ortho.bottom/b;const _=-(o.rotation-this.gestureSession.startRotDeg)*Math.PI/180;this.cam.parent.rotation.z=this.gestureSession.rotation+_}),this.hammer.on("panend pinchend rotateend",()=>{this.gestureSession=null})}enable(){this.enabled||(this.enabled=!0,this.canvas.addEventListener("keydown",this.keyDownHandler),this.canvas.addEventListener("keyup",this.keyUpHandler))}disable(){this.enabled&&(this.enabled=!1,this.canvas.removeEventListener("keydown",this.keyDownHandler),this.canvas.removeEventListener("keyup",this.keyUpHandler))}applyKeyboardInertia(){if(!this.enabled)return;const e=this.cam.velocity,t=this.config;(this.keyState.w||this.keyState.ArrowUp)&&(e.y+=t.panAcceleration),(this.keyState.s||this.keyState.ArrowDown)&&(e.y-=t.panAcceleration),(this.keyState.a||this.keyState.ArrowLeft)&&(e.x-=t.panAcceleration),(this.keyState.d||this.keyState.ArrowRight)&&(e.x+=t.panAcceleration),(this.keyState["+"]||this.keyState["="])&&(e.zoom-=t.zoomFactorPerFrame),(this.keyState["-"]||this.keyState._)&&(e.zoom+=t.zoomFactorPerFrame),this.keyState.q&&(e.rotate+=t.rotateSpeedPerFrame),this.keyState.e&&(e.rotate-=t.rotateSpeedPerFrame)}update(){this.applyKeyboardInertia(),this.cam.applyInertia()}}class dT{constructor(){this.meshCacheMap=new Map,this.hits=0,this.misses=0}get(e,t){let r=this.meshCacheMap.get(e);return r?(this.hits++,r.createInstance(`${e}`)):(this.misses++,r=t(),r.isVisible=!1,this.meshCacheMap.set(e,r),r.createInstance(`${e}`))}reset(){this.hits=0,this.misses=0}}const Lr=".",sc=Symbol("target"),f0=Symbol("unsubscribe");function ac(n){return n instanceof Date||n instanceof Set||n instanceof Map||n instanceof WeakSet||n instanceof WeakMap||ArrayBuffer.isView(n)}function pT(n){return(typeof n=="object"?n===null:typeof n!="function")||n instanceof RegExp}const Xt=Array.isArray;function ca(n){return typeof n=="symbol"}const hn={after(n,e){return Xt(n)?n.slice(e.length):e===""?n:n.slice(e.length+1)},concat(n,e){return Xt(n)?(n=[...n],e&&n.push(e),n):e&&e.toString!==void 0?(n!==""&&(n+=Lr),ca(e)?n+e.toString():n+e):n},initial(n){if(Xt(n))return n.slice(0,-1);if(n==="")return n;const e=n.lastIndexOf(Lr);return e===-1?"":n.slice(0,e)},last(n){if(Xt(n))return n.at(-1)??"";if(n==="")return n;const e=n.lastIndexOf(Lr);return e===-1?n:n.slice(e+1)},walk(n,e){if(Xt(n))for(const t of n)e(t);else if(n!==""){let t=0,r=n.indexOf(Lr);if(r===-1)e(n);else for(;t<n.length;)r===-1&&(r=n.length),e(n.slice(t,r)),t=r+1,r=n.indexOf(Lr,t)}},get(n,e){return this.walk(e,t=>{n&&(n=n[t])}),n},isSubPath(n,e){if(Xt(n)){if(n.length<e.length)return!1;for(let t=0;t<e.length;t++)if(n[t]!==e[t])return!1;return!0}return n.length<e.length?!1:n===e?!0:n.startsWith(e)?n[e.length]===Lr:!1},isRootPath(n){return Xt(n)?n.length===0:n===""}};function gT(n){return typeof n=="object"&&typeof n.next=="function"}function mT(n,e,t,r,o){const a=n.next;if(e.name==="entries")n.next=function(){const u=a.call(this);return u.done===!1&&(u.value[0]=o(u.value[0],e,u.value[0],r),u.value[1]=o(u.value[1],e,u.value[0],r)),u};else if(e.name==="values"){const u=t[sc].keys();n.next=function(){const h=a.call(this);return h.done===!1&&(h.value=o(h.value,e,u.next().value,r)),h}}else n.next=function(){const u=a.call(this);return u.done===!1&&(u.value=o(u.value,e,u.value,r)),u};return n}function d0(n,e,t){return n.isUnsubscribed||e.ignoreSymbols&&ca(t)||e.ignoreUnderscores&&t.charAt(0)==="_"||"ignoreKeys"in e&&e.ignoreKeys.includes(t)}class vT{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){const t=this._getDescriptorCache();let r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);const r=this._getProperties(e);let o=r[t];return o===void 0&&(o=Reflect.getOwnPropertyDescriptor(e,t),r[t]=o),o}getProxy(e,t,r,o){if(this.isUnsubscribed)return e;const a=e[o],u=a??e;this._pathCache.set(u,t);let h=this._proxyCache.get(u);return h===void 0&&(h=a===void 0?new Proxy(e,r):e,this._proxyCache.set(u,h)),h}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,hn.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,o,a){if(!this._equals(a,r)||!(t in e)){const u=this._getOwnPropertyDescriptor(e,t);return u!==void 0&&"set"in u?Reflect.set(e,t,r,o):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){const o=this._getDescriptorCache().get(e);o&&(delete o[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){const o=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&o!==void 0&&Object.is(e.value,o.value)&&(e.writable||!1)===(o.writable||!1)&&(e.enumerable||!1)===(o.enumerable||!1)&&(e.configurable||!1)===(o.configurable||!1)&&e.get===o.get&&e.set===o.set}isGetInvariant(e,t){const r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}}function uc(n){return toString.call(n)==="[object Object]"}function ha(){return!0}function Wi(n,e){return n.length!==e.length||n.some((t,r)=>e[r]!==t)}const p0=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),_T=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),g0={push:ha,pop:ha,shift:ha,unshift:ha,copyWithin:Wi,reverse:Wi,sort:Wi,splice:Wi,flat:Wi,fill:Wi},yT=new Set([...p0,..._T,...Object.keys(g0)]);function fa(n,e){if(n.size!==e.size)return!0;for(const t of n)if(!e.has(t))return!0;return!1}const m0=["keys","values","entries"],v0=new Set(["has","toString"]),_0={add:fa,clear:fa,delete:fa,forEach:fa},bT=new Set([...v0,...Object.keys(_0),...m0]);function da(n,e){if(n.size!==e.size)return!0;let t;for(const[r,o]of n)if(t=e.get(r),t!==o||t===void 0&&!e.has(r))return!0;return!1}const wT=new Set([...v0,"get"]),y0={set:da,clear:da,delete:da,forEach:da},xT=new Set([...wT,...Object.keys(y0),...m0]);class Br{constructor(e,t,r,o){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=o,this._changes=o?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return p0.has(e)}_shallowClone(e){let t=e;if(uc(e))t={...e};else if(Xt(e)||ArrayBuffer.isView(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(const[r,o]of e.entries())t.set(r,this._shallowClone(o))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,o){return e?(Xt(o)?this._onIsChanged=g0[t]:o instanceof Set?this._onIsChanged=_0[t]:o instanceof Map&&(this._onIsChanged=y0[t]),o):r}update(e,t,r){const o=hn.after(e,this._path);if(t!=="length"){let a=this.clone;hn.walk(o,u=>{a!=null&&a[u]&&(this._clonedCache.has(a[u])||(a[u]=this._shallowClone(a[u])),a=a[u])}),this._hasOnValidate&&this._changes.push({path:o,property:t,previous:r}),a!=null&&a[t]&&(a[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],hn.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}isPathApplicable(e){return hn.isRootPath(this._path)||hn.isSubPath(e,this._path)}}class b0 extends Br{static isHandledMethod(e){return yT.has(e)}}class TT extends Br{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}}class w0 extends Br{static isHandledMethod(e){return bT.has(e)}undo(e){for(const t of this.clone)e.add(t);for(const t of e)this.clone.has(t)||e.delete(t)}}class x0 extends Br{static isHandledMethod(e){return xT.has(e)}undo(e){for(const[t,r]of this.clone.entries())e.set(t,r);for(const t of e.keys())this.clone.has(t)||e.delete(t)}}class ST extends Br{constructor(e,t,r,o){super(void 0,t,r,o),this._argument1=r[0],this._weakValue=e.has(this._argument1)}isChanged(e){return this._weakValue!==e.has(this._argument1)}undo(e){this._weakValue&&!e.has(this._argument1)?e.add(this._argument1):e.delete(this._argument1)}}class MT extends Br{constructor(e,t,r,o){super(void 0,t,r,o),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){const t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}}class fi{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return uc(e)||Xt(e)||ac(e)}static isHandledMethod(e,t){return uc(e)?Br.isHandledMethod(t):Xt(e)?b0.isHandledMethod(t):e instanceof Set?w0.isHandledMethod(t):e instanceof Map?x0.isHandledMethod(t):ac(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let o=Br;Xt(e)?o=b0:e instanceof Date?o=TT:e instanceof Set?o=w0:e instanceof Map?o=x0:e instanceof WeakSet?o=ST:e instanceof WeakMap&&(o=MT),this._stack.push(new o(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack.at(-1).update(e,t,r)}preferredThisArg(e,t,r){const{name:o}=e,a=fi.isHandledMethod(r,o);return this._stack.at(-1).preferredThisArg(a,o,t,r)}isChanged(e,t,r){return this._stack.at(-1).isChanged(e,t,r)}isPartOfClone(e){return this._stack.at(-1).isPathApplicable(e)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}}const ET={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},lc=(n,e,t={})=>{t={...ET,...t};const r=Symbol("ProxyTarget"),{equals:o,isShallow:a,ignoreDetached:u,details:h}=t,c=new vT(o),f=typeof t.onValidate=="function",p=new fi(f),g=(T,A,N,D,L)=>!f||p.isCloning||t.onValidate(hn.concat(c.getPath(T),A),N,D,L)===!0,m=(T,A,N,D)=>{!d0(c,t,A)&&!(u&&c.isDetached(T,n))&&b(c.getPath(T),A,N,D)},b=(T,A,N,D,L)=>{p.isCloning&&p.isPartOfClone(T)?p.update(T,A,D):e(hn.concat(T,A),N,D,L)},_=T=>T&&(T[r]??T),$=(T,A,N,D)=>{if(pT(T)||N==="constructor"||a&&!fi.isHandledMethod(A,N)||d0(c,t,N)||c.isGetInvariant(A,N)||u&&c.isDetached(A,n))return T;D===void 0&&(D=c.getPath(A));const L=hn.concat(D,N),q=c.getPath(T);return q&&C(L,q)?c.getProxy(T,q,S,r):c.getProxy(T,L,S,r)},C=(T,A)=>{if(ca(T)||T.length<=A.length||Xt(A)&&A.length===0)return!1;const N=Xt(T)?T:T.split(Lr),D=Xt(A)?A:A.split(Lr);return N.length<=D.length?!1:!D.some((L,q)=>L!==N[q])},S={get(T,A,N){if(ca(A)){if(A===r||A===sc)return T;if(A===f0&&!c.isUnsubscribed&&c.getPath(T).length===0)return c.unsubscribe(),T}const D=ac(T)?Reflect.get(T,A):Reflect.get(T,A,N);return $(D,T,A)},set(T,A,N,D){N=_(N);const L=T[r]??T,q=L[A];if(o(q,N)&&A in T)return!0;const se=g(T,A,N,q);return se&&c.setProperty(L,A,N,D,q)?(m(T,A,T[A],q),!0):!se},defineProperty(T,A,N){if(!c.isSameDescriptor(N,T,A)){const D=T[A];g(T,A,N.value,D)&&c.defineProperty(T,A,N,D)&&m(T,A,N.value,D)}return!0},deleteProperty(T,A){if(!Reflect.has(T,A))return!0;const N=Reflect.get(T,A),D=g(T,A,void 0,N);return D&&c.deleteProperty(T,A,N)?(m(T,A,void 0,N),!0):!D},apply(T,A,N){const D=A[r]??A;if(c.isUnsubscribed)return Reflect.apply(T,D,N);if((h===!1||h!==!0&&!h.includes(T.name))&&fi.isHandledType(D)){let L=hn.initial(c.getPath(T));const q=fi.isHandledMethod(D,T.name);p.start(D,L,N);let se=Reflect.apply(T,p.preferredThisArg(T,A,D),q?N.map(ge=>_(ge)):N);const we=p.isChanged(D,o),me=p.stop();if(fi.isHandledType(se)&&q&&(A instanceof Map&&T.name==="get"&&(L=hn.concat(L,N[0])),se=c.getProxy(se,L,S)),we){const ge={name:T.name,args:N,result:se},Xe=p.isCloning?hn.initial(L):L,Ue=p.isCloning?hn.last(L):"";g(hn.get(n,Xe),Ue,D,me,ge)?b(Xe,Ue,D,me,ge):p.undo(D)}return(A instanceof Map||A instanceof Set)&&gT(se)?mT(se,T,A,L,$):se}return Reflect.apply(T,A,N)}},I=c.getProxy(n,t.pathAsArray?[]:"",S);return e=e.bind(I),f&&(t.onValidate=t.onValidate.bind(I)),I};lc.target=n=>(n==null?void 0:n[sc])??n,lc.unsubscribe=n=>(n==null?void 0:n[f0])??n;class CT{constructor(){this.watchedInputs=new Map,this.dataObjects={},this.calculatedValues=new Set,this.schemas={}}watch(e,t,r){const o=lc(t,(a,u,h)=>{if(typeof u=="object"&&u!==null&&Object.keys(u).length===0&&h===void 0)return;const c=this.watchedInputs.get(`${e}.${a}`);if(c){const f=AT(this.schemas,c.output);c.run(this.dataObjects,f)}});return this.addData(e,o,r)}addData(e,t,r){if(this.dataObjects[e]!==void 0)throw new TypeError(`data type: ${e} already exists in change manager`);return this.dataObjects[e]=t,r&&(this.schemas[e]=r),t}addCalculatedValue(e){this.calculatedValues.add(e),e.inputs.forEach(t=>this.watchedInputs.set(t,e))}addCalculatedValues(e){e.forEach(t=>{this.addCalculatedValue(t)})}loadCalculatedValues(e){this.watchedInputs.clear(),this.addCalculatedValues(e)}}function AT(n,e){const t=e.split("."),r=t.shift();if(!r)throw new Error("error getting data type of output for calculated value");const o=n[r];if(o)return T0(o,t)}function T0(n,e){n instanceof Fd&&(n=n.unwrap());const t=e.shift();if(!t)return n;if(n instanceof zd){const r=n.shape[t];return T0(r,e)}throw new Error(`don't know how to retreive path for: ${t}.${e.join(".")}`)}const S0=1.618;class Je{constructor(e,t,r,o,a={}){this.dragging=!1,this.parentGraph=e,this.id=t,this.opts=a,this.changeManager=new CT,this.changeManager.loadCalculatedValues(this.parentGraph.styles.getCalculatedStylesForNode(o)),this.data=this.changeManager.watch("data",o),this.algorithmResults=this.changeManager.watch("algorithmResults",{}),this.styleUpdates=this.changeManager.addData("style",{},Ks),this.styleId=r,this.parentGraph.layoutEngine.addNode(this),this.mesh=Je.defaultNodeMeshFactory(this,this.parentGraph,r)}addCalculatedStyle(e){this.changeManager.addCalculatedValue(e)}update(){const e=Object.keys(this.styleUpdates);if(e.length>0){let r=xn.getStyleForNodeStyleId(this.styleId);r=Fw.defaultsDeep(this.styleUpdates,r);const o=xn.getNodeIdForStyle(r);this.updateStyle(o);for(const a of e)delete this.styleUpdates[a]}if(this.dragging)return;const t=this.parentGraph.layoutEngine.getNodePosition(this);this.mesh.position.x=t.x,this.mesh.position.y=t.y,t.z&&(this.mesh.position.z=t.z)}updateStyle(e){e!==this.styleId&&(this.styleId=e,this.mesh.dispose(),this.mesh=Je.defaultNodeMeshFactory(this,this.parentGraph,e))}pin(){this.parentGraph.layoutEngine.pin(this)}unpin(){this.parentGraph.layoutEngine.unpin(this)}static defaultNodeMeshFactory(e,t,r){var a,u;const o=xn.getStyleForNodeStyleId(r);return e.size=((a=o.shape)==null?void 0:a.size)??0,e.mesh=t.meshCache.get(`node-style-${r}`,()=>{var p,g,m;let h;if(!o.shape)throw new TypeError("shape required to create mesh");switch(o.shape.type){case"box":h=Je.createBox(e,t,o);break;case"sphere":h=Je.createSphere(e,t,o);break;case"cylinder":h=Je.createCylinder(e,t,o);break;case"cone":h=Je.createCone(e,t,o);break;case"capsule":h=Je.createCapsule(e,t,o);break;case"torus-knot":h=Je.createTorusKnot(e,t,o);break;case"tetrahedron":h=Je.createPolyhedron(0,e,t,o);break;case"octahedron":h=Je.createPolyhedron(1,e,t,o);break;case"dodecahedron":h=Je.createPolyhedron(2,e,t,o);break;case"icosahedron":h=Je.createPolyhedron(3,e,t,o);break;case"rhombicuboctahedron":h=Je.createPolyhedron(4,e,t,o);break;case"triangular_prism":h=Je.createPolyhedron(5,e,t,o);break;case"pentagonal_prism":h=Je.createPolyhedron(6,e,t,o);break;case"hexagonal_prism":h=Je.createPolyhedron(7,e,t,o);break;case"square_pyramid":h=Je.createPolyhedron(8,e,t,o);break;case"pentagonal_pyramid":h=Je.createPolyhedron(9,e,t,o);break;case"triangular_dipyramid":h=Je.createPolyhedron(10,e,t,o);break;case"pentagonal_dipyramid":h=Je.createPolyhedron(11,e,t,o);break;case"elongated_square_dypyramid":h=Je.createPolyhedron(12,e,t,o);break;case"elongated_pentagonal_dipyramid":h=Je.createPolyhedron(13,e,t,o);break;case"elongated_pentagonal_cupola":h=Je.createPolyhedron(14,e,t,o);break;case"goldberg":h=Je.createGoldberg(e,t,o);break;case"icosphere":h=Je.createIcoSphere(e,t,o);break;case"geodesic":h=Je.createGeodesic(e,t,o);break;default:throw new TypeError(`unknown shape: ${o.shape.type}`)}const c=new W.StandardMaterial("defaultMaterial");let f;if(typeof((p=o.texture)==null?void 0:p.color)=="string")f=W.Color3.FromHexString(o.texture.color);else if(typeof((g=o.texture)==null?void 0:g.color)=="object")switch(o.texture.color.colorType){case"solid":f=W.Color3.FromHexString(o.texture.color.value??"##FFFFFF"),h.visibility=o.texture.color.opacity??1;break;default:throw new TypeError(`unknown advanced colorType ${o.texture.color.colorType}`)}return c.wireframe=((m=o.effect)==null?void 0:m.wireframe)??!1,f&&!t.styles.config.graph.twoD?c.diffuseColor=f:f&&(c.disableLighting=!0,c.emissiveColor=f),c.freeze(),h.material=c,h}),(u=o.label)!=null&&u.enabled&&(e.label=Je.createLabel(e,o)),Je.addDefaultBehaviors(e,e.opts),e.mesh}static createBox(e,t,r){var o;return W.MeshBuilder.CreateBox("box",{size:((o=r.shape)==null?void 0:o.size)??1})}static createSphere(e,t,r){var o;return W.MeshBuilder.CreateSphere("sphere",{diameter:((o=r.shape)==null?void 0:o.size)??1})}static createCylinder(e,t,r){var o,a;return W.MeshBuilder.CreateCylinder("cylinder",{height:((o=r.shape)==null?void 0:o.size)??1*S0,diameter:((a=r.shape)==null?void 0:a.size)??1})}static createCone(e,t,r){var o,a;return W.MeshBuilder.CreateCylinder("cylinder",{height:((o=r.shape)==null?void 0:o.size)??1*S0,diameterTop:0,diameterBottom:((a=r.shape)==null?void 0:a.size)??1})}static createCapsule(e,t,r){return W.MeshBuilder.CreateCapsule("capsule",{})}static createTorus(e,t,r){return W.MeshBuilder.CreateTorus("torus",{})}static createTorusKnot(e,t,r){var o,a;return W.MeshBuilder.CreateTorusKnot("tk",{radius:((o=r.shape)==null?void 0:o.size)??1*.3,tube:((a=r.shape)==null?void 0:a.size)??1*.2,radialSegments:128})}static createPolyhedron(e,t,r,o){var a;return W.MeshBuilder.CreatePolyhedron("polyhedron",{size:((a=o.shape)==null?void 0:a.size)??1,type:e})}static createGoldberg(e,t,r){var o;return W.MeshBuilder.CreateGoldberg("goldberg",{size:((o=r.shape)==null?void 0:o.size)??1})}static createIcoSphere(e,t,r){var o;return W.MeshBuilder.CreateIcoSphere("icosphere",{radius:((o=r.shape)==null?void 0:o.size)??1*.75})}static createGeodesic(e,t,r){var o;return W.MeshBuilder.CreateGeodesic("geodesic",{size:((o=r.shape)==null?void 0:o.size)??1})}static createLabel(e,t){let r=e.id.toString();const o=t.label;if(o.text!==void 0&&o.text!==null)(typeof o.text=="string"||typeof o.text=="number"||typeof o.text=="boolean")&&(r=String(o.text));else if(o.textPath&&typeof o.textPath=="string")try{const c=zr.search(e.data,o.textPath);c!=null&&(r=String(c))}catch{}const a=t.label?dw(t.label):{},u={text:r,attachTo:e.mesh,attachPosition:Je.getAttachPosition(a.location??"top"),attachOffset:a.attachOffset??Je.getDefaultAttachOffset(a.location??"top")};return a.font!==void 0&&(u.font=a.font),a.fontSize!==void 0&&(u.fontSize=a.fontSize),a.fontWeight!==void 0&&(u.fontWeight=a.fontWeight),a.lineHeight!==void 0&&(u.lineHeight=a.lineHeight),a.textColor!==void 0&&(u.textColor=a.textColor),a.backgroundColor!==void 0&&(u.backgroundColor=Je.getBackgroundColor(a.backgroundColor)),a.borderWidth!==void 0&&(u.borderWidth=a.borderWidth),a.borderColor!==void 0&&(u.borderColor=a.borderColor),a.borders!==void 0&&(u.borders=a.borders),a.marginTop!==void 0&&(u.marginTop=a.marginTop),a.marginBottom!==void 0&&(u.marginBottom=a.marginBottom),a.marginLeft!==void 0&&(u.marginLeft=a.marginLeft),a.marginRight!==void 0&&(u.marginRight=a.marginRight),a.textAlign!==void 0&&(u.textAlign=a.textAlign),a.cornerRadius!==void 0&&(u.cornerRadius=a.cornerRadius),a.autoSize!==void 0&&(u.autoSize=a.autoSize),a.resolution!==void 0&&(u.resolution=a.resolution),a.billboardMode!==void 0&&(u.billboardMode=a.billboardMode),a.position!==void 0&&(u.position=a.position),a.attachOffset!==void 0&&(u.attachOffset=a.attachOffset),a.depthFadeEnabled!==void 0&&(u.depthFadeEnabled=a.depthFadeEnabled),a.depthFadeNear!==void 0&&(u.depthFadeNear=a.depthFadeNear),a.depthFadeFar!==void 0&&(u.depthFadeFar=a.depthFadeFar),a.textOutline!==void 0&&(u.textOutline=a.textOutline),a.textOutlineWidth!==void 0&&(u.textOutlineWidth=a.textOutlineWidth),a.textOutlineColor!==void 0&&(u.textOutlineColor=a.textOutlineColor),a.textOutlineJoin!==void 0&&(u.textOutlineJoin=a.textOutlineJoin),a.textShadow!==void 0&&(u.textShadow=a.textShadow),a.textShadowColor!==void 0&&(u.textShadowColor=a.textShadowColor),a.textShadowBlur!==void 0&&(u.textShadowBlur=a.textShadowBlur),a.textShadowOffsetX!==void 0&&(u.textShadowOffsetX=a.textShadowOffsetX),a.textShadowOffsetY!==void 0&&(u.textShadowOffsetY=a.textShadowOffsetY),a.backgroundPadding!==void 0&&(u.backgroundPadding=a.backgroundPadding),a.backgroundGradient!==void 0&&(u.backgroundGradient=a.backgroundGradient),a.backgroundGradientType!==void 0&&(u.backgroundGradientType=a.backgroundGradientType),a.backgroundGradientColors!==void 0&&(u.backgroundGradientColors=a.backgroundGradientColors),a.backgroundGradientDirection!==void 0&&(u.backgroundGradientDirection=a.backgroundGradientDirection),a.pointer!==void 0&&(u.pointer=a.pointer),a.pointerDirection!==void 0&&(u.pointerDirection=a.pointerDirection),a.pointerWidth!==void 0&&(u.pointerWidth=a.pointerWidth),a.pointerHeight!==void 0&&(u.pointerHeight=a.pointerHeight),a.pointerOffset!==void 0&&(u.pointerOffset=a.pointerOffset),a.pointerCurve!==void 0&&(u.pointerCurve=a.pointerCurve),a.animation!==void 0&&(u.animation=a.animation),a.animationSpeed!==void 0&&(u.animationSpeed=a.animationSpeed),a.badge!==void 0&&(u.badge=a.badge),a.icon!==void 0&&(u.icon=a.icon),a.iconPosition!==void 0&&(u.iconPosition=a.iconPosition),a.progress!==void 0&&(u.progress=a.progress),a.smartOverflow!==void 0&&(u.smartOverflow=a.smartOverflow),a.maxNumber!==void 0&&(u.maxNumber=a.maxNumber),a.overflowSuffix!==void 0&&(u.overflowSuffix=a.overflowSuffix),a.attachOffset!==void 0&&(u.attachOffset=a.attachOffset),new Qs(e.parentGraph.scene,u)}static getBackgroundColor(e){if(typeof e=="string")return e;if(e&&typeof e=="object"&&"colorType"in e){const t=e;if(t.colorType==="solid"&&t.value)return t.value}return"transparent"}static getAttachPosition(e){switch(e){case"automatic":return"top";case"top":case"top-left":case"top-right":case"left":case"center":case"right":case"bottom":case"bottom-left":case"bottom-right":return e;default:return"top"}}static getDefaultAttachOffset(e){switch(e){case"left":case"right":return 1;case"center":return 0;default:return .5}}static addDefaultBehaviors(e,t){if(e.mesh.isPickable=!0,e.pinOnDrag=t.pinOnDrag??!0,e.meshDragBehavior=new W.SixDofDragBehavior,e.mesh.addBehavior(e.meshDragBehavior),e.meshDragBehavior.onDragStartObservable.add(()=>{e.parentGraph.running=!0,e.dragging=!0}),e.meshDragBehavior.onDragEndObservable.add(()=>{e.parentGraph.running=!0,e.pinOnDrag&&e.pin(),e.dragging=!1}),e.meshDragBehavior.onPositionChangedObservable.add(r=>{e.parentGraph.running=!0,e.parentGraph.layoutEngine.setNodePosition(e,r.position)}),e.mesh.actionManager=e.mesh.actionManager??new W.ActionManager(e.parentGraph.scene),e.parentGraph.fetchNodes&&e.parentGraph.fetchEdges){const{fetchNodes:r,fetchEdges:o}=e.parentGraph;e.mesh.actionManager.registerAction(new W.ExecuteCodeAction({trigger:W.ActionManager.OnDoublePickTrigger},()=>{e.parentGraph.running=!0;const a=o(e,e.parentGraph),u=new Set;a.forEach(c=>{u.add(c.src),u.add(c.dst)}),u.delete(e.id);const h=r(u,e.parentGraph);e.parentGraph.addNodes([...h]),e.parentGraph.addEdges([...a])}))}}}class IT{constructor(e){this.graphStep=new W.PerfCounter,this.nodeUpdate=new W.PerfCounter,this.edgeUpdate=new W.PerfCounter,this.arrowCapUpdate=new W.PerfCounter,this.intersectCalc=new W.PerfCounter,this.loadTime=new W.PerfCounter,this.totalUpdates=0,this.graph=e,this.sceneInstrumentation=new W.SceneInstrumentation(e.scene),this.sceneInstrumentation.captureFrameTime=!0,this.sceneInstrumentation.captureRenderTime=!0,this.sceneInstrumentation.captureInterFrameTime=!0,this.sceneInstrumentation.captureCameraRenderTime=!0,this.sceneInstrumentation.captureActiveMeshesEvaluationTime=!0,this.sceneInstrumentation.captureRenderTargetsRenderTime=!0,this.babylonInstrumentation=new W.EngineInstrumentation(e.engine),this.babylonInstrumentation.captureGPUFrameTime=!0,this.babylonInstrumentation.captureShaderCompilationTime=!0}toString(){let e="";function t(a,u,h=""){e+=`${a}: ${u}${h}
`}function r(a){e+=`
${a}
`;for(let u=0;u<a.length;u++)e+="-";e+=`
`}function o(a,u,h=1){e+=`${a} (min/avg/last sec/max [total]): `,e+=`${(u.min*h).toFixed(2)} / `,e+=`${(u.average*h).toFixed(2)} / `,e+=`${(u.lastSecAverage*h).toFixed(2)} / `,e+=`${(u.max*h).toFixed(2)} `,e+=`[${(u.total*h).toFixed(2)}] ms
`}return r("Graph"),t("Num Nodes",this.numNodes),t("Num Edges",this.numEdges),t("Total Updates",this.totalUpdates),t("Mesh Cache Hits",this.meshCacheHits),t("Mesh Cache Misses",this.meshCacheMisses),t("Number of Node Updates",this.nodeUpdate.count),t("Number of Edge Updates",this.edgeUpdate.count),t("Number of ArrowCap Updates",this.arrowCapUpdate.count),r("Graph Engine Performance"),o("JSON Load Time",this.loadTime),o("Graph Physics Engine Time",this.graphStep),o("Node Update Time",this.nodeUpdate),o("Edge Update Time",this.edgeUpdate),o("Arrow Cap Update Time",this.arrowCapUpdate),o("Ray Intersect Calculation Time",this.intersectCalc),r("BabylonJS Performance"),t("Draw Calls",this.sceneInstrumentation.drawCallsCounter.count),o("GPU Time",this.babylonInstrumentation.gpuFrameTimeCounter,1e-6),o("Shader Time",this.babylonInstrumentation.shaderCompilationTimeCounter),o("Mesh Evaluation Time",this.sceneInstrumentation.activeMeshesEvaluationTimeCounter),o("Render Targets Time",this.sceneInstrumentation.renderTargetsRenderTimeCounter),o("Draw Calls Time",this.sceneInstrumentation.drawCallsCounter),o("Frame Time",this.sceneInstrumentation.frameTimeCounter),o("Render Time",this.sceneInstrumentation.renderTimeCounter),o("Time Between Frames",this.sceneInstrumentation.interFrameTimeCounter),o("Camera Render Time",this.sceneInstrumentation.cameraRenderTimeCounter),e}step(){this.totalUpdates++}reset(){this.totalUpdates=0}get numNodes(){return this.graph.nodeCache.size}get numEdges(){return this.graph.edgeCache.size}get meshCacheHits(){return this.graph.meshCache.hits}get meshCacheMisses(){return this.graph.meshCache.misses}}class M0{constructor(e){if(this.nodes=new Map,this.edges=new Map,this.xrHelper=null,this.edgeCache=new qw,this.nodeCache=new Map,this.needRays=!1,this.running=!1,this.initialized=!1,this.runAlgorithmsOnLoad=!1,this.graphObservable=new W.Observable,this.nodeObservable=new W.Observable,this.edgeObservable=new W.Observable,this.meshCache=new dT,this.styles=xn.default(),typeof e=="string"){const u=document.getElementById(e);if(!u)throw new Error(`getElementById() could not find element '${e}'`);this.element=u}else if(e instanceof Element)this.element=e;else throw new TypeError("Graph constructor requires 'element' argument that is either a string specifying the ID of the HTML element or an Element");this.element.innerHTML="",this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id",`babylonForceGraphRenderCanvas${Date.now()}`),this.canvas.setAttribute("touch-action","none"),this.canvas.setAttribute("autofocus","true"),this.canvas.setAttribute("tabindex","0"),this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.touchAction="none",this.element.appendChild(this.canvas),W.Logger.LogLevels=W.Logger.ErrorLogLevel,this.engine=new W.Engine(this.canvas,!0),this.scene=new W.Scene(this.engine),this.camera=new sT(this.scene);const t=new aT(this.canvas,this.scene,{trackballRotationSpeed:.005,keyboardRotationSpeed:.03,keyboardZoomSpeed:.2,keyboardYawSpeed:.02,pinchZoomSensitivity:10,twistYawSensitivity:1.5,minZoomDistance:2,maxZoomDistance:500,inertiaDamping:.9}),r=new cT(this.canvas,t);this.camera.registerCamera("orbit",t,r);const o=new hT(this.scene,this.engine,this.canvas,{panAcceleration:.02,panDamping:.85,zoomFactorPerFrame:.02,zoomDamping:.85,zoomMin:.1,zoomMax:500,rotateSpeedPerFrame:.02,rotateDamping:.85,rotateMin:null,rotateMax:null,mousePanScale:1,mouseWheelZoomSpeed:1.1,touchPanScale:1,touchPinchMin:.1,touchPinchMax:100,initialOrthoSize:5,rotationEnabled:!0,inertiaEnabled:!0}),a=new fT(o,this.canvas,{panAcceleration:.02,panDamping:.85,zoomFactorPerFrame:.02,zoomDamping:.85,zoomMin:.1,zoomMax:100,rotateSpeedPerFrame:.02,rotateDamping:.85,rotateMin:null,rotateMax:null,mousePanScale:1,mouseWheelZoomSpeed:1.1,touchPanScale:1,touchPinchMin:.1,touchPinchMax:100,initialOrthoSize:5,rotationEnabled:!0,inertiaEnabled:!0});this.camera.registerCamera("2d",o,a),this.camera.activateCamera("orbit"),new W.HemisphericLight("light",new W.Vector3(1,1,0)),this.setLayout("ngraph").catch(u=>{throw console.error("ERROR",u),u}),this.stats=new IT(this)}shutdown(){this.engine.dispose()}async init(){this.initialized||(await this.scene.whenReadyAsync(),this.engine.runRenderLoop(()=>{this.update(),this.scene.render()}),window.addEventListener("resize",()=>{this.engine.resize()}),this.initialized=!0)}update(){if(this.camera.update(),!this.running)return;this.stats.step(),this.stats.graphStep.beginMonitoring();for(let h=0;h<this.styles.config.behavior.layout.stepMultiplier;h++)this.layoutEngine.step();this.stats.graphStep.endMonitoring();let e,t;function r(h){const c=h.mesh.getAbsolutePosition(),f=h.size;if(!e||!t){e=c.clone(),t=c.clone();return}cc(c,e,f,"x"),cc(c,e,f,"y"),cc(c,e,f,"z"),hc(c,t,f,"x"),hc(c,t,f,"y"),hc(c,t,f,"z")}this.stats.nodeUpdate.beginMonitoring();for(const h of this.layoutEngine.nodes)h.update(),r(h);this.stats.nodeUpdate.endMonitoring(),this.stats.edgeUpdate.beginMonitoring(),Rn.updateRays(this);for(const h of this.layoutEngine.edges)h.update();this.stats.edgeUpdate.endMonitoring();const o=1.3,a=(e==null?void 0:e.multiplyByFloats(o,o,o))??new W.Vector3(-20,-20,-20),u=(t==null?void 0:t.multiplyByFloats(o,o,o))??new W.Vector3(20,20,20);this.camera.zoomToBoundingBox(a,u),this.layoutEngine.isSettled&&(this.graphObservable.notifyObservers({type:"graph-settled",graph:this}),this.running=!1)}async setStyleTemplate(e){this.styles=xn.fromObject(e);for(const r of this.nodes.values()){const o=this.styles.getStyleForNode(r.data);r.changeManager.loadCalculatedValues(this.styles.getCalculatedStylesForNode(r.data)),r.updateStyle(o)}for(const r of this.edges.values()){const o=this.styles.getStyleForEdge(r.data);r.updateStyle(o)}if(this.styles.config.graph.background.backgroundType==="skybox"&&typeof this.styles.config.graph.background.data=="string"){const r=new W.PhotoDome("testdome",this.styles.config.graph.background.data,{resolution:32,size:500},this.scene);r.rotation.z=-Math.PI/2,r.rotation.x=Math.PI}this.styles.config.graph.background.backgroundType==="color"&&this.styles.config.graph.background.color&&(this.scene.clearColor=W.Color4.FromHexString(this.styles.config.graph.background.color));const t=this.styles.config.graph.twoD?"2d":"orbit";this.camera.activateCamera(t);try{if(this.layoutEngine){const r=this.styles.config.graph.twoD?2:3,o=vt.getOptionsForDimensionByType(this.layoutEngine.type,r);if(o&&Object.keys(o).length>0){const a=this.layoutEngine.type,u=this.layoutEngine.config?{...this.layoutEngine.config}:{},h=vt.getOptionsForDimensionByType(a,2),c=vt.getOptionsForDimensionByType(a,3);new Set([...Object.keys(h??{}),...Object.keys(c??{})]).forEach(p=>{delete u[p]}),await this.setLayout(a,u)}}}catch{}if(this.runAlgorithmsOnLoad&&this.styles.config.data.algorithms)for(const r of this.styles.config.data.algorithms){const[o,a]=r.split(":");await this.runAlgorithm(o,a)}return this.styles}async addDataFromSource(e,t={}){this.stats.loadTime.beginMonitoring();const r=Js.get(e,t);if(!r)throw new TypeError(`No data source named: ${e}`);for await(const o of r.getData())this.addNodes(o.nodes),this.addEdges(o.edges);this.stats.loadTime.endMonitoring()}addNode(e,t){this.addNodes([e],t)}addNodes(e,t){const r=t??this.styles.config.data.knownFields.nodeIdPath;for(const o of e){const a=zr.search(o,r);if(this.nodeCache.get(a))continue;const u=this.styles.getStyleForNode(o),h=new Je(this,a,u,o,{pinOnDrag:this.pinOnDrag});this.nodeCache.set(a,h),this.nodes.set(a,h)}this.running=!0}addEdge(e,t,r){this.addEdges([e],t,r)}addEdges(e,t,r){const o=t??this.styles.config.data.knownFields.edgeSrcIdPath,a=r??this.styles.config.data.knownFields.edgeDstIdPath;for(const u of e){const h=zr.search(u,o),c=zr.search(u,a);if(this.edgeCache.get(h,c))continue;const f=this.styles.getStyleForEdge(u),p={},g=new Rn(this,h,c,f,u,p);this.edgeCache.set(h,c,g),this.edges.set(g.id,g)}this.running=!0}async setLayout(e,t={}){const r={...t},o=this.styles.config.graph.twoD?2:3,a=vt.getOptionsForDimensionByType(e,o);a&&Object.keys(a).forEach(h=>{h in r||(r[h]=a[h])});const u=vt.get(e,r);if(!u)throw new TypeError(`No layout named: ${e}`);u.addNodes([...this.nodes.values()]),u.addEdges([...this.edges.values()]),this.layoutEngine=u,await u.init();for(let h=0;h<this.styles.config.behavior.layout.preSteps;h++)this.layoutEngine.step();this.running=!0}async runAlgorithm(e,t){const r=rc.get(this,e,t);if(!r)throw new Error(`algorithm not found: ${e}:${t}`);await r.run(this)}addListener(e,t){switch(e){case"graph-settled":this.graphObservable.add(r=>{t(r)});break;default:throw new TypeError(`Unknown listener type in addListener: ${e}`)}}}function cc(n,e,t,r){const o=n[r]-t;o<e[r]&&(e[r]=o)}function hc(n,e,t,r){const o=n[r]+t;o>e[r]&&(e[r]=o)}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const pa=globalThis,fc=pa.ShadowRoot&&(pa.ShadyCSS===void 0||pa.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,E0=Symbol(),C0=new WeakMap;let PT=class{constructor(e,t,r){if(this._$cssResult$=!0,r!==E0)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(fc&&e===void 0){const r=t!==void 0&&t.length===1;r&&(e=C0.get(t)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&C0.set(t,e))}return e}toString(){return this.cssText}};const kT=n=>new PT(typeof n=="string"?n:n+"",void 0,E0),$T=(n,e)=>{if(fc)n.adoptedStyleSheets=e.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const t of e){const r=document.createElement("style"),o=pa.litNonce;o!==void 0&&r.setAttribute("nonce",o),r.textContent=t.cssText,n.appendChild(r)}},A0=fc?n=>n:n=>n instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return kT(t)})(n):n;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:OT,defineProperty:NT,getOwnPropertyDescriptor:RT,getOwnPropertyNames:zT,getOwnPropertySymbols:DT,getPrototypeOf:LT}=Object,Fr=globalThis,I0=Fr.trustedTypes,BT=I0?I0.emptyScript:"",dc=Fr.reactiveElementPolyfillSupport,qo=(n,e)=>n,ga={toAttribute(n,e){switch(e){case Boolean:n=n?BT:null;break;case Object:case Array:n=n==null?n:JSON.stringify(n)}return n},fromAttribute(n,e){let t=n;switch(e){case Boolean:t=n!==null;break;case Number:t=n===null?null:Number(n);break;case Object:case Array:try{t=JSON.parse(n)}catch{t=null}}return t}},pc=(n,e)=>!OT(n,e),P0={attribute:!0,type:String,converter:ga,reflect:!1,useDefault:!1,hasChanged:pc};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),Fr.litPropertyMetadata??(Fr.litPropertyMetadata=new WeakMap);class ji extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=P0){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),o=this.getPropertyDescriptor(e,r,t);o!==void 0&&NT(this.prototype,e,o)}}static getPropertyDescriptor(e,t,r){const{get:o,set:a}=RT(this.prototype,e)??{get(){return this[t]},set(u){this[t]=u}};return{get:o,set(u){const h=o==null?void 0:o.call(this);a==null||a.call(this,u),this.requestUpdate(e,h,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??P0}static _$Ei(){if(this.hasOwnProperty(qo("elementProperties")))return;const e=LT(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(qo("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(qo("properties"))){const t=this.properties,r=[...zT(t),...DT(t)];for(const o of r)this.createProperty(o,t[o])}const e=this[Symbol.metadata];if(e!==null){const t=litPropertyMetadata.get(e);if(t!==void 0)for(const[r,o]of t)this.elementProperties.set(r,o)}this._$Eh=new Map;for(const[t,r]of this.elementProperties){const o=this._$Eu(t,r);o!==void 0&&this._$Eh.set(o,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const o of r)t.unshift(A0(o))}else e!==void 0&&t.push(A0(e));return t}static _$Eu(e,t){const r=t.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(t=>t(this))}addController(e){var t;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((t=e.hostConnected)==null||t.call(e))}removeController(e){var t;(t=this._$EO)==null||t.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return $T(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostConnected)==null?void 0:r.call(t)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(t=>{var r;return(r=t.hostDisconnected)==null?void 0:r.call(t)})}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){var a;const r=this.constructor.elementProperties.get(e),o=this.constructor._$Eu(e,r);if(o!==void 0&&r.reflect===!0){const u=(((a=r.converter)==null?void 0:a.toAttribute)!==void 0?r.converter:ga).toAttribute(t,r.type);this._$Em=e,u==null?this.removeAttribute(o):this.setAttribute(o,u),this._$Em=null}}_$AK(e,t){var a,u;const r=this.constructor,o=r._$Eh.get(e);if(o!==void 0&&this._$Em!==o){const h=r.getPropertyOptions(o),c=typeof h.converter=="function"?{fromAttribute:h.converter}:((a=h.converter)==null?void 0:a.fromAttribute)!==void 0?h.converter:ga;this._$Em=o,this[o]=c.fromAttribute(t,h.type)??((u=this._$Ej)==null?void 0:u.get(o))??null,this._$Em=null}}requestUpdate(e,t,r){var o;if(e!==void 0){const a=this.constructor,u=this[e];if(r??(r=a.getPropertyOptions(e)),!((r.hasChanged??pc)(u,t)||r.useDefault&&r.reflect&&u===((o=this._$Ej)==null?void 0:o.get(e))&&!this.hasAttribute(a._$Eu(e,r))))return;this.C(e,t,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,t,{useDefault:r,reflect:o,wrapped:a},u){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,u??t??this[e]),a!==!0||u!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),o===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[a,u]of this._$Ep)this[a]=u;this._$Ep=void 0}const o=this.constructor.elementProperties;if(o.size>0)for(const[a,u]of o){const{wrapped:h}=u,c=this[a];h!==!0||this._$AL.has(a)||c===void 0||this.C(a,void 0,u,c)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),(r=this._$EO)==null||r.forEach(o=>{var a;return(a=o.hostUpdate)==null?void 0:a.call(o)}),this.update(t)):this._$EM()}catch(o){throw e=!1,this._$EM(),o}e&&this._$AE(t)}willUpdate(e){}_$AE(e){var t;(t=this._$EO)==null||t.forEach(r=>{var o;return(o=r.hostUpdated)==null?void 0:o.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(t=>this._$ET(t,this[t]))),this._$EM()}updated(e){}firstUpdated(e){}}ji.elementStyles=[],ji.shadowRootOptions={mode:"open"},ji[qo("elementProperties")]=new Map,ji[qo("finalized")]=new Map,dc==null||dc({ReactiveElement:ji}),(Fr.reactiveElementVersions??(Fr.reactiveElementVersions=[])).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Go=globalThis,ma=Go.trustedTypes,k0=ma?ma.createPolicy("lit-html",{createHTML:n=>n}):void 0,$0="$lit$",Ur=`lit$${Math.random().toFixed(9).slice(2)}$`,O0="?"+Ur,FT=`<${O0}>`,di=document,Ho=()=>di.createComment(""),Wo=n=>n===null||typeof n!="object"&&typeof n!="function",gc=Array.isArray,UT=n=>gc(n)||typeof(n==null?void 0:n[Symbol.iterator])=="function",mc=`[ 	
\f\r]`,jo=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,N0=/-->/g,R0=/>/g,pi=RegExp(`>|${mc}(?:([^\\s"'>=/]+)(${mc}*=${mc}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),z0=/'/g,D0=/"/g,L0=/^(?:script|style|textarea|title)$/i,Vi=Symbol.for("lit-noChange"),Dt=Symbol.for("lit-nothing"),B0=new WeakMap,gi=di.createTreeWalker(di,129);function F0(n,e){if(!gc(n)||!n.hasOwnProperty("raw"))throw Error("invalid template strings array");return k0!==void 0?k0.createHTML(e):e}const ZT=(n,e)=>{const t=n.length-1,r=[];let o,a=e===2?"<svg>":e===3?"<math>":"",u=jo;for(let h=0;h<t;h++){const c=n[h];let f,p,g=-1,m=0;for(;m<c.length&&(u.lastIndex=m,p=u.exec(c),p!==null);)m=u.lastIndex,u===jo?p[1]==="!--"?u=N0:p[1]!==void 0?u=R0:p[2]!==void 0?(L0.test(p[2])&&(o=RegExp("</"+p[2],"g")),u=pi):p[3]!==void 0&&(u=pi):u===pi?p[0]===">"?(u=o??jo,g=-1):p[1]===void 0?g=-2:(g=u.lastIndex-p[2].length,f=p[1],u=p[3]===void 0?pi:p[3]==='"'?D0:z0):u===D0||u===z0?u=pi:u===N0||u===R0?u=jo:(u=pi,o=void 0);const b=u===pi&&n[h+1].startsWith("/>")?" ":"";a+=u===jo?c+FT:g>=0?(r.push(f),c.slice(0,g)+$0+c.slice(g)+Ur+b):c+Ur+(g===-2?h:b)}return[F0(n,a+(n[t]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class Vo{constructor({strings:e,_$litType$:t},r){let o;this.parts=[];let a=0,u=0;const h=e.length-1,c=this.parts,[f,p]=ZT(e,t);if(this.el=Vo.createElement(f,r),gi.currentNode=this.el.content,t===2||t===3){const g=this.el.content.firstChild;g.replaceWith(...g.childNodes)}for(;(o=gi.nextNode())!==null&&c.length<h;){if(o.nodeType===1){if(o.hasAttributes())for(const g of o.getAttributeNames())if(g.endsWith($0)){const m=p[u++],b=o.getAttribute(g).split(Ur),_=/([.?@])?(.*)/.exec(m);c.push({type:1,index:a,name:_[2],strings:b,ctor:_[1]==="."?GT:_[1]==="?"?HT:_[1]==="@"?WT:va}),o.removeAttribute(g)}else g.startsWith(Ur)&&(c.push({type:6,index:a}),o.removeAttribute(g));if(L0.test(o.tagName)){const g=o.textContent.split(Ur),m=g.length-1;if(m>0){o.textContent=ma?ma.emptyScript:"";for(let b=0;b<m;b++)o.append(g[b],Ho()),gi.nextNode(),c.push({type:2,index:++a});o.append(g[m],Ho())}}}else if(o.nodeType===8)if(o.data===O0)c.push({type:2,index:a});else{let g=-1;for(;(g=o.data.indexOf(Ur,g+1))!==-1;)c.push({type:7,index:a}),g+=Ur.length-1}a++}}static createElement(e,t){const r=di.createElement("template");return r.innerHTML=e,r}}function Ki(n,e,t=n,r){var u,h;if(e===Vi)return e;let o=r!==void 0?(u=t._$Co)==null?void 0:u[r]:t._$Cl;const a=Wo(e)?void 0:e._$litDirective$;return(o==null?void 0:o.constructor)!==a&&((h=o==null?void 0:o._$AO)==null||h.call(o,!1),a===void 0?o=void 0:(o=new a(n),o._$AT(n,t,r)),r!==void 0?(t._$Co??(t._$Co=[]))[r]=o:t._$Cl=o),o!==void 0&&(e=Ki(n,o._$AS(n,e.values),o,r)),e}class qT{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,o=((e==null?void 0:e.creationScope)??di).importNode(t,!0);gi.currentNode=o;let a=gi.nextNode(),u=0,h=0,c=r[0];for(;c!==void 0;){if(u===c.index){let f;c.type===2?f=new Ko(a,a.nextSibling,this,e):c.type===1?f=new c.ctor(a,c.name,c.strings,this,e):c.type===6&&(f=new jT(a,this,e)),this._$AV.push(f),c=r[++h]}u!==(c==null?void 0:c.index)&&(a=gi.nextNode(),u++)}return gi.currentNode=di,o}p(e){let t=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class Ko{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,t,r,o){this.type=2,this._$AH=Dt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=o,this._$Cv=(o==null?void 0:o.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return t!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Ki(this,e,t),Wo(e)?e===Dt||e==null||e===""?(this._$AH!==Dt&&this._$AR(),this._$AH=Dt):e!==this._$AH&&e!==Vi&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):UT(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Dt&&Wo(this._$AH)?this._$AA.nextSibling.data=e:this.T(di.createTextNode(e)),this._$AH=e}$(e){var a;const{values:t,_$litType$:r}=e,o=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=Vo.createElement(F0(r.h,r.h[0]),this.options)),r);if(((a=this._$AH)==null?void 0:a._$AD)===o)this._$AH.p(t);else{const u=new qT(o,this),h=u.u(this.options);u.p(t),this.T(h),this._$AH=u}}_$AC(e){let t=B0.get(e.strings);return t===void 0&&B0.set(e.strings,t=new Vo(e)),t}k(e){gc(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,o=0;for(const a of e)o===t.length?t.push(r=new Ko(this.O(Ho()),this.O(Ho()),this,this.options)):r=t[o],r._$AI(a),o++;o<t.length&&(this._$AR(r&&r._$AB.nextSibling,o),t.length=o)}_$AR(e=this._$AA.nextSibling,t){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,t);e&&e!==this._$AB;){const o=e.nextSibling;e.remove(),e=o}}setConnected(e){var t;this._$AM===void 0&&(this._$Cv=e,(t=this._$AP)==null||t.call(this,e))}}class va{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,o,a){this.type=1,this._$AH=Dt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=o,this.options=a,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Dt}_$AI(e,t=this,r,o){const a=this.strings;let u=!1;if(a===void 0)e=Ki(this,e,t,0),u=!Wo(e)||e!==this._$AH&&e!==Vi,u&&(this._$AH=e);else{const h=e;let c,f;for(e=a[0],c=0;c<a.length-1;c++)f=Ki(this,h[r+c],t,c),f===Vi&&(f=this._$AH[c]),u||(u=!Wo(f)||f!==this._$AH[c]),f===Dt?e=Dt:e!==Dt&&(e+=(f??"")+a[c+1]),this._$AH[c]=f}u&&!o&&this.j(e)}j(e){e===Dt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class GT extends va{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Dt?void 0:e}}class HT extends va{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Dt)}}class WT extends va{constructor(e,t,r,o,a){super(e,t,r,o,a),this.type=5}_$AI(e,t=this){if((e=Ki(this,e,t,0)??Dt)===Vi)return;const r=this._$AH,o=e===Dt&&r!==Dt||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,a=e!==Dt&&(r===Dt||o);o&&this.element.removeEventListener(this.name,this,r),a&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t;typeof this._$AH=="function"?this._$AH.call(((t=this.options)==null?void 0:t.host)??this.element,e):this._$AH.handleEvent(e)}}class jT{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){Ki(this,e)}}const vc=Go.litHtmlPolyfillSupport;vc==null||vc(Vo,Ko),(Go.litHtmlVersions??(Go.litHtmlVersions=[])).push("3.3.0");const VT=(n,e,t)=>{const r=(t==null?void 0:t.renderBefore)??e;let o=r._$litPart$;if(o===void 0){const a=(t==null?void 0:t.renderBefore)??null;r._$litPart$=o=new Ko(e.insertBefore(Ho(),a),a,void 0,t??{})}return o._$AI(n),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const mi=globalThis;class Jo extends ji{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t;const e=super.createRenderRoot();return(t=this.renderOptions).renderBefore??(t.renderBefore=e.firstChild),e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=VT(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Vi}}Jo._$litElement$=!0,Jo.finalized=!0,(V0=mi.litElementHydrateSupport)==null||V0.call(mi,{LitElement:Jo});const _c=mi.litElementPolyfillSupport;_c==null||_c({LitElement:Jo}),(mi.litElementVersions??(mi.litElementVersions=[])).push("4.2.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const KT=n=>(e,t)=>{t!==void 0?t.addInitializer(()=>{customElements.define(n,e)}):customElements.define(n,e)};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const JT={attribute:!0,type:String,converter:ga,reflect:!1,hasChanged:pc},YT=(n=JT,e,t)=>{const{kind:r,metadata:o}=t;let a=globalThis.litPropertyMetadata.get(o);if(a===void 0&&globalThis.litPropertyMetadata.set(o,a=new Map),r==="setter"&&((n=Object.create(n)).wrapped=!0),a.set(t.name,n),r==="accessor"){const{name:u}=t;return{set(h){const c=e.get.call(this);e.set.call(this,h),this.requestUpdate(u,c,n)},init(h){return h!==void 0&&this.C(u,void 0,n,h),h}}}if(r==="setter"){const{name:u}=t;return function(h){const c=this[u];e.call(this,h),this.requestUpdate(u,c,n)}}throw Error("Unsupported decorator location: "+r)};function Dn(n){return(e,t)=>typeof t=="object"?YT(n,e,t):((r,o,a)=>{const u=o.hasOwnProperty(a);return o.constructor.createProperty(a,r),u?Object.getOwnPropertyDescriptor(o,a):void 0})(n,e,t)}var QT=Object.defineProperty,XT=Object.getOwnPropertyDescriptor,U0=n=>{throw TypeError(n)},Mn=(n,e,t,r)=>{for(var o=r>1?void 0:r?XT(e,t):e,a=n.length-1,u;a>=0;a--)(u=n[a])&&(o=(r?u(e,t,o):u(o))||o);return r&&o&&QT(e,t,o),o},Z0=(n,e,t)=>e.has(n)||U0("Cannot "+t),en=(n,e,t)=>(Z0(n,e,"read from private field"),t?t.call(n):e.get(n)),q0=(n,e,t)=>e.has(n)?U0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),G0=(n,e,t,r)=>(Z0(n,e,"write to private field"),e.set(n,t),t),Wt,Yo;Me.Graphty=class extends Jo{constructor(){super(),q0(this,Wt),q0(this,Yo),G0(this,Yo,document.createElement("div")),G0(this,Wt,new M0(en(this,Yo)))}firstUpdated(e){super.firstUpdated(e),this.asyncFirstUpdated(e).catch(t=>{throw t})}async asyncFirstUpdated(e){if(e.has("layout2d")&&this.layout2d!==void 0&&Nn.set(en(this,Wt).styles.config,"graph.twoD",this.layout2d),e.has("runAlgorithmsOnLoad")&&this.runAlgorithmsOnLoad!==void 0&&(en(this,Wt).runAlgorithmsOnLoad=!0),e.has("layout")&&this.layout){const t=this.layoutConfig??{};await en(this,Wt).setLayout(this.layout,t)}if(e.has("nodeIdPath")&&this.nodeIdPath&&Nn.set(en(this,Wt).styles.config,"data.knownFields.nodeIdPath",this.nodeIdPath),e.has("edgeSrcIdPath")&&this.edgeSrcIdPath&&Nn.set(en(this,Wt).styles.config,"data.knownFields.edgeSrcIdPath",this.edgeSrcIdPath),e.has("edgeDstIdPath")&&this.edgeDstIdPath&&Nn.set(en(this,Wt).styles.config,"data.knownFields.edgeDstIdPath",this.edgeDstIdPath),e.has("nodeData")&&Array.isArray(this.nodeData)&&en(this,Wt).addNodes(this.nodeData),e.has("edgeData")&&Array.isArray(this.edgeData)&&en(this,Wt).addEdges(this.edgeData),e.has("dataSource")&&this.dataSource){const t=this.dataSourceConfig??{};await en(this,Wt).addDataFromSource(this.dataSource,t)}e.has("styleTemplate")&&this.styleTemplate&&await en(this,Wt).setStyleTemplate(this.styleTemplate),await en(this,Wt).init(),en(this,Wt).engine.resize()}render(){return en(this,Yo)}disconnectedCallback(){en(this,Wt).shutdown()}},Wt=new WeakMap,Yo=new WeakMap,Mn([Dn({attribute:"node-data"})],Me.Graphty.prototype,"nodeData",2),Mn([Dn({attribute:"edge-data"})],Me.Graphty.prototype,"edgeData",2),Mn([Dn({attribute:"data-source"})],Me.Graphty.prototype,"dataSource",2),Mn([Dn({attribute:"data-source-config"})],Me.Graphty.prototype,"dataSourceConfig",2),Mn([Dn({attribute:"node-id-path"})],Me.Graphty.prototype,"nodeIdPath",2),Mn([Dn({attribute:"edge-src-id-path"})],Me.Graphty.prototype,"edgeSrcIdPath",2),Mn([Dn({attribute:"edge-src-id-path"})],Me.Graphty.prototype,"edgeDstIdPath",2),Mn([Dn()],Me.Graphty.prototype,"layout",2),Mn([Dn({attribute:"layout-config"})],Me.Graphty.prototype,"layoutConfig",2),Mn([Dn({attribute:"layout-2d"})],Me.Graphty.prototype,"layout2d",2),Mn([Dn({attribute:"style-template"})],Me.Graphty.prototype,"styleTemplate",2),Mn([Dn({attribute:"run-algorithms-on-load"})],Me.Graphty.prototype,"runAlgorithmsOnLoad",2),Me.Graphty=Mn([KT("graphty-element")],Me.Graphty),Me.DataSource=Js,Me.Edge=Rn,Me.Graph=M0,Me.LayoutEngine=vt,Me.Node=Je,Me.StyleTemplate=gp,Me.Styles=xn,Object.defineProperty(Me,Symbol.toStringTag,{value:"Module"})});
